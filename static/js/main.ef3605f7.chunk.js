(this["webpackJsonpportic-storymaps-2021"]=this["webpackJsonpportic-storymaps-2021"]||[]).push([[2],{104:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return g})),a.d(t,"c",(function(){return v}));var n=a(7),r=a(4),i=a(17),o=a(20),s=a(19),c=a.n(s),l=a(164),u=a.n(l),d=a(321),p=a(26),m=a(1),f=function(e){var t=Object(n.a)(e.navigoValues,2),a=t[0],s=t[1],l=e.toflitPct,f=e.transformGroup,j=e.circleRadius,b=e.width,h=e.height,g=e.name,v=e.legendMode,O=e.isActive,x=e.isMinified,y=e.onClick,_=Object(r.useState)(!1),w=Object(n.a)(_,2),N=w[0],M=w[1];Object(r.useEffect)((function(){setTimeout((function(){M(!0)}))}),[]),Object(r.useEffect)((function(){p.a.rebuild()}));var C,L,k=Object(o.useSpring)({to:{transform:f},immediate:!N}).transform,q=1.4*j,T=q*q/2,R=a*T,P=s*T,S=Math.sqrt(R*a),z=Math.sqrt(P*s),A=null,F=null;l&&(A=Math.PI/2+(l-50)/100*Math.PI,F=3*Math.PI/2-(l-50)/100*Math.PI,C=u()(0,0,j,A,F).map((function(e){return e.join(" ")})).join(" "),L=u()(0,0,j,A,F-2*Math.PI).map((function(e){return e.join(" ")})).join(" "));var D=parseInt(.013*h);return D=D>8?D:8,Object(m.jsxs)(o.animated.g,{className:c()("ExtraversionObject",{"is-active":O,"is-minified":x}),transform:k,onClick:function(){return"function"===typeof y?y(g):void 0},children:[Object(m.jsxs)(m.Fragment,{children:[l&&null!=C?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("path",{d:"".concat(C,"\n                  "),stroke:v?"darkgrey":i.a.generic.accent2,"stroke-width":.005*b,fill:"transparent","data-for":"geo-tooltip","data-tip":"".concat((100-l).toFixed(1),"% de valeur d'exports de produits fabriqu\xe9s hors de la direction ").concat("function"===typeof y?"(cliquer pour voir le d\xe9tail des ports)":"")}),Object(m.jsx)("path",{d:"".concat(L,"\n                  "),stroke:v?"grey":i.a.ui.colorAccentBackground,"stroke-width":.005*b,fill:"transparent","data-for":"geo-tooltip","data-tip":"".concat(l.toFixed(1),"% de valeur d'exports de produits fabriqu\xe9s dans la direction ").concat("function"===typeof y?"(cliquer pour voir le d\xe9tail des ports)":"")})]}):null,Object(m.jsx)("path",{className:"left-triangle",fill:v?"darkgrey":i.a.generic.accent2,d:"M ".concat(0," ",-S/2,"\n            V ").concat(S/2,"\n            L ").concat(-S," ",0,"\n            Z\n                "),"data-for":"geo-tooltip","data-tip":"".concat((100*a).toFixed(1),"% du tonnage cumul\xe9 des voyages r\xe9alis\xe9s vers l'ext\xe9rieur de la direction ").concat("function"===typeof y?"(cliquer pour voir le d\xe9tail des ports)":"")}),Object(m.jsx)("path",{className:"right-triangle",fill:v?"grey":i.a.ui.colorAccentBackground,d:"M ".concat(0," ",-z/2,"\n            L ").concat(z," ",0,"\n            L ",0," ").concat(z/2,"\n            Z\n            "),"data-for":"geo-tooltip","data-tip":"".concat((100*s).toFixed(1),"% du tonnage cumul\xe9 des voyages r\xe9alis\xe9s vers l'int\xe9rieur de la direction ").concat("function"===typeof y?"(cliquer pour voir le d\xe9tail des ports)":"")}),Object(m.jsx)("g",{transform:"translate(".concat(parseInt(0),", ").concat(l?parseInt(j)+15:Object(d.a)([S,z])/2+10,")"),children:Object(m.jsx)("text",{className:"object-label","font-size":D,textAnchor:"middle",children:g})})]}),v?Object(m.jsxs)("g",{className:"legend-container",children:[Object(m.jsx)("foreignObject",{width:2*j,height:2*j,x:3*-j,y:1.7*-j,className:"top left",children:Object(m.jsx)("div",{className:"label-wrapper",children:Object(m.jsx)("span",{children:"Part des exports de produits fabriqu\xe9s hors de la direction"})})}),Object(m.jsx)("line",{x1:.95*-j,y1:1.5*-j,x2:.5*-j,y2:1*-j,"marker-end":"url(#triangle-end)"}),Object(m.jsx)("foreignObject",{width:2*j,height:2*j,x:1.2*j,y:1.7*-j,className:"top right",children:Object(m.jsx)("div",{className:"label-wrapper",children:Object(m.jsx)("span",{children:"Part des exports de produits fabriqu\xe9s dans la direction"})})}),Object(m.jsx)("line",{x1:1.15*j,y1:1.5*-j,x2:.5*j,y2:1*-j,"marker-end":"url(#triangle-end)"}),Object(m.jsx)("foreignObject",{width:2*j,height:2*j,x:3*-j,y:0,className:"bottom left",children:Object(m.jsx)("div",{className:"label-wrapper",children:Object(m.jsx)("span",{children:"Part des voyages hors direction (tonnage c.)"})})}),Object(m.jsx)("line",{x1:1.8*-j,y1:.2*j,x2:.3*-j,y2:.1*j,"marker-end":"url(#triangle-end)"}),Object(m.jsx)("foreignObject",{width:2*j,height:2*j,x:1.2*j,y:0,className:"bottom right",children:Object(m.jsx)("div",{className:"label-wrapper",children:Object(m.jsx)("span",{children:"Part des voyages dans la direction (tonnage c.)"})})}),Object(m.jsx)("line",{x1:2*j,y1:.2*j,x2:.3*j,y2:.1*j,"marker-end":"url(#triangle-end)"})]}):null]})},j=a(168);function b(e){var t=e.datum,a=e.projection,r=e.width,i=e.height,o=e.projectionTemplate,s=e.isActive,c=e.isMinified,l=e.onClick,u=a([+t.longitude,+t.latitude]),d=Object(n.a)(u,2),p=d[0],j=d[1],b=.05*r,h=parseFloat(t.cumulated_tonnage_out_region)+parseFloat(t.cumulated_tonnage_in_region);"port"===t.type_of_object&&(h<1e3?b=.025*r:h>5e3&&(b=.075*r));var g=parseFloat(t.cumulated_tonnage_out_region)/h,v=parseFloat(t.cumulated_tonnage_in_region)/h,O=0;if("customs_office"===t.type_of_object){var x=parseFloat(t.cumulated_exports_value_from_region)+parseFloat(t.cumulated_exports_value_from_ext);O=100===(O=parseFloat(t.cumulated_exports_value_from_region)/x*100)?99.99:O}var y="translate(".concat(p,",").concat(j,")");o.includes("Poitou")&&("Tonnay-Charente"===t.name?y="translate(".concat(p+.16*r,",").concat(j,")"):"Rochefort"===t.name?y="translate(".concat(p+.04*r,",").concat(j-0*i,")"):"Marennes"===t.name?y="translate(".concat(p-.03*r,",").concat(j+.05*i,")"):"Marans"===t.name?y="translate(".concat(p+.03*r,",").concat(j-.05*i,")"):"Saint-Martin-de-R\xe9"===t.name?y="translate(".concat(p-.06*r,",").concat(j,")"):"Les Sables-d'Olonne"===t.name&&(y="translate(".concat(p-.1*r,",").concat(j-.1*i,")")));var _="France"===o?y+" scale(0.1)":y+" scale(".concat(c?.5:1,")");return Object(m.jsx)(f,{transformGroup:_,navigoValues:[g,v],toflitPct:isNaN(O)?100:O,circleRadius:b,width:r,height:i,name:t.name,isActive:s,isMinified:c,onClick:l})}function h(e){var t=e.data,a=t.customsOffices,o=void 0===a?[]:a,s=t.ports,c=void 0===s?[]:s,l=e.projection,u=e.width,d=e.height,p=e.projectionTemplate,j=Object(r.useState)(void 0),h=Object(n.a)(j,2),g=h[0],v=h[1],O=function(e){v(e===g?void 0:e)},x=Object(r.useMemo)((function(){return g?c.filter((function(e){return e.customs_office===g})):[]}),[g,c]),y=.18*d,_=.55*d,w=.35*u,N=x.length?_/x.length:_;return Object(m.jsxs)("g",{className:"Step3Objects",children:[g?Object(m.jsxs)("g",{className:"ports-details",children:[Object(m.jsx)("foreignObject",{x:0,y:0,width:.4*u,height:d/2,className:"ports-details-title",children:Object(m.jsxs)("h5",{children:["Ports associ\xe9s au bureau des fermes de ",g," (",x.length,")"]})}),Object(m.jsx)("g",{className:"ports-space",transform:"translate(".concat(15,", ").concat(y,")"),children:x.sort((function(e,t){var a=l([+e.longitude,+e.latitude]),r=Object(n.a)(a,2),i=(r[0],r[1]),o=l([+t.longitude,+t.latitude]),s=Object(n.a)(o,2);s[0];return i>s[1]?1:-1})).map((function(e,t){var a=l([+e.longitude,+e.latitude]),r=Object(n.a)(a,2),o=r[0],s=r[1],c=.05*u,p=c,j=parseFloat(e.cumulated_tonnage_out_region)+parseFloat(e.cumulated_tonnage_in_region);j<1e3?p=.025*u:j>5e3&&(p=.075*u);var b=parseFloat(e.cumulated_tonnage_out_region)/j,h=parseFloat(e.cumulated_tonnage_in_region)/j,g=w/2-2*c+(x.length>5?t%2===0?0:2*c:0),v=N*t,O="translate(".concat(g,", ").concat(v,")");return Object(m.jsxs)("g",{className:"port-group",children:[Object(m.jsx)("line",{x1:g,y1:v,x2:o-15,y2:s-y}),Object(m.jsx)("circle",{cx:o-15,cy:s-y,r:.002*u,style:{fill:i.a.generic.dark},className:"marker"}),Object(m.jsx)(f,{transformGroup:O,navigoValues:[b,h],circleRadius:p,width:u,height:d,name:e.name})]},e.name)}))})]}):null,o.map((function(e,t){return Object(m.jsx)(b,{datum:e,projection:l,width:u,height:d,projectionTemplate:p,onClick:O,isActive:e.name===g,isMinified:g&&e.name!==g},e.name)}))]})}function g(e){var t=e.data,a=e.width,n=e.height,r=(e.projection,t.filter((function(e){var t=e.name;return"Le Havre"===t||"Nantes"===t||"Bordeaux"===t||"La Rochelle"===t})).sort((function(e,t){return e.cumulated_exports_value_from_region>t.cumulated_exports_value_from_region?-1:1})));r.unshift({name:"L\xe9gende",cumulated_tonnage_in_region:60,cumulated_tonnage_out_region:60,cumulated_exports_value_from_region:50,cumulated_exports_value_from_ext:50,legendMode:!0});var i=15,o=.05*a,s=n-o-30,c=2*o+i,l=.4*a;return Object(m.jsxs)("g",{className:"small-multiples-and-legend-and-title",children:[Object(m.jsx)("rect",{x:l+30,y:s-3*o,width:a-l-60,height:n-s+3*o-7.5,style:{fill:"white"},opacity:.5}),Object(m.jsx)("foreignObject",{x:l+1.5*o,y:s-3*o,width:(2*o+i)*(r.length-1),height:n,children:Object(m.jsx)("div",{style:{position:"relative"},children:Object(m.jsx)("h5",{className:"visualization-title",style:{position:"absolute",left:0,bottom:0},children:"Comparaison avec les bureaux de fermes et ports dominants d'autres directions en 1787"})})}),Object(m.jsx)("g",{className:"small-multiples",children:r.map((function(e,t){var r=parseFloat(e.cumulated_tonnage_out_region)+parseFloat(e.cumulated_tonnage_in_region),u=parseFloat(e.cumulated_tonnage_out_region)/r,d=parseFloat(e.cumulated_tonnage_in_region)/r,p=parseFloat(e.cumulated_exports_value_from_region)+parseFloat(e.cumulated_exports_value_from_ext),j=parseFloat(e.cumulated_exports_value_from_region)/p*100;return e.legendMode?Object(m.jsx)(f,{transformGroup:"translate(".concat(1*o*4+i+t*(1*o+i),", ").concat(s-(1*o-o),")"),navigoValues:[u,d],toflitPct:j,circleRadius:1*o,width:a,height:n,name:e.name,legendMode:e.legendMode}):Object(m.jsx)(f,{transformGroup:"translate(".concat(l+t*c,", ").concat(s,")"),navigoValues:[u,d],toflitPct:j,circleRadius:o,width:a,height:n,name:e.name,legendMode:e.legendMode})}))}),Object(m.jsx)("defs",{children:Object(m.jsx)("marker",{id:"triangle-end",viewBox:"-10 0 10 10",refX:"1",refY:"5",markerUnits:"strokeWidth",markerWidth:.01*a,markerHeight:.01*a,orient:"auto",children:Object(m.jsx)("path",{d:"M -10 0 L 0 5 L -10 10 Z",fill:"darkgrey"})})})]})}function v(e){var t=e.data,a=e.width,n=e.height,r=e.projection,i=e.projectionTemplate,o=e.atlasMode;return Object(m.jsx)(j.a,{data:t,totalWidth:a,rowHeight:.3*n,projection:r,projectionTemplate:i,atlasMode:o})}},105:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(10),r=a(7),i=a(4),o=a(313),s=a.n(o),c=a(226),l=a.n(c),u=a(314),d=a.n(u),p=a(315),m=a(56),f=a(269),j=a(119),b=a(118),h=a(22),g=a(316),v=a.n(g),O="#999",x=[2,15];var y=a(25),_=(a(573),a(1)),w=Object(m.a)().domain([0,1]).range([200,10]),N=Object(m.a)().domain([0,1]).range([300,30]);function M(e){var t=e.graph,a=e.nodeColor,o=e.nodeSize,s=e.labelDensity,c=e.nodeLabel,l=e.onCameraUpdate,u=e.cameraPosition,d=e.updateTimestamp,g=e.width,M=e.height,C=e.ratio,L=Object(i.useMemo)((function(){var e=[];return t.forEachNode((function(t,a){e.push(+(o?a[o]:a.size))})),e}),[o,t]),k=Object(f.a)(L),q={nodeSize:{min:k[0],max:k[1]}},T=Object(i.useMemo)((function(){return o?{min:Object(j.a)(k),max:Object(b.a)(k),name:o}:void 0}),[o,t]),R=Object(i.useMemo)((function(){if(a&&a.field){var e=[];t.forEachNode((function(t,n){e.push(n[a.field])})),e=Object(h.uniq)(e);var n={};if(a.palette)n=a.palette;else{var r=Object(y.c)(a.field,e.length),i=0;e.forEach((function(e){n[e]=r[i],i++}))}return{palette:n,name:a.field}}}),[a,t]),P=Object(i.useMemo)((function(){var e=new Map;return t.forEach((function(t,a,n,r,i,o){e.set(i,{sourceNode:n,targetNode:r})})),e}),[t]),S=Object(y.e)(R),z=Object(y.e)(T),A=Object(y.e)(c),F=Object(y.e)(s),D=function(e){var t=e.nodeColor,a=e.nodeSize,r=(e.nodeLabel,e.nodeSizeFactor),i=void 0===r?1:r,o=e.extents,s=null;return s=a?Object(m.a)().domain([a.min,a.max]).range(x):Object(m.a)().domain([o.nodeSize.min,o.nodeSize.max]).range(x),function(e,r){var o=Object(n.a)(Object(n.a)({},r),{},{x:isNaN(r.x)||void 0===r.x?0:r.x,y:isNaN(r.y)||void 0===r.y?0:r.y});if(o.color=t?t.palette[r[t.name]]||O:r.color||O,a){var c=r[a.name];c="number"===typeof c?c:1,o.size=s(c)}else{var l=r.size||1;o.size=s(l)}return o.size*=i,o}}({nodeColor:R,nodeSize:T,nodeLabel:c,extents:q}),E=function(e){var t=e.nodeColor,a=e.nodeSize,n=(e.nodeLabel,e.nodeSizeFactor,e.extents,e.dontColorEdges,e.edgesMap);return function(e,r,i,o){var s=n.get(e),c=s.sourceNode,l=s.targetNode,u={},d=(a?c[a.name]:c.size)<(a?l[a.name]:l.size)?c:l;return d&&(u.color=t?t.palette[d[t.name]]||O:d.color||O,u.color=v()(u.color).lighten(.4).rgb().string()),u}}({nodeColor:R,nodeSize:T,nodeLabel:c,extents:q,edgesMap:P}),B=Object(i.useRef)(null),I=Object(i.useState)(null),Y=Object(r.a)(I,2),X=Y[0],H=Y[1];if(Object(i.useEffect)((function(){u&&X&&X.getCamera().animate(u)}),[d]),X){var W=!1;S===R&&z===T&&A===c||(X.settings.nodeReducer=D,X.settings.edgeReducer=E,W=!0),F!==s&&(X.settings.labelGrid.cell={width:N(s),height:w(s)},X.displayedLabels=new Set,W=!0),W&&X.refresh()}Object(i.useEffect)((function(){X&&X.refresh()}),[g,M]);var G=Object(i.useCallback)((function(e){if(X&&X.graph!==t&&(X.kill(),H(null)),e&&t){var a=new p.WebGLRenderer(t,e,{nodeReducer:D,edgeReducer:E});a.settings.labelFont="IBM Plex Sans",H(a);var r=a.getCamera();r.setState(Object(n.a)(Object(n.a)({},r.getState()),{},{ratio:C||1})),r.disable(),l(r.getState()),r.on("updated",(function(e){l(e)}))}B.current=e}),[t]);return Object(_.jsx)("div",{className:"VisContainer GraphContainer",children:Object(_.jsx)("div",{ref:G,style:{width:"100%",height:"100%",minHeight:"10vh",minWidth:"1vw"}})})}function C(e){var t=e.data,a=e.nodeColor,n=e.nodeLabel,o=e.nodeSize,c=e.labelDensity,u=void 0===c?.5:c,p=e.spatialize,m=e.cameraPosition,f=void 0===m?{x:.5,y:.5,angle:0,ratio:1}:m,j=e.width,b=void 0===j?0:j,h=e.height,g=e.ratio,v=e.title,O=Object(i.useRef)(null),x=Object(i.useMemo)((function(){return O.current?O.current.getBoundingClientRect().height:0}),[O.current]),y=Object(i.useState)(f),w=Object(r.a)(y,2),N=w[0],C=w[1];Object(i.useEffect)((function(){["x","y","angle","ratio"].find((function(e){return f[e]!==N[e]}))&&C(f)}),[f]);var L=Object(i.useMemo)((function(){var e=s.a.parse(d.a,t);if(p){var a=l.a.inferSettings(e);l.a.assign(e,{settings:a,iterations:50})}return e}),[t]);return L?Object(_.jsxs)("div",{className:"SigmaComponent",style:{width:"100%",height:h||"100%"},children:[Object(_.jsx)("div",{ref:O,className:"row visualization-title-container",children:v?Object(_.jsx)("h5",{className:"visualization-title",children:v}):null}),Object(_.jsx)("div",{style:{position:"relative",flex:1},children:Object(_.jsx)(M,{graph:L,cameraPosition:N,nodeColor:a,nodeSize:o,labelDensity:u,nodeLabel:n,ratio:g,onCameraUpdate:function(e){C(e)},width:b,height:h-x})})]}):null}},120:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.54,time:32400,words:108},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("div",{className:"column"},Object(r.a)("h2",{id:"le-programme-portic"},"Le programme PORTIC"),Object(r.a)("p",null,"Le programme ANR PORTIC se propose de croiser les donn\xe9es sur la navigation et sur la valeur du commerce \xe9tranger de la France \xe0 la veille de la R\xe9volution fran\xe7aise pour mieux saisir les dynamiques commerciales \xe0 l\u2019\u0153uvre. Pour ce faire, il offre des interfaces d\u2019interrogation et de visualisation des donn\xe9es adapt\xe9es \xe0 des publics et des int\xe9r\xeats vari\xe9s."),Object(r.a)("p",null,Object(r.a)("a",{parentName:"p",href:"https://anr.portic.fr/"},"En savoir plus sur le programme PORTIC"))),Object(r.a)("div",{className:"column"},Object(r.a)("p",null,"Les contenus de ce site sont plac\xe9s sous ",Object(r.a)("a",{parentName:"p",href:"https://creativecommons.org/licenses/by-nc-sa/3.0/fr/"},"licence libre creative commons CC-BY-SA-NC"),"."),Object(r.a)("p",null,"Le code source de ce site est plac\xe9 sous licence libre ",Object(r.a)("a",{parentName:"p",href:"https://www.gnu.org/licenses/agpl-3.0.fr.html"},"AGPL-3.0"),"."),Object(r.a)("p",null,Object(r.a)("a",{parentName:"p",href:"https://github.com/medialab/portic-storymaps-2021/"},"Acc\xe9der au code source de ce site"))))}c.isMDXComponent=!0;var l=function(){return[{id:"le-programme-portic",level:2,title:"Le programme PORTIC",children:[]}]},u={}},167:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(7),r=a(4);function i(e,t){var a=Object(r.useRef)();Object(r.useEffect)((function(){a.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}}),[t])}function o(e,t){var a=Object(r.useState)(e),i=Object(n.a)(a,2),o=i[0],s=i[1];return Object(r.useEffect)((function(){var a=setTimeout((function(){s(e)}),t);return function(){clearTimeout(a)}}),[e,t]),o}},168:function(e,t,a){"use strict";var n=a(7),r=a(56),i=a(118),o=a(19),s=a.n(o),c=(a(522),a(17)),l=a(4),u=a(20),d=a(1),p=function(e){var t=e.numberOfColumns,a=e.port,r=e.scaleX,i=e.scaleY,o=(e.legendWidth,e.columnWidth),p=e.totalHeight,m=e.totalWidth,f=e.projection,j=e.index,b=e.margins,h=e.rowHeight,g=e.fontSize,v=e.projectionTemplate,O=r(+a.nb_pointcalls_out),x=i(+a.mean_tonnage),y=j%t*o+b.left,_=2.3*p,w=f([+a.longitude,+a.latitude]),N=Object(n.a)(w,2),M=N[0],C=N[1],L=Object(l.useState)(!1),k=Object(n.a)(L,2),q=k[0],T=k[1];Object(l.useEffect)((function(){setTimeout((function(){T(!0)}))}),[]);var R=Object(u.useSpring)({to:{transform:"translate(".concat(M,",").concat(C,")"),x1:"rotated Poitou"===v?y+o/2:M,y1:"rotated Poitou"===v?_+h/7:C,markerRadius:"rotated Poitou"===v?.02*p:0,x2:M,y2:C,staticTransform:"rotated Poitou"===v?"translate(".concat(y,", ").concat(_,") scale(1)"):"translate(".concat(M,",").concat(C,") scale(").concat("rotated Poitou"===v?1:.1,")")},immediate:!q}),P=R.transform,S=R.x1,z=R.y1,A=R.x2,F=R.y2,D=R.staticTransform,E=R.markerRadius,B=o/2,I=h/7,Y=h/2+I/2-x/2,X=.08*m,H=12*g;return a.port.length<=10?H=6*g:a.port.length<=12?H=7*g:a.port.length<=15?H=8*g:a.port.length<=18&&(H=10*g),Object(d.jsxs)("g",{className:s()("port-point-and-triangle",{"is-minified":"rotated Poitou"!==v}),children:[Object(d.jsx)(u.animated.line,{x1:S,y1:z,x2:A,y2:F,stroke:"grey",strokeDasharray:"2, 8"}),Object(d.jsx)(u.animated.g,{className:"port-point",transform:P,children:Object(d.jsx)(u.animated.circle,{cx:0,cy:0,r:E,style:{fill:c.a.generic.dark},className:"marker"})}),Object(d.jsxs)(u.animated.g,{className:"port-triangle",transform:D,children:[Object(d.jsx)("path",{class:"vertical-line",d:"M ".concat(B," ").concat(I," \n              V ").concat(Y,"\n              ")}),Object(d.jsx)("g",{transform:"translate(".concat(B,", ").concat(Y,")"),children:Object(d.jsx)("path",{className:"triangle",d:"M ".concat(-O/2," ",0," \n                L ").concat(O/2," ",0,"\n                L ",0," ").concat(x,"\n                Z\n                "),fill:"url(#TriangleGradient)"})}),Object(d.jsxs)("g",{className:"local-legend",children:[Object(d.jsx)("line",{x1:B-O/2,x2:B+O/2,y1:Y-3,y2:Y-3,"marker-start":"url(#triangle-left)","marker-end":"url(#triangle-right)"}),Object(d.jsx)("line",{x1:B-O/2-3,x2:B-O/2-3,y1:Y,y2:Y+x,"marker-start":"url(#triangle-left)","marker-end":"url(#triangle-right)"}),Object(d.jsx)("path",{d:"\n            M ".concat(-.2*X-O/3," ").concat(.65*Y,"\n            Q ").concat(B-10," ").concat(.65*Y," ").concat(B-2," ").concat(Y-5,"\n            "),"marker-end":"url(#triangle-right)"}),Object(d.jsx)("path",{d:"\n            M ".concat(-x/3+3," ").concat(Y+.6*x+7,"\n            L ").concat(B-O/2-3," ").concat(Y+.6*x+7,"\n            "),"marker-end":"url(#triangle-right)"}),Object(d.jsx)("foreignObject",{y:Y/2,x:-X-O/3,width:X,height:h,children:Object(d.jsxs)("span",{xmlns:"http://www.w3.org/1999/xhtml",children:["nombre de navires sortis du port en 1789 : ",Object(d.jsx)("strong",{children:a.nb_pointcalls_out})]})}),Object(d.jsx)("foreignObject",{x:-X-O/3,y:Y+.6*x,width:.08*m,height:h,children:Object(d.jsxs)("span",{xmlns:"http://www.w3.org/1999/xhtml",children:["tonnage moyen des navires : ",Object(d.jsx)("strong",{children:(+a.mean_tonnage||0).toFixed(1)})]})})]}),Object(d.jsxs)("g",{className:"label",transformOrigin:"bottom left",transform:"translate(".concat(o/2,", ").concat(h/7-.025*p,")"),children:[Object(d.jsx)("path",{d:"M 0 ".concat(-g," L ").concat(H," ").concat(-g," ").concat(H-5," ").concat((.2*g-g)/2," ").concat(H," ").concat(.2*g," 0 ").concat(.2*g," Z"),style:{fill:c.a.generic.dark},transformOrigin:"bottom left",transform:"rotate (-45)"}),Object(d.jsxs)("text",{transformOrigin:"bottom left",transform:"rotate (-45)","font-size":g,style:{fill:"white"},x:3,y:0,textAnchor:"left",children:[" ",a.port," "]})]})]})]})};t.a=function(e){var t=e.data,a=e.totalWidth,o=void 0===a?1200:a,l=e.legendWidth,u=void 0===l?.1:l,m=e.margins,f=e.rowHeight,j=void 0===f?200:f,b=e.projection,h=e.projectionTemplate,g=e.atlasMode,v=m||{left:.1*o,right:.1*o},O=t.length,x=(o-v.left-v.right)/O,y=t.length/O*j,_=.05*y,w=Object(r.a)().domain([0,Object(i.a)(t.map((function(e){return+e.nb_pointcalls_out})))]).range([5,5*x]),N=Object(r.a)().domain([0,Object(i.a)(t.map((function(e){return+e.mean_tonnage})))]).range([5,.85*j]);return Object(d.jsxs)("g",{className:s()("TriangleComponent",{"is-atlas-mode":g}),children:[Object(d.jsx)("defs",{children:Object(d.jsxs)("linearGradient",{id:"TriangleGradient",x2:"0%",y2:"100%",children:[Object(d.jsx)("stop",{offset:"10%",stopColor:"rgb(100,100,100)","stop-opacity":.6}),Object(d.jsx)("stop",{offset:"100%",stopColor:c.a.generic.dark})]})}),Object(d.jsxs)("g",{className:"triangles",children:[t.sort((function(e,t){var a=b([+e.longitude,+e.latitude]),r=Object(n.a)(a,1)[0],i=b([+t.longitude,+t.latitude]);return r>Object(n.a)(i,1)[0]?1:-1})).map((function(e,t){return Object(d.jsx)(p,{numberOfColumns:O,port:e,scaleX:w,scaleY:N,legendWidth:u,columnWidth:x,totalHeight:y,totalWidth:o,projection:b,index:t,margins:v,rowHeight:j,fontSize:_,projectionTemplate:h},t)})),Object(d.jsxs)("defs",{children:[Object(d.jsx)("marker",{id:"triangle-left",viewBox:"0 0 10 10",refX:"1",refY:"5",markerUnits:"strokeWidth",markerWidth:u*o*.04,markerHeight:.02*j,orient:"auto",children:Object(d.jsx)("path",{d:"M 10 0 L 0 5 L 10 10 Z",fill:"darkgrey"})}),Object(d.jsx)("marker",{id:"triangle-right",viewBox:"-10 0 10 10",refX:"1",refY:"5",markerUnits:"strokeWidth",markerWidth:u*o*.04,markerHeight:.024*j,orient:"auto",children:Object(d.jsx)("path",{d:"M -10 0 L 0 5 L -10 10 Z",fill:"darkgrey"})})]})]})]})}},17:function(e,t,a){"use strict";t.a={ui:{colorText:"#403d3d",colorAccent:"#34495e",colorAccentBackground:"#336d7c",colorBackgroundBlue:"#d3e5e5",colorBackground:"#ebebeb"},generic:{dark:"#336D7C",light:"#E0E3E6",accent1:"#00C4AF",accent2:"#FEA43B"},admiralties:{"La Rochelle":"#41BEA3",Marennes:"#A7E6F9","Sables d'Olonne":"#668EDB"},provinces:{Poitou:"#668EDB",Aunis:"#41BEA3",Saintonge:"#A7E6F9",Angoumois:"#514EEE"},product:{sel:"#E0CB0E","eau-de-vie et vins divers":"#A07BEE","autres produits":"#72808D","produits coloniaux":"#FEA43B"},partner:{Afrique:"#875E2E","Reste du monde (USA)":"#E0E3E6","Grande Bretagne":"#542AAD",Europe:"#A07BEE","Ports francs et petites \xeeles":"#5439F9",Colonies:"#E5881A","Ind\xe9termin\xe9 suppos\xe9 Europe":"#A07BEE"},customs_office:{"La Rochelle":"#41BEA3",Rochefort:"#349883","Saint-Martin-de-R\xe9":"#277262","Tonnay-Charente":"#5AD0F4",Marans:"#67CBB6","Les Sables-d'Olonne":"#668EDB",Marennes:"#A7E6F9"},tonnageClasses:{"100%":"#A07BEE","75% ou plus":"#41BEA3","moins de 75%":"#FEA43B"}}},210:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return s})),a.d(t,"default",(function(){return l})),a.d(t,"tableOfContents",(function(){return u})),a.d(t,"frontMatter",(function(){return d}));var n=a(18),r=(a(4),a(5)),i=a(28),o=["components"],s={text:"4 min read",minutes:3.805,time:228300,words:761},c={};function l(e){var t=e.components,a=Object(n.a)(e,o);return Object(r.a)("wrapper",Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"introduction"},"Introduction"),Object(r.a)(i.a,{id:"intro-provinces",mdxType:"Caller"}),Object(r.a)("p",null,"La France du XVIIIe si\xe8cle se caract\xe9rise par le fort dynamisme des ports et des hinterlands de la fa\xe7ade atlantique. La guerre maritime qui commence en 1793 et qui se poursuit pendant plus de vingt ans, entra\xeenant la perte d\xe9finitive de Saint-Domingue en 1804 et de l\u2019\xeele de France (\xeele Maurice) en 1815, sonne le glas et d\xe9place le centre de l\u2019\xe9conomie fran\xe7aise vers l\u2019int\xe9rieur. "),Object(r.a)("p",null,"L\u2019\xe9tude de cas pr\xe9sent\xe9e ici s\u2019int\xe9resse \xe0 la navigation et au commerce maritime des c\xf4tes charentaises \xe0 la veille de la R\xe9volution. Cette aire poss\xe8de un dense maillage portuaire, avec une quarantaine de ports en activit\xe9. Certains ne font que du cabotage micro-local, d\u2019autres int\xe8grent petit et grand cabotage, d\u2019autres enfin int\xe8grent aussi une navigation de long-cours. Cette r\xe9gion se pr\xeate donc particuli\xe8rement \xe0 une \xe9tude portant sur l\u2019articulation entre les diff\xe9rentes \xe9chelles de commerce maritime \xe0 l\u2019aube de la r\xe9volution. "),Object(r.a)(i.a,{id:"intro-ports",mdxType:"Caller"}),Object(r.a)("p",null,"Nous nous proposons de reconstituer l\u2019histoire maritime et commerciale de la r\xe9gion \xe0 partir des deux principales sources historiques. D\u2019une part, nous disposons de traces administratives de la navigation maritime gr\xe2ce aux redevances qui p\xe8sent sur celle-ci sous l\u2019ancien r\xe9gime. Les registres des cong\xe9s r\xe9pertorient les navires \xe0 leur d\xe9part d\u2019un port et le montant d\xfb, qui varie le plus souvent selon leur tonnage et leur destination. Ces registres, r\xe9dig\xe9s par les greffiers de l\u2019amiraut\xe9 locale, ont \xe9t\xe9 num\xe9ris\xe9s et structur\xe9s sous la forme d\u2019une base de donn\xe9es appel\xe9e ",Object(r.a)("a",{parentName:"p",href:"http://navigocorpus.org/"},"Navigocorpus"),". Dans cette derni\xe8re, on compte entre autres plus de 32 000 cong\xe9s pour l\u2019ann\xe9e 1787 pour l\u2019ensemble des ports fran\xe7ais, et quelque 6900 cong\xe9s pour 1789 relatifs \xe0 la r\xe9gion \xe9tudi\xe9e."),Object(r.a)("p",null,"Les registres de cong\xe9s nous permettent de rep\xe9rer les dates de sortie de port des bateaux, ainsi que diverses informations relatives \xe0 l\u2019objet de leur voyage, leur tonnage, leur capitaine, etc.. Ces donn\xe9es ne sont cependant pas d\xe9nu\xe9es d\u2019incertitude : l\u2019itin\xe9raire d\xe9clar\xe9 par les capitaines de bateau au moment de la sortie de port ne correspond pas n\xe9cessairement au voyage effectif qui l\u2019a suivi. Les cong\xe9s permettent une bonne mesure des trafics de la r\xe9gion de La Rochelle, y compris \xe0 toute petite \xe9chelle, tout en demandant une attention fine \xe0 la dimension d\u2019incertitude inh\xe9rente \xe0 la source mobilis\xe9e."),Object(r.a)(i.a,{id:"intro-bureaux",mdxType:"Caller"}),Object(r.a)("p",null,"D\u2019autre part, nous disposons de traces administratives relatives au commerce g\xe9n\xe9ral de la r\xe9gion \xe9tudi\xe9e. La base de donn\xe9es ",Object(r.a)("a",{parentName:"p",href:"http://toflit18.medialab.sciences-po.fr/%23/home"},"Toflit18")," se fonde sur la num\xe9risation des documents du Bureau de la balance du commerce de 1716 \xe0 1821. Ces documents ont \xe9t\xe9 produits gr\xe2ce aux services des Fermes : chaque bureau des Fermes enregistrait localement les \xe9tats de sortie et d\u2019entr\xe9e des marchandises entre la France et l\u2019\xe9tranger. Plus de 550 000 flux de sortie / entr\xe9e ont \xe9t\xe9 document\xe9s dans la base de donn\xe9es Toflit18."),Object(r.a)("p",null,"Gr\xe2ce aux donn\xe9es de la base Toflit18, nous sommes en mesure de lister les exports et imports entre les diff\xe9rents bureaux de ferme de la r\xe9gion et les partenaires \xe9trangers du royaume de France. Les informations que l\u2019on peut extraire de ces flux sont, entre autres, le nom du produit \xe9chang\xe9, la quantit\xe9, la valeur, le partenaire commercial, et l\u2019entit\xe9 administrative ayant enregistr\xe9 le flux au niveau local. En 1789, elles pr\xe9cisent en outre, sauf pour le commerce de r\xe9exportation des denr\xe9es coloniales, l\u2019origine du produit commercialis\xe9 (ville ou province fran\xe7aise, ou \xc9tat \xe9tranger). Elles fournissent donc des informations compl\xe9mentaires \xe0 celles donn\xe9es par les sources relatives \xe0 la navigation."),Object(r.a)("div",{className:"centered-part"},Object(r.a)("div",{className:"centered-part-contents"},Object(r.a)(i.a,{mdxType:"Caller"}),Object(r.a)("p",null,"Le croisement entre cong\xe9s de navigation et donn\xe9es fiscales de la Ferme rendu possible par les bases de donn\xe9es Toflit18 et Navigocorpus nous permet de saisir le commerce local, national et international, de pr\xe9ciser les flux et leur valeur pour ce qui est du commerce international, et d\u2019explorer les relations et l\u2019articulation entre les diff\xe9rents trafics de cette r\xe9gion."),Object(r.a)("p",null,"La pr\xe9sente \xe9tude de cas d\xe9crit en trois temps l\u2019histoire de la r\xe9gion de La Rochelle \xe0 l\u2019aube de la R\xe9volution fran\xe7aise. D\u2019abord, nous d\xe9crivons la relative perte d\u2019importance et de diversit\xe9 commerciale de la r\xe9gion \xe0 la suite de la perte du Canada par le royaume de France durant la guerre de sept ans. Nous proposons ensuite une analyse d\xe9taill\xe9e de la restructuration de la r\xe9gion en relation avec cet \xe9v\xe9nement, selon des fili\xe8res sp\xe9cialis\xe9es qui associent des ports particuliers avec le commerce de produits sp\xe9cifiques. Nous d\xe9montrons enfin que, bien que rest\xe9 dominant dans sa r\xe9gion, le port de la Rochelle a cess\xe9 de structurer la r\xe9gion de Poitou-Aunis-Saintonge au profit d\u2019un r\xe9seau d\u2019\xe9change plus diversifi\xe9."),Object(r.a)("hr",null))))}l.isMDXComponent=!0;var u=function(){return[]},d={}},211:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.015,time:900,words:3},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"Todo intro en"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},213:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return s})),a.d(t,"default",(function(){return l})),a.d(t,"tableOfContents",(function(){return u})),a.d(t,"frontMatter",(function(){return d}));var n=a(18),r=(a(4),a(5)),i=a(28),o=["components"],s={text:"6 min read",minutes:5.325,time:319500,words:1065},c={};function l(e){var t=e.components,a=Object(n.a)(e,o);return Object(r.a)("wrapper",Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"partie-1-le-d\xe9clin-de-la-r\xe9gion-de-la-rochelle-suite-\xe0-la-perte-du-canada"},"Partie 1. Le d\xe9clin de la r\xe9gion de La Rochelle suite \xe0 la perte du Canada"),Object(r.a)(i.a,{id:"viz-principale-partie-1",step:1,mdxType:"Caller"}),Object(r.a)("p",null,"Au dix-huiti\xe8me si\xe8cle, la France a pleinement profit\xe9 du d\xe9veloppement des relations \xe9conomiques entre l\u2019Afrique, l\u2019Am\xe9rique et l\u2019Europe. L\u2019 \u201cAtlantique fran\xe7ais\u201d reposant sur la traite des Africains et leur exploitation dans les \xceles fran\xe7aises (Antilles et Mascareignes) a connu son apog\xe9e juste avant la r\xe9volte de Saint-Domingue en ao\xfbt 1791 et le d\xe9but de la guerre maritime avec l\u2019Angleterre en f\xe9vrier 1793. L\u2019ancienne r\xe9gion Poitou-Charente, correspondant approximativement aux g\xe9n\xe9ralit\xe9s de Poitou, Aunis, Saintonge et Angoumois (PASA), avait une tradition maritime ancienne et \xe9tait bien situ\xe9e pour b\xe9n\xe9ficier de cet \xe9pisode de prosp\xe9rit\xe9. "),Object(r.a)(i.a,{id:"viz-principale-partie-1",step:2,mdxType:"Caller"}),Object(r.a)("p",null,"L\u2019examen du commerce avec les pays \xe9trangers et les colonies de la direction des Fermes de La Rochelle, qui \xe9tait leur fa\xe7ade maritime, montre toutefois un dynamisme limit\xe9. Il y a bien eu croissance du commerce. Mais cette croissance a \xe9t\xe9 plus lente que celle des autres grands ports du royaume. Cela s\u2019explique en grande partie par les relations privil\xe9gi\xe9es de la direction de la Rochelle avec le Canada. D\u2019une part, celui-ci se d\xe9veloppe beaucoup moins vite que les Antilles, et la r\xe9gion souffre de ce manque de dynamisme durant la premi\xe8re moiti\xe9 du si\xe8cle. D\u2019autre part, le Canada est c\xe9d\xe9 aux Anglais lors du trait\xe9 de Paris qui cl\xf4t la guerre de Sept Ans en 1763. Qu\xe9bec avait d\xe9j\xe0 \xe9t\xe9 pris en 1759. Cette perte est s\xe9v\xe8re pour la r\xe9gion dont le commerce entame alors un recul relatif tr\xe8s net. "),Object(r.a)(i.a,{id:"partie-1-evolution-de-la-part-des-echanges-de-la-rochelle-au-xviiie",mdxType:"Caller"}),Object(r.a)("p",null,"Apr\xe8s une ann\xe9e exceptionnelle en 1747, expliqu\xe9e par l\u2019organisation de convois trans-atlantiques au d\xe9part de La Rochelle escort\xe9s par la marine pour \xe9chapper aux pr\xe9dations britanniques, la direction de La Rochelle effectue 4,6% du commerce fran\xe7ais en 1750. En 1789 sa part ne repr\xe9sente plus que 2,2%."),Object(r.a)(i.a,{id:"viz-principale-partie-1",step:3,mdxType:"Caller"}),Object(r.a)("p",null,"La trajectoire de la r\xe9gion de la Rochelle contraste avec celles de Bordeaux et de Nantes. Bordeaux, notamment, est beaucoup plus dynamique que La Rochelle et sa part du commerce fran\xe7ais ne cesse d\u2019augmenter jusqu\u2019en 1789."),Object(r.a)("p",null,"Le recul de La Rochelle n\u2019est pas que quantitatif. En 1750, les donn\xe9es de la direction des Fermes de La Rochelle, charg\xe9e de la collecte des droits sur le commerce ext\xe9rieur et colonial, montre que cette partie du territoire commerce 21% des types de biens \xe9chang\xe9s par la France (645 sur 3055, apr\xe8s ",Object(r.a)("a",{parentName:"p",href:"http://toflit18.medialab.sciences-po.fr/%23/classification/browser?kind%3Dproduct%26selected%3Dproduct_orthographic%26selectedParent%3Dproduct_source&sa=D&source=editors&ust=1628385291744000&usg=AOvVaw0yo_groyaPjoKmXnYHylnb"},"uniformisation des variations orthographiques"),"). En 1789, elle n\u2019en commerce plus que 7% (248/3565). Cela s\u2019observe \xe0 la fois pour les exportations et pour les importations. \xc0 un niveau plus agr\xe9g\xe9 de typologie des produits, parmi les 150 secteurs de la ",Object(r.a)("a",{parentName:"p",href:"http://toflit18.medialab.sciences-po.fr/%23/classification/browser?kind%3Dproduct%26selected%3Dproduct_revolutionempire%26selectedParent%3Dproduct_simplification"},"classification \xabR\xe9volution et Empire\u201d, utilis\xe9e dans le cadre du programme ANR Toflit18"),", La Rochelle en commerce 121 en 1750, mais seulement 88 en 1789."),Object(r.a)("p",null,"Les exportations sont donc beaucoup plus diverses en 1750 qu\u2019en 1789. L\u2019indice de concentration (Herfindhal) est de 0,1 en 1750 et 0,24 en 1789. Un bien pour lequel il n\u2019y a pas beaucoup de concurrence nationale (les eaux-de-vie) et deux r\xe9exportations coloniales (le caf\xe9 et le sucre) dominent en 1789 les exportations. Les toiles de coton, souvent des r\xe9exportations en direction de l\u2019Afrique, sont en quatri\xe8me place, suivies du sel (dont la valeur est faible par rapport au tonnage qu\u2019il mobilise car c\u2019est une marchandise tr\xe8s pond\xe9reuse). En 1750, la mercerie et les \xe9toffes de laine font partie des cinq principales exportations (avec l\u2019indigo, les eaux-de-vie et le sucre : le sel est en 14e position). La direction des Fermes de La Rochelle s\u2019est sp\xe9cialis\xe9e dans les produits agricoles et les r\xe9exportations au d\xe9pens des biens manufactur\xe9s de la r\xe9gion. Ce jugement n\xe9gatif est toutefois nuanc\xe9 par l\u2019intensit\xe9 capitalistique de la production d\u2019eaux-de-vie qui la rapproche des biens manufactur\xe9s."),Object(r.a)("p",null,"Nous ne connaissons pas la destination des r\xe9exportations coloniales en 1789. En les excluant, on constate que la concentration des march\xe9s de la direction des Fermes de La Rochelle est la m\xeame en 1750 et en 1789 (entre 0,41 et 0,44), mais que l\u2019Angleterre a pris la place de l\u2019Am\xe9rique (d\xe9signant ici essentiellement les Antilles Fran\xe7aises). Pour aller vite, on pourrait r\xe9sumer en disant que la direction des fermes de La Rochelle n\u2019exporte plus des biens diff\xe9renci\xe9s vers le Canada, mais essentiellement des eaux-de-vie vers l\u2019Angleterre."),Object(r.a)(i.a,{id:"partie-1-produits-importants-pour-la-rochelle",mdxType:"Caller"}),Object(r.a)("p",null,"Les donn\xe9es de la navigation ne nous permettent pas d\u2019aller beaucoup plus loin dans l\u2019analyse du d\xe9clin de cette r\xe9gion: d\u2019une part, car n\u2019avons le d\xe9tail des sorties que pour la fin de l\u2019Ancien R\xe9gime, ce qui emp\xeache une analyse diachronique. D\u2019autre part, car les donn\xe9es collect\xe9es pour 1789 n\u2019apportent que des informations limit\xe9es pour ce qui est des produits transport\xe9es: les cong\xe9s du port de La Rochelle, par exemple, ne mentionnent pas la nature de la cargaison, alors que dans les autres ports de la r\xe9gion le greffier se limite le plus souvent \xe0 noter seulement l\u2019article principal qui constitue la cargaison. Les registres des cong\xe9s indiquent, toutefois, les destinations de chaque navire sorti et cette donn\xe9e permettra de constater un relatif \xe9clatement des march\xe9s de cette r\xe9gion. "),Object(r.a)("p",null,"Sans que l\u2019on puisse affirmer qu\u2019il s\u2019agit d\u2019une nouveaut\xe9, la marginalisation de de la r\xe9gion vers la fin de l\u2019Ancien R\xe9gime est confirm\xe9e par son manque de capacit\xe9 \xe0 assurer ses propres trafics. La navigation avec l\u2019\xe9tranger est assur\xe9e, \xe0 90%, par de pavillons \xe9trangers ou ext\xe9rieur \xe0 la r\xe9gion \xe9tudi\xe9e. Il s\u2019agit, pour l\u2019essentiel, des pavillons britannique et des pays de l\u2019Europe du Nord."),Object(r.a)(i.a,{id:"partie-1-pays-port-d-attache",mdxType:"Caller"}),Object(r.a)("p",null,"M\xeame Si on prend en compte la part de navigation sous pavillon fran\xe7ais assur\xe9e par des navires de la r\xe9gion \xe9tudi\xe9e, elle est en effet inf\xe9rieure \xe0 celle de la plupart des autres provinces fran\xe7aises: en 1787, les ports de l\u2019Aunis-Saintonge-Poitou assurent 51.6% du tonnage qu\u2019ils exp\xe9dient, contre 84.3% pour la Bretagne ou 58,7% pour la Guyenne. En affinant, on peut voir si la r\xe9gion \xe9tudi\xe9e assure plus ou moins que d\u2019autres ses trafics ext\xe9rieurs. "),Object(r.a)("p",null,"ON SORT LE RESTE JE LE GARDE L\xc0 PAR SUPERSTITION GUILLAUME"),Object(r.a)("p",null,"Si on regarde les d\xe9parts depuis la r\xe9gion \xe9tudi\xe9e vers de ports fran\xe7ais, calculer la part de la navigation assur\xe9e par homeport locaux en 1787 dans ports de la direction de la Rochelle vers int\xe9rieur direction / reste France / international / hors Europe et comparer avec idem pour Bordeaux et pour Nantes par ex. (en tonnage)"),Object(r.a)("p",null,"De toutes les mani\xe8res, plut\xf4t des camemberts ?"))}l.isMDXComponent=!0;var u=function(){return[]},d={}},214:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.015,time:900,words:3},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"Part 1 intro"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},215:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return s})),a.d(t,"default",(function(){return l})),a.d(t,"tableOfContents",(function(){return u})),a.d(t,"frontMatter",(function(){return d}));var n=a(18),r=(a(4),a(5)),i=a(28),o=["components"],s={text:"19 min read",minutes:18.725,time:1123500,words:3745},c={};function l(e){var t=e.components,a=Object(n.a)(e,o);return Object(r.a)("wrapper",Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"partie-2-une-forte-sp\xe9cialisation-portuaire--le-cas-de-la-traite-n\xe9gri\xe8re-du-commerce-du-sel-et-de-leau-de-vie"},"Partie 2. Une forte sp\xe9cialisation portuaire : le cas de la traite n\xe9gri\xe8re, du commerce du sel et de l\u2019eau-de-vie"),Object(r.a)(i.a,{id:"viz-principale-partie-2",step:1,highlight:"toflit18",filter:"aucun",mdxType:"Caller"}),Object(r.a)("a",{name:"t.0f6320ce23adc712cc5040ecf014facdd20d5a5b"}),Object(r.a)("a",{name:"t.0"}),Object(r.a)("p",null,"Mode d\u2019emploi pour l\u2019int\xe9gration de la visualisation principale de la partie 2 avec le texte (cet encadr\xe9 de \u201ctutoriel\u201d devra \xeatre enlev\xe9 \xe0 terme) :"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"comme partout ailleurs, une ligne qui commence par ","<","Caller signale au site qu\u2019il doit afficher une visualisation \xe0 c\xf4t\xe9 du texte qui suit"),Object(r.a)("li",{parentName:"ul"},"la partie id=\u201dviz-principale-partie-2\u201d ne doit pas \xeatre touch\xe9e, elle indique la visualisation \xe0 afficher"),Object(r.a)("li",{parentName:"ul"},"le morceaux highlight=\u201dxxx\u201d repr\xe9sente la visualisation \xe0 mettre en avant. Si elle est \xe9gale \xe0 \u201ctoflit18\u201d, le graphique toflit18 sera mis en gros et le graphique navigo en plus petit et vice-versa si elle \xe9gale \xe0 \u201cnavigo\u201d"),Object(r.a)("li",{parentName:"ul"},"le morceau filter=\u201dxxx\u201d repr\xe9sente les donn\xe9es \xe0 filtrer sur chacun des deux graphiques. Il a pour l\u2019instant quatre valeurs possibles :"),Object(r.a)("li",{parentName:"ul"},"\u201caucun\u201d : tous les flux toflit18 et les toiles navigo sont affich\xe9s"),Object(r.a)("li",{parentName:"ul"},"\u201ccolonial\u201d : "),Object(r.a)("li",{parentName:"ul"},"pour toflit18, n\u2019affiche que les flux qui concernent la classe de produits \u201cproduits coloniaux\u201d, ou le groupe de partenaires \u201cAfrique\u201d ou \u201cColonies\u201d"),Object(r.a)("li",{parentName:"ul"},"\u201ceau-de-vie\u201d :"),Object(r.a)("li",{parentName:"ul"},"pour toflit18, n\u2019affiche que les flux qui concernent la classe de produits \u201ceau-de-vie et vins divers\u201d"),Object(r.a)("li",{parentName:"ul"},"\u201csel\u201d :"),Object(r.a)("li",{parentName:"ul"},"pour toflit18, dimensionne les flux par poids (au lieu de valeur en livres tournois pour les autres filtres), et n\u2019affiche que les flux qui concernent la classe de produits \u201csel\u201d")),Object(r.a)("h2",{id:"introduction"},"Introduction"),Object(r.a)("p",null,"La r\xe9gion \xe9tudi\xe9e se caract\xe9rise par une densit\xe9 importante de ports qui entretiennent des relations plus ou moins \xe9tendues et plus ou moins intenses avec le reste de la France et du monde. "),Object(r.a)("p",null,"La carte repr\xe9sente le tonnage exp\xe9di\xe9 en 1787, \xe0 partir des cong\xe9s d\xe9livr\xe9s aux navires, toute destination confondue. Les 8 ports d\xe9passant les 10000 tonneaux entretiennent tous, sauf Marans, un commerce avec l\u2019\xe9tranger; la presque totalit\xe9 des ports sous ce seuil se cantonnent en revanche \xe0 un commerce r\xe9gional ou national."),Object(r.a)(i.a,{id:"partie-2-part-navigation-francaise",mdxType:"Caller"}),Object(r.a)("p",null,"Nos analyses ont montr\xe9 que les tonnages enregistr\xe9s \xe0 Marennes semblent surestim\xe9s \xe0 20%, et cela monte \xe0 50% dans 10% des pires cas. M\xeame en prenant en compte cette distorsion, le tonnage n\xe9cessaire aux exportations vers l\u2019\xe9tranger du port de La Rochelle n\u2019est pas le plus important dans la r\xe9gion. Comme nous le verrons ",Object(r.a)("a",{parentName:"p",href:"https://medialab.github.io/portic-storymaps-2021/fr/page/partie-3"},"dans la partie 3"),", La Rochelle n\u2019a pas un r\xf4le structurant dans les relations que les ports de cette r\xe9gion ont avec l\u2019\xe9tranger. "),Object(r.a)("p",null,"La carte permet de constater que les navires exp\xe9di\xe9s depuis l\u2019Aunis se dirigent vers l\u2019ensemble de l\u2019Europe du Nord, ceux depuis la Saintonge essentiellement vers les \xeeles britanniques et la Hollande, et que ceux au d\xe9part du Poitou, nettement moins importants en volume, privil\xe9gient l\u2019espace Baltique. Cette diff\xe9renciation est li\xe9e \xe0 la nature des produits export\xe9s et du commerce de chaque port."),Object(r.a)("p",null,"De par ses relations exclusives avec les colonies et surtout son investissement dans la traite n\xe9gri\xe8re, La Rochelle m\xe9rite une \xe9tude \xe0 part. Pour ce qui des relations avec l\u2019\xe9tranger (hors colonies), on constate des circuits relativement distincts: Noirmoutier, Ars-en-R\xe9 et Marennes - qui exportent pour l\u2019essentiel du sel, ont comme principales d\xe9bouch\xe9es ext\xe9rieures la Baltique et les pays scandinaves. Nous d\xe9velopperons ici en d\xe9tail le cas de Marennes, principal port exportateur fran\xe7ais de sel."),Object(r.a)("p",null,"Pour le commerce des eaux-de-vie, nous \xe9tudierons le cas de Tonnay-Charente. La mention de l\u2019eau-de-vie parmi les cargaisons est rare, il faut donc se tourner d\u2019abord vers la Balance du commerce, pour affiner ensuite les donn\xe9es par l\u2019analyse de la navigation. "),Object(r.a)("p",null,"L\u2019importance des tonnages impliqu\xe9s n\u2019est au demeurant pas directement corr\xe9l\xe9e \xe0 la valeur des marchandises transport\xe9es. En effet, les donn\xe9es de la Ferme donnent les valeurs suivantes:"),Object(r.a)("p",null,"Bureaux de Ferme de la direction de La Rochelle, exportations en 1789"),Object(r.a)("a",{name:"t.f271f803a2027ad5854321e7817f569fb280399d"}),Object(r.a)("a",{name:"t.1"}),Object(r.a)("p",null,"Bureau de Ferme"),Object(r.a)("p",null,"Valeur des exportations en livres tournois"),Object(r.a)("p",null,"Aligre"),Object(r.a)("p",null,"1 302 594,57"),Object(r.a)("p",null,"Charente"),Object(r.a)("p",null,"6 194 522,97"),Object(r.a)("p",null,"La Rochelle"),Object(r.a)("p",null,"7 698 983,18"),Object(r.a)("p",null,"Les Sables d\u2019Olonne"),Object(r.a)("p",null,"110 527,00"),Object(r.a)("p",null,"Marennes"),Object(r.a)("p",null,"1 921 839,39"),Object(r.a)("p",null,"Rochefort"),Object(r.a)("p",null,"274 173,22"),Object(r.a)("p",null,"Saint-Martin-de-R\xe9"),Object(r.a)("p",null,"1 209 320,67"),Object(r.a)("p",null,"(vide)"),Object(r.a)("p",null,"1 662 254,00"),Object(r.a)("p",null,"Total g\xe9n\xe9ral"),Object(r.a)("p",null,"20 374 214,99"),Object(r.a)("p",null,"Exports avec ports francs / petites \xceles: "),Object(r.a)("p",null,"Total avec ports francs / petites \xceles : "),Object(r.a)("h2",{id:"21-la-rochelle-et-le-commerce-triangulaire"},"2.1. La Rochelle et le commerce triangulaire"),Object(r.a)(i.a,{id:"viz-principale-partie-2",filter:"colonial",highlight:"toflit18",mdxType:"Caller"}),Object(r.a)("p",null,"Au XVIIIe si\xe8cle, les colonies antillaises augmentent tr\xe8s consid\xe9rablement leur production de sucre, caf\xe9, indigo et produits tinctoriaux, pour r\xe9pondre \xe0 une demande europ\xe9enne fortement orient\xe9e \xe0 la hausse. La croissance de la production passe par un nombre de plus en plus \xe9lev\xe9 de plantations, qui ont un recours massif \xe0 une main-d\u2019\u0153uvre d\u2019esclaves, que les Europ\xe9ens d\xe9portent par centaines de milliers depuis l\u2019Afrique dans le cadre de la traite n\xe9gri\xe8re. Ce commerce transatlantique d\u2019\xeatres humains, achet\xe9s sur les c\xf4tes d\u2019Afrique par les n\xe9griers europ\xe9ens, a commenc\xe9 au XVe si\xe8cle, mais il atteint son apog\xe9e au XVIIIe si\xe8cle, lorsque 6 millions d\u2019Africains sont d\xe9port\xe9s aux Am\xe9riques. La moiti\xe9 d\u2019entre eux est vendue aux Antilles. On estime \xe0 1.25 millions ","[","Silvia: \xe0 v\xe9rifier","]"," le nombre d\u2019Africains introduits dans les colonies fran\xe7aises au XVIIIe si\xe8cle. La principale destination est la colonie de Saint-Domingue (aujourd\u2019hui Ha\xefti) qui compte, \xe0 la veille de la grande r\xe9volte d\u2019esclaves de 1791, un demi-million d\u2019esclaves, dont plus de la moiti\xe9 sont n\xe9s en Afrique."),Object(r.a)(i.a,{id:"viz-principale-partie-2",filter:"colonial",highlight:"navigo",mdxType:"Caller"}),Object(r.a)("p",null,"L\u2019activit\xe9 n\xe9gri\xe8re est aux mains d\u2019armateurs priv\xe9s qui esp\xe8rent r\xe9aliser un profit lors de la revente des esclaves. Si Nantes est le principal port n\xe9grier fran\xe7ais, La Rochelle a jou\xe9 un r\xf4le significatif, tout particuli\xe8rement dans les ann\xe9es 1730\u20131740 : entre 1713 et 1744, La Rochelle arme 15% des exp\xe9ditions n\xe9gri\xe8res, sa part tombe \xe0 11% apr\xe8s la perte du Canada, en sorte que si La Rochelle est le deuxi\xe8me port n\xe9grier le plus important en France avant 1763, il passe au 4e rang par la suite."),Object(r.a)("p",null,"Malgr\xe9 un d\xe9clin relatif, l\u2019activit\xe9 n\xe9gri\xe8re rochelaise est r\xe9solument orient\xe9e \xe0 la hausse. Les armateurs rochelais passent de 4,3 armements n\xe9griers par an pour la p\xe9riode 1713\u20131744 \xe0 12,5 armements par an dans la d\xe9cennie 1783\u20131793. Pendant cette derni\xe8re, la traite est v\xe9ritablement de l\u2019activit\xe9 principale, voire presque exclusive, des armateurs rochelais: sur un total de 200 d\xe9parts depuis le port de La Rochelle de navires rochelais, un peu plus de la moiti\xe9 des tonnages se dirigent vers l\u2019Afrique (42% du total) ou vers les colonies antillaises ou les Mascareignes, le reste se r\xe9partissant entre Terre-Neuve et Saint-Pierre-et-Miquelon (9.2%) La part des armements vers l\u2019\xe9tranger est insignifiante (0.2%), et celle hors des ports limitrophes (Aunis, Poitou, Saintonge) ne d\xe9passe pas le 5%. Les trois quarts de la trentaine de navires rochelais d\xe9passant le 50 tx ","[","le plus grand faisant 827 tonneaux","]"," sortis du port de La Rochelle en 1789 se consacrent au commerce transatlantique et n\xe9grier."),Object(r.a)(i.a,{id:"partie-2-carte-direction-bateaux-de-la-rochelle",mdxType:"Caller"}),Object(r.a)("p",null,"Les donn\xe9es de la Balance du commerce confirment la centralit\xe9 du commerce colonial et n\xe9grier : en 1789, les exportations vers l\u2019Afrique repr\xe9sentent 23% du total des exportations du bureau des Fermes, alors que 73% est constitu\xe9 par les r\xe9-exportations des denr\xe9es coloniales. "),Object(r.a)("p",null,"Alors que dans la plupart des ports n\xe9griers fran\xe7ais, la part des armements n\xe9griers est nettement inf\xe9rieure \xe0 celle des armements en droiture vers les Antilles, cela n\u2019est pas le cas \xe0 La Rochelle: au d\xe9part de ce port, les trois quarts des exp\xe9ditions de 1787 destin\xe9es \xe0 approvisionner les Antilles en hommes ou en produits sont des n\xe9griers. Comme \xe0 Honfleur, il y a donc clairement, en mati\xe8re de trafics transatlantiques, une sp\xe9cialisation n\xe9gri\xe8re rochelaise. Par ailleurs, et contrairement aux autres ports fran\xe7ais qui font le commerce avec les Am\xe9riques (Marseille, Bordeaux, Nantes, Le Havre), La Rochelle a une pr\xe9f\xe9rence quasi-exclusive pour Saint-Domingue o\xf9 plusieurs grandes familles de la ville (Belin, Garesch\xe9, Poupet Rasteau) sont tr\xe8s bien implant\xe9es."),Object(r.a)("p",null,"En 1789, les 12 n\xe9griers partis de La Rochelle sont tous arm\xe9s par des n\xe9gociants rochelais. Trois autres n\xe9griers partent depuis Rochefort."),Object(r.a)("p",null,"Au total, dans les derni\xe8res ann\xe9es de l\u2019Ancien R\xe9gime, une douzaine de navires reviennent chaque ann\xe9e \xe0 La Rochelle depuis les colonies, soit en droiture, soit (et surtout) de retour d\u2019une exp\xe9dition n\xe9gri\xe8re. La valeur des produits ramen\xe9s est estim\xe9e, en 1789, \xe0 7.1 millions de livres tournois, dont 5.1 sont r\xe9export\xe9s \xe0 l\u2019\xe9tranger (ANOM, F 2 B 14, tableaux 3 et 5). Les n\xe9gociants rochelais semblent s\u2019\xeatre taill\xe9s une position forte dans le march\xe9 du caf\xe9. ",Object(r.a)("a",{parentName:"p",href:"https://drive.google.com/drive/folders/1vv6zi6QJVN203lZPTkRjLrgupEvzNW21"},"https://drive.google.com/drive/folders/1vv6zi6QJVN203lZPTkRjLrgupEvzNW21")),Object(r.a)("p",null,"Si les donn\xe9es collect\xe9es par la Balance du commerce ne permettent pas de conna\xeetre les destinations des r\xe9exportations coloniales rochelaises, les destinations des navires qui quittent le port en 1789 nous en donnent une indication approximative. Les Pays-Bas autrichiens (actuelle Belgique), les Provinces-Unies, Br\xeame, Hambourg, les ports de la Baltique re\xe7oivent chacun de navires totalisant entre 500 et 550 tonneaux. Parmi les autres destinations europ\xe9ennes des navires partis de La Rochelle, seule la Grande-Bretagne (1048 tonneaux) n\u2019est vraisemblablement pas destinataire des produits coloniaux, car elle s\u2019approvisionne dans ses propres colonies.. "),Object(r.a)("a",{name:"t.e04ea08ffc0a1e5af3987339feba50fdcd3863fc"}),Object(r.a)("a",{name:"t.2"}),Object(r.a)("p",null,"Destinations des navires vers l\u2019\xe9tranger (Afrique exclue) au d\xe9part du port de La Rochelle, 1789"),Object(r.a)("p",null,"pays"),Object(r.a)("p",null,"tx total"),Object(r.a)("p",null,"Pays-Bas autrichiens"),Object(r.a)("p",null,"512"),Object(r.a)("p",null,"Provinces-Unies"),Object(r.a)("p",null,"550"),Object(r.a)("p",null,"Br\xeame"),Object(r.a)("p",null,"520"),Object(r.a)("p",null,"Hambourg"),Object(r.a)("p",null,"530"),Object(r.a)("p",null,"Norv\xe8ge"),Object(r.a)("p",null,"150"),Object(r.a)("p",null,"Prusse (ports en Baltique)"),Object(r.a)("p",null,"370"),Object(r.a)("p",null,"Baltique (ind\xe9termin\xe9)"),Object(r.a)("p",null,"200"),Object(r.a)("p",null,"Grande-Bretagne"),Object(r.a)("p",null,"1048"),Object(r.a)("p",null,"Etats-Unis d\u2019Am\xe9rique"),Object(r.a)("p",null,"160"),Object(r.a)("p",null,"\xe9tranger (ind\xe9termin\xe9)"),Object(r.a)("p",null,"104"),Object(r.a)("p",null,"D\xe8s lors, il n\u2019est pas surprenant que le n\xe9goce rochelais porte toute son attention aux questions li\xe9es au commerce colonial et n\xe9grier. Cela appara\xeet clairement parmi les sujets discut\xe9s par la chambre de commerce de La Rochelle. L\u2019indexation faite \xe0 la main, \xe0 l\u2019\xe9poque, sur la marge des registres de d\xe9lib\xe9ration la Chambre (Arch d\xe9pt. Charente Maritime, 41 ETP 8) permet de constater que dans la seule ann\xe9e 1789, le commerce d\u2019Afrique est discut\xe9 \xe0 une trentaine de reprises, et les colonies \xe0 une 50aine des reprises, le commerce de l\u2019Inde \xe0 9; \xe0 titre de comparaison, le commerce avec l\u2019\xe9tranger est abord\xe9 11 fois en tout, et la p\xeache (avec notamment la question de la concurrence et de l\u2019admission de la p\xeache \xe9tats-unienne, tr\xe8s d\xe9battue cette ann\xe9e l\xe0 en France), 17 fois. Parmi les produits index\xe9s au marge des registres de d\xe9lib\xe9rations, les comestibles sont mentionn\xe9s 16 fois - ce qui dans la conjoncture c\xe9r\xe9ali\xe8re particuli\xe8re de l\u2019\xe9poque n\u2019est gu\xe8re \xe9tonnant-, l\u2019eau-de-vie et le vin 6, les sucres et les raffineries 8, le charbon de terre 3. On mesure clairement, en d\xe9pit d\u2019un crit\xe8re sans doute grossier, que le regard des membres de la Chambre de commerce est clairement riv\xe9 sur les colonies et \xe0 la traite. "),Object(r.a)("p",null,"Si la question de la traite est absente des cahiers de dol\xe9ances de la r\xe9gion ","[","pr\xe9ciser leur nombre et fournir un % approximatif de leur compl\xe9tude par rapport \xe0 tous ceux r\xe9dig\xe9s?","]",", la d\xe9fense des int\xe9r\xeats coloniaux appara\xeet, significativement, uniquement dans le cahier de dol\xe9ances du Tiers-\xe9tat de la ville de La Rochelle, dont les repr\xe9sentants envoy\xe9s \xe0 Versailles \u201cdemanderont la r\xe9vocation de l\u2019arr\xeat rendu au conseil du roi, le 30 ao\xfbt 1784, concernant le commerce \xe9tranger dans les colonies, et le r\xe9tablissement des dispositions des lettres patentes de 1717 et 1727, auxquelles on est redevable des progr\xe8s qu\u2019ont faits la navigation fran\xe7oise et la culture des isles fran\xe7oises de l\u2019Am\xe9rique\u201d; par ailleurs, ils \u201cdemanderont la suppression de l\u2019entrep\xf4t et des droits actuels de consommation sur les sucres, caf\xe9s et l\u2019indigo venant des colonies, et qu\u2019il soit substitu\xe9, \xe0 l\u2019entr\xe9e de la totalit\xe9 de ces denr\xe9es dans tous les ports du ro\xefaume, un droit uniforme ","[","\u2026","]"," : que le terrage des sucres \xe9tant d\xe9favorable \xe0 la navigation, s\u2019il n\u2019est pas possible de l\u2019interdire enti\xe8rement dans nos colonies, comme il l\u2019est dans les colonies anglaises, il soit au moins d\xe9fendu ","[","\u2026","]"," de l\u2019\xe9tendre davantage par de nouveaux \xe9tablissemens, et que, les sucres bruts devant \xeatre, ainsi que le coton, consid\xe9r\xe9s comme mati\xe8re premi\xe8re, il soit mis un droit \xe0 la sortie du ro\xefaume des sucres bruts, assez sensible pour que la plus grande quantit\xe9 de cette mati\xe8re soit conserv\xe9e en France et serve \xe0 relever et \xe0 soutenir les raffineries et \xe0 procurer du travail, puisque c\u2019est dans ces vues que le gouvernement d\u2019Angleterre interdit rigoureusement la sortie en nature des sucres bruts import\xe9s de ses colonies\u2026\u201d. Enfin \u201cLes d\xe9put\xe9s demanderont la r\xe9vocation de l\u2019arr\xeat du 14 avril 1785 , qui a cr\xe9\xe9 une nouvelle compagnie des Indes et de celui pour l\u2019admission des \xe9trangers dans les isles de France et de Bourbon.\u201d "),Object(r.a)("p",null,"Il faut observer que la participation rocheloise \xe0 la navigation au-del\xe0 du cap de Bonne-Esp\xe9rance est modeste: l\u2019\xe9tat des exportations de 1789, n\u2019indique que 38060 livres tournois export\xe9s vers l\u2019Inde, et rien vers les Mascareignes ","[","ANOM, COl F 2B 14, tableau 28","]",". Ces donn\xe9es semblent toutefois incompatibles avec le d\xe9part du Henri IV pour l\u2019\xeele de France et \xe0 l\u2019\xeele Bourbon, le 9 mai 1789, qui arrive \xe0 bon port en f\xe9vrier 1790, et qui n\u2019est pas un n\xe9grier ","[","Toussaint, p. 291","]"," \xe0 moins que sa cargaison ne viennent enti\xe8rement d\u2019autres directions de Fermes du royaume. En 1787, ce sont trois armements vers les Mascareignes qui partent de La Rochelle: une certaine diversification des armements coloniaux appara\xeet donc, ici comme \xe0 Bordeaux, dans les ann\xe9es 1780, lorsque la baisse des profits du commerce antillais incite \xe0 chercher des investissements plus rentables."),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"v\xe9rifier si cahiers de dol\xe9ances en parlent. ")),Object(r.a)("h2",{id:"22-le-commerce-de-leau-de-vie"},"2.2. le commerce de l\u2019eau-de-vie"),Object(r.a)(i.a,{id:"viz-principale-partie-2",filter:"eau-de-vie",mdxType:"Caller"}),Object(r.a)("p",null,"total exportations eau-de-vie depuis la France et destinations pour mesurer part direction de la Rochelle (en pr\xe9cisant le bureau des Fermes concern\xe9s)"),Object(r.a)("p",null,"Les cong\xe9s de navigation ne sont malheureusement pas de beaucoup de secours pour identifier les flux d\u2019eau-de-vie. En effet, le greffier du port de Tonnay-Charente ne prend pas le soin d\u2019annoter les cargaisons (il le fait 12 fois sur un total de 601 d\xe9parts): nous avons donc un aper\xe7u global de la navigation, sans pouvoir distinguer la nature des produits. ","[","extrait de l\u2019ouvrage sur Tonnay-Charente, paru en 2012:","]"," Si on se base sur les seules sorties de l\u2019ann\xe9e 1787, 67 navires de tonnage moyen, proche de 100 tx, quittent alors Tonnay-Charente : 42 se rendent \xe0 l\u2019\xe9tranger (en Angleterre pour les deux tiers, le reste vers les \xeeles anglo-normandes, Ostende et la Baltique) ; les 25 gros caboteurs restants se rendent \xe0 Dunkerque. On identifie ici la flotte europ\xe9enne de l\u2019eau-de-vie, qui repr\xe9sente 22 % du tonnage sortant en 1787. Un cran en dessous, on identifie un second groupe, compos\xe9 d\u2019une poussi\xe8re de petits caboteurs (tonnage moyen 35 tx) et qui repr\xe9sente tout de m\xeame 30 % du tonnage sortant. Ces navires sont align\xe9s sur une destination unique : la Rochelle. Ils sont pour partie occup\xe9s \xe0 l\u2019approvisionnement de la ville et peut-\xeatre \xe0 un commerce regional ou national: en revanche, La Rochelle a perdu le r\xf4le d\u2019entrep\xf4t pour le commerce international de l\u2019eau-de-vie qu\u2019elle avait dans les ann\xe9es 1730. Les principales maisons de n\xe9goce d\u2019eau-de-vie, en particulier Martell, n\u2019ont plus de bureaux \xe0 La Rochelle en 1789. Leurs bureaux principaux ont \xe9t\xe9 rapatri\xe9s \xe0 Tonnay-Charente et/ou d\xe9plac\xe9s \xe0 Paris.. Enfin, des unit\xe9s plus modestes (25 tx en moyenne) \xe9voluent au sein de la mer des Pertuis (depuis la Seudre sud jusqu\u2019aux Sables d\u2019Olonne) : elles repr\xe9sentent 23 % du tonnage \xe0 la sortie du port de Tonnay-Charente. Il faut remarquer que 479 de 743 cong\xe9s d\xe9livr\xe9s en 1787 dans ce port concernent les navires avalant et attach\xe9s \xe0 des ports fluviaux. Venus porter les eaux-de-vie mais aussi les pierres de carri\xe8re et les produits manufactur\xe9s de l\u2019arri\xe8re-pays \xe0 Tonnay-Charente, leurs ma\xeetres quittent ce port soit \xe0 vide, soit avec une cargaison destin\xe9e \xe0 Rochefort, La Rochelle ou bien aux ports de la mer des Pertuis, qui leur fournissent du fret de retour pour leur navigation vers l\u2019amont du fleuve Charente. ","[","Cette structure du commerce de Tonnay Charente - R\xe9v\xe9lateur du commerce d\u2019eau de vie - pourrait \xeatre montr\xe9e \xe0 l\u2019aide des diagrammes de Louvain ?","]"),Object(r.a)("p",null,"Les exportations d\u2019eau-de-vie charentaise en 1789 sont tr\xe8s sup\xe9rieures \xe0 la moyenne s\xe9culaire. L\u2019explication r\xe9side dans les modifications induites par le Trait\xe9 d\u2019Eden de 1786, qui entra\xeene une augmentation extr\xeamement importante des exportations d\u2019eau-de-vie vers l\u2019Angleterre, notamment des eaux-de-vie de qualit\xe9 produites dans la r\xe9gion de Cognac, au d\xe9triment de celles de moindre qualit\xe9. Le total des exportations d\u2019eaux-de-vie fran\xe7aises vers la Grande-Bretagne passe de 10 \xe0 15 millions de livres tournois dans les ann\xe9es 1760\u201370, \xe0 40 millions en 1787\u201389."),Object(r.a)("p",null," -",">"," voir valeur export eau-de-vie de la direction de La Rochelle dans le temps), "),Object(r.a)("p",null,"En effet, les exportations d\u2019Eaux-de-vie de 1789 semblent anormalement \xe9lev\xe9es :"),Object(r.a)("p",null,"Il faudrait avoir un graphique sur les exportations totales d\u2019eau de vie sur la France enti\xe8re et en particulier sur les g\xe9n\xe9ralit\xe9s de Bordeaux, Bayonne et Nantes. Il y aussi \xe0 partir du milieu des ann\xe9es 20 une augmentation des exportations \xe0 partir des ports m\xe9ridionaux, en particulier S\xe8te. On pourrait avoir des coupes en 1750, une autre ann\xe9e (?) et 1789. "),Object(r.a)("p",null,"Autre id\xe9e de visualisation: en 1789, regarder les origines des exports. Il est possible qu\u2019une partie des exports de la r\xe9gion de Cognac passe par Bordeaux, l\u2019Armagnac a priori passe par Bayonne (selon Cullen 1998 qui est LA r\xe9f\xe9rence sur ce th\xe8me). Il y aussi des choses int\xe9ressantes dans l\u2019article de Thierry (2013) sur Tonneau-Charente et Rochefort. Il faut distinguer aussi entre \u201ceau de vie simple\u201d et \u201ceau de vie double\u201d dans TOFLIT18, la 2e cat\xe9gorie correspond je pense \xe0 la meilleure qualit\xe9 (elle est plus ch\xe8re et on la trouve moins souvent), donc le Cognac (et Armagnac)."),Object(r.a)("p",null,"Par ailleurs, d\u2019apr\xe8s Cullen le commerce d\u2019exportation des eaux de vie conna\xeet une croissance forte apr\xe8s la fin de guerre d\u2019ind\xe9pendance am\xe9ricaine, mais il n\u2019a pas de stat tr\xe8s d\xe9taill\xe9 pour 1789."),Object(r.a)("h2",{id:"23-marennes-et-le-commerce-du-sel"},"2.3. Marennes et le commerce du sel"),Object(r.a)(i.a,{id:"viz-principale-partie-2",filter:"sel",mdxType:"Caller"}),Object(r.a)("p",null,"\u2026"),Object(r.a)("p",null,"Denr\xe9e pond\xe9reuse de faible valeur, le sel voyage d\xe8s que cela est possible par voie maritime. Les c\xf4tes de la r\xe9gion \xe9tudi\xe9e sont, avec celles du sud de la Bretagne, de tr\xe8s grands producteurs de sel. Les march\xe9s sont aussi bien nationaux - avec une demande soutenue notamment dans les ports de la Manche qui arment \xe0 la grande p\xeache - que vers les pays de l\u2019Europe du Nord, qui s\u2019approvisionnent \xe9galement au Portugal (Setubal). "),Object(r.a)("p",null,"Le bureau des fermes de Marennes est en absolu le principal exportateur de sel en France (quantit\xe9s), si l\u2019on inclut aussi les quantit\xe9s exp\xe9di\xe9es vers les ports francs fran\xe7ais. Il vient en troisi\xe8me position, derri\xe8re les bureaux du Croisic et de Saint-Martin-de-R\xe9, si on se limite aux march\xe9s ext\xe9rieurs au royaume."),Object(r.a)("p",null,"Les valeurs en jeu ne sont pas tr\xe8s \xe9lev\xe9es, compar\xe9es \xe0 celles des flux commerciaux dont il a \xe9t\xe9 question pour La Rochelle et Tonnay-Charente: le sel export\xe9 depuis Marennes, y compris \xe0 destination des ports francs fran\xe7ais, se chiffre autour de 360,000 livres tournois en 1789 (dont 141,000 vers l\u2019\xe9tranger). En revanche, son commerce alimente un mouvement portuaire extr\xeamement intense, qui fait de Marennes, en termes de nombre de navires sortis et de leur tonnage, le principal port de la r\xe9gion \xe9tudi\xe9e. Son commerce maritime est donc une activit\xe9 importante, tant pour la production locale qu\u2019il soutient, que pour l\u2019activit\xe9 induite li\xe9e \xe0 son transport (construction navale, emploi maritime)."),Object(r.a)("p",null,"Tous les flux sont l\xe0 : ",Object(r.a)("a",{parentName:"p",href:"http://toflit18.medialab.sciences-po.fr/%23/exploration/flows?sourceType%3DBest%2520Guess%2520customs%2520region%2520product%2520x%2520partner%26productClassification%3Dproduct_revolutionempire%26product%3D%255B%2522Sel%257Eproduct_revolutionempire%2522%255D%26page%3D0%26region%3D%2524all%2524%26kind%3Dtotal%26dateMin%3D1789%26dateMax%3D1789%26columns%3D%255B%2522product%2522%252C%2522region%2522%252C%2522year%2522%252C%2522partner%2522%252C%2522import%2522%252C%2522value%2522%252C%2522unitPrice%2522%252C%2522source%2522%252C%2522rawUnit%2522%255D%26orders%3D%255B%257B%2522key%2522%253A%2522unitPrice%2522%252C%2522order%2522%253A%2522DESC%2522%257D%255D"},"http://toflit18.medialab.sciences-po.fr/","#","/exploration/flows?sourceType=Best%20Guess%20customs%20region%20product%20x%20partner","&","productClassification=product","_","revolutionempire","&","product=%5B%22Sel%7Eproduct","_","revolutionempire%22%5D","&","page=0","&","region=%24all%24","&","kind=total","&","dateMin=1789","&","dateMax=1789","&","columns=%5B%22product%22%2C%22region%22%2C%22year%22%2C%22partner%22%2C%22import%22%2C%22value%22%2C%22unitPrice%22%2C%22source%22%2C%22rawUnit%22%5D","&","orders=%5B%7B%22key%22%3A%22unitPrice%22%2C%22order%22%3A%22DESC%22%7D%5D")),Object(r.a)("p",null,"(mais pas par bureau)."),Object(r.a)("p",null,"Grosses variations de prix. Pas mal de prix absurdes. D\u2019un peu moins de 36 livres \xe0 10 sous le quintal (!) "),Object(r.a)("p",null,"Exports par bureau (y compris vers la France): "),Object(r.a)("p",null,"Exports par bureau hors la France : "),Object(r.a)("p",null,"March\xe9s pour les exports :"),Object(r.a)("p",null,"March\xe9s pour les exports de Marennes:"),Object(r.a)(i.a,{id:"viz-principale-partie-2",filter:"sel",highlight:"navigo",mdxType:"Caller"}),Object(r.a)("p",null,"Les donn\xe9es sur la navigation aident \xe0 pr\xe9ciser la g\xe9ographie commerciale du sel export\xe9 depuis Marennes, m\xeame si elles n\u2019indiquent les quantit\xe9s export\xe9es. Dans la mesure o\xf9 les navires qui le transportent sortent souvent charg\xe9s enti\xe8rement de sel, on peut de mani\xe8re approximative additionner le total des tonnages des navires charg\xe9s de sel pour avoir un ordre de grandeur des trafics. \xc0 compter du r\xe8gne de Louis XIV, la l\xe9gislation relative aux gabelles fait d\u2019ailleurs obligation au chargeur de naviguer avec une cargaison compl\xe8te. Le tonnage des navires charg\xe9s de sel est donc un assez bon indicateur des quantit\xe9s export\xe9es."),Object(r.a)("p",null,"Les cong\xe9s confirment que, parmi les ports exportateurs de la r\xe9gion \xe9tudi\xe9e, la primaut\xe9 revient incontestablement \xe0 Marennes: en 1787, le tonnage additionn\xe9 de navires sortis de ports fran\xe7ais avec du sel y est de plus du double qu\u2019\xe0 Ars-en-R\xe9, le deuxi\xe8me grand exportateur de la r\xe9gion. M\xeame en prenant en compte la sur\xe9valuation des tonnages de navires \xe0 Marennes, que nous avons constat\xe9e en comparant le tonnage d\u2019un m\xeame navire relev\xe9 en plusieurs ports, Marennes demeure le principal fournisseur de sel en France, ce qui est confirm\xe9 par la Balance du commerce. La carte indique le tonnage total des navires sortis charg\xe9s du sel dans les ports de la France atlantique et leurs destinations."),Object(r.a)("p",null,"L\u2019exportation de sel est en outre une activit\xe9 quasi exclusive \xe0 Marennes : sur 1174 d\xe9parts en 1787, 990 ont charg\xe9 du sel. En 1789, ce sont 1301 sur 1481. "),Object(r.a)("p",null,"Les destinations des navires charg\xe9s de sel partis de Marennes montrent que le march\xe9 national est nettement plus important que les march\xe9s \xe9trangers additionn\xe9s. Marennes s\u2019impose donc comme un fournisseur privil\xe9gi\xe9 pour les greniers \xe0 sel des gabelles, ainsi que le montre la g\xe9ographie des destinations fran\xe7aises: elles sont souvent des ports de rupture de charge sur des estuaires : Honfleur, Nantes, Bordeaux et Libourne (sur la Dordogne), ou de ports francs (Bayonne et Dunkerque). Cette situation est peut-\xeatre \xe0 l\u2019origine de la surestimation des tonnages constat\xe9e dans ce seul port de Marennes, qui travaille vraisemblablement sous le regard serr\xe9 des agents de la Ferme. Les bureaux des fermes associ\xe9s aux autres grandes zones de production de sel - Le Croisic et Saint-Martin-de-R\xe9 - montrent une plus grande internationalisation du trafic."),Object(r.a)("p",null,"Pistes possibles:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"dvp texte sur march\xe9s ext\xe9rieurs avec valeur et quantit\xe9s (Toflit) et faire calcul valeur/tx"),Object(r.a)("li",{parentName:"ul"},"regarder si Chambre de commerce et cahiers de dol\xe9ances parlent du commerce du sel"),Object(r.a)("li",{parentName:"ul"},"Piste: v\xe9rifier qui, parmi les ports exportateurs du sel, ont de liens forts avec l\u2019\xe9tranger et mettre cela en relation, \xe9ventuellement, aux tirants d\u2019eau - tonnage moyen des navires exportateurs par destination et par port de d\xe9part. En clair: est-ce que Marennes exporte plus vers l\u2019\xe9tranger que vers le march\xe9 national compar\xe9 aux autres ports qui vendent du sel? ici on a besoin de l\u2019expertise de Thierry"),Object(r.a)("li",{parentName:"ul"},"Il y a un ouvrage r\xe9cent publi\xe9 aux PUR (et lisible sur openedition) avec 2 articles sur le sujet. Je (Lo\xefc) n\u2019ai pas eu le temps de les lire.")),Object(r.a)("hr",null))}l.isMDXComponent=!0;var u=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"21-la-rochelle-et-le-commerce-triangulaire",level:2,title:"2.1. La Rochelle et le commerce triangulaire",children:[]},{id:"22-le-commerce-de-leau-de-vie",level:2,title:"2.2. le commerce de l\u2019eau-de-vie",children:[]},{id:"23-marennes-et-le-commerce-du-sel",level:2,title:"2.3. Marennes et le commerce du sel",children:[]}]},d={}},216:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.015,time:900,words:3},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"Part 2 TODO"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},217:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return s})),a.d(t,"default",(function(){return l})),a.d(t,"tableOfContents",(function(){return u})),a.d(t,"frontMatter",(function(){return d}));var n=a(18),r=(a(4),a(5)),i=a(28),o=["components"],s={text:"8 min read",minutes:7.205,time:432300,words:1441},c={};function l(e){var t=e.components,a=Object(n.a)(e,o);return Object(r.a)("wrapper",Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"partie-3-la-rochelle-port-dominant-mais-pas-structurant"},"Partie 3. La Rochelle, port dominant mais pas structurant"),Object(r.a)(i.a,{id:"viz-principale-partie-3",step:1,mdxType:"Caller"}),Object(r.a)("p",null,"En 1789, les navires des ports locaux exportateurs de sels (Marennes, Rochefort, Ars en R\xe9) ont un tonnage moyen plus important que ceux de la Rochelle. De mani\xe8re plus surprenante, la quantit\xe9 de navires qui sortent des ports secondaires - Aligre, Charente, Marennes, Saint-Martin de R\xe9, voire m\xeame Rochefort - t\xe9moigne d\u2019un dynamisme qui \xe9chappe largement au port dominant, La Rochelle. Cette particularit\xe9 s\u2019inscrit dans une histoire maritime longue de la r\xe9gion centre-ouest."),Object(r.a)("p",null,"Jusqu\u2019\xe0 la perte des colonies nord-am\xe9ricaines, le port de La Rochelle a cultiv\xe9 une certaine sp\xe9cificit\xe9 g\xe9ographique. Quoique le port de La Rochelle pratiquait, comme la presque totalit\xe9 des ports atlantiques, le commerce antillais et n\xe9grier, une part importante et qui a progressivement augment\xe9 jusqu\u2019\xe0 repr\xe9senter plus de la moiti\xe9 de ses armements pour les colonies dans les ann\xe9es 1750 \xe9tait constitu\xe9 par le commerce nord-am\xe9ricain - Canada, Louisiane et p\xeacheries de Terre-Neuve. Cette sp\xe9cificit\xe9 g\xe9ographique a \xe9galement influ\xe9 sur sa sp\xe9cialisation par produits. Le commerce des fourrures est ainsi une sp\xe9cialit\xe9 rochelaise jusqu\u2019au d\xe9but des ann\xe9es 1760. Les fourrures \xe9taient import\xe9es non seulement du Canada, mais aussi de la Louisiane, porte de sortie des peaux de l\u2019Ohio. Ces fourrures \xe9taient pour partie r\xe9-export\xe9es en France et en Europe (principalement vers l\u2019espace allemand et en Suisse). Une part importante, les peaux de castors en particulier, n\u2019\xe9taient pas r\xe9-export\xe9es, mais alimentaient l\u2019industrie de chamoiserie niortaise et d\u2019autres localit\xe9s fran\xe7aises. En retour, les Rochelais approvisionnaient les Canadiens et la Louisiane en vivres, mati\xe8res premi\xe8res et en produits manufactur\xe9s. L\u2019Am\xe9rique du Nord \xe9tait donc un d\xe9bouch\xe9 important et facile pour les c\xe9r\xe9ales de la r\xe9gion, les \xe9toffes locales de basse qualit\xe9 et, dans une moindre mesure, le sel n\xe9cessaire aux p\xeacheries de Terre-Neuve. Ainsi, ce commerce quoique modeste avant les ann\xe9es 1740 fournissait des volumes importants d\u2019emploi dans ces trois secteurs de l\u2019\xe9conomie r\xe9gionale et contribuait \xe0 faire du port de La Rochelle, le centre de gravit\xe9 du complexe portuaire r\xe9gional. Cette domination \xe9tait renforc\xe9e par la domination des capitaux rochelais qui s\u2019investissaient de mani\xe8re prioritaire dans le commerce Atlantique - Nord am\xe9ricain et Antillais. Cette domination se mesurait notamment au d\xe9but du si\xe8cle par la pr\xe9sence des bureaux principaux des maisons de Cognac \xe0 La Rochelle. Mais, d\xe8s la crise qui suivit la chute du syst\xe8me de Law, La Rochelle commen\xe7a \xe0 perdre sa place et Tonnay-Charente \xe0 s\u2019affirmer comme le principal port d\u2019exportation de l\u2019eau-de-vie produite dans la r\xe9gion, et du Cognac en particulier. "),Object(r.a)(i.a,{id:"viz-principale-partie-3",step:2,mdxType:"Caller"}),Object(r.a)("p",null,"Ainsi, m\xeame si le port de la Rochelle domine les autres ports de la r\xe9gion par la diversit\xe9 des produits qu\u2019il importe et exporte et, surtout, par son activit\xe9 dans le commerce atlantique, les \xe9changes des ports de la r\xe9gion sont largement autonomes comme le montre le r\xe9seau des voyages de la r\xe9gion PASA de 1787 compar\xe9 \xe0 ceux des deux autres r\xe9gions situ\xe9es au nord (la Loire-Atlantique) et au sud (l\u2019Aquitaine). Les indices de centralit\xe9 compar\xe9es avec d\u2019autres r\xe9gions domin\xe9es par un port central (Sud-ouest Atlantique, Normandie, Loire-Atlantique) confirment la relative faiblesse de La Rochelle et son incapacit\xe9 \xe0 structurer les trafics maritimes locaux."),Object(r.a)("p",null,"Ce constat peut \xeatre li\xe9 historiquement \xe0 la perte des colonies Nord-am\xe9ricaines (Canada et Louisiane) qui a bris\xe9 une dynamique vertueuse qui s\u2019\xe9tait \xe9tablie dans ann\xe9es post\xe9rieures \xe0 la guerre de succession d\u2019Autriche. En effet, avant 1748, le commerce des Antilles en droiture et la traite n\xe9gri\xe8re continuaient \xe0 dominer le commerce de la Direction de la Rochelle en valeur, \xe9tant donn\xe9 le dynamisme limit\xe9 de la demande \xe9manant de l\u2019Am\xe9rique du Nord. Mais, d\xe8s la fin de la guerre de Succession d\u2019Autriche, s\u2019ouvre une p\xe9riode de croissance exceptionnelle pour le commerce avec l\u2019Am\xe9rique du Nord. Sur la p\xe9riode 1748\u20131758, La Rochelle re\xe7oit annuellement plus de 1 million 300 mille livres de peaux d\u2019Am\xe9rique du Nord, soit presque autant en valeur que de sucre des Antilles (1 million 450 mille livres). Le nombre d\u2019armements \xe0 destination du Canada est multipli\xe9 par deux alors que celui pour la Louisiane augmente de moiti\xe9. Par rapport aux ann\xe9es pr\xe9c\xe9dant la guerre, le trafic li\xe9 au commerce triangulaire baisse en moyenne d\u2019un quart pour les Antilles et de plus de moiti\xe9 pour la traite, destinations pour lesquelles les envois rochelais sont directement en concurrence avec des ports comme Bordeaux, Nantes, Rouen et m\xeame Dunkerque et Marseille. A l\u2019inverse, les rochelais ont un monopole de fait pour la Louisiane qui n\u2019int\xe9resse gu\xe8re les ports plus importants et seul Bordeaux les concurrence pour l\u2019approvisionnement du Canada. Par ailleurs, ces deux destinations offraient des possibilit\xe9s compl\xe9mentaires. D\u2019un c\xf4t\xe9, le commerce \xe0 destination du Canada pouvait se transformer en commerce triangulaire invers\xe9 - La Rochelle-Canada-Antilles - lorsque les capitaines rochelais trouvaient au Canada de quoi ravitailler les \xeeles \xe0 sucre en morue sal\xe9e et, plus rarement, en c\xe9r\xe9ales. La Louisiane permettait \xe9galement de r\xe9aliser des op\xe9rations de contrebande avec les colons espagnols, offrant la possibilit\xe9 de riches retours sous forme de piastres (Augeron : 2004; Mathieu : 1986)."),Object(r.a)(i.a,{id:"viz-principale-partie-3",step:3,mdxType:"Caller"}),Object(r.a)("p",null,"Ce commerce de niche, limit\xe9 en volume, mais cr\xe9ateur d\u2019emplois locaux et, au milieu du si\xe8cle, facteur d\u2019un dynamisme certain s\u2019\xe9croule avec la perte des colonies fran\xe7aises nord-am\xe9ricaines \xe0 la fin de la Guerre de Sept ans. Cette perte d\xe9structure durablement le commerce rochelais qui perd ses march\xe9s privil\xe9gi\xe9s et sa position dominante au sein du r\xe9seau portuaire r\xe9gional. En 1789, le commerce du port de la Rochelle est quasi-exclusivement colonial - pr\xe8s de 90% de ses exportations en valeur sont destin\xe9s \xe0 la traite africaine et aux Antilles. Les graphiques que nous proposons illustrent fid\xe8lement ces remarques. Ce d\xe9clin est visible sur le graphiquepr\xe9c\xe9dent o\xf9 l\u2019infrastructure de la province de l\u2019Aunis appara\xeet originale par le faible poids relatif de son port principal - La Rochelle - incapable de freiner le d\xe9veloppement des ports qu\u2019il maintenait dans sa d\xe9pendance avant 1763: Tonnay-Charente, Marennes, Rochefort et Ars-en-R\xe9. Dans la p\xe9riode pr\xe9-r\xe9volutionnaire (1787\u20131789), les flux de navires comme de marchandises t\xe9moignent de la recomposition de l\u2019\xe9conomie de la fa\xe7ade maritime. D\xe9sormais, la valeur des flux de marchandises au d\xe9part de Tonnay-Charente et \xe0 l\u2019arriv\xe9e de Rochefort, qui entretient directement les productions locales, se rapprochent de ceux de La Rochelle."),Object(r.a)("p",null,"Cette \xe9volution est la cons\xe9quence de plusieurs contraintes qui se renforcent: la baisse de la capitalisation des n\xe9gociants rochelais, cons\xe9quence directe de la vague de faillites qui secouent le milieu \xe0 la fin de la Guerre de Sept Ans; la fermeture des march\xe9s nord-am\xe9ricains subventionn\xe9s qui auraient permis un rebond rapide; la forte concurrence des autres ports sur la destination antillaise. Il ne restait donc que la traite n\xe9gri\xe8re. Pour l\u2019animer, les n\xe9gociants rochelais se procurent les marchandises n\xe9cessaires \xe0 ce commerce dans toute la France et l\u2019Europe et ne se fournissent que tr\xe8s peu dans l\u2019arri\xe8re-pays rochelais. Le port n\u2019est donc plus r\xe9ellement connect\xe9 \xe0 l\u2019arri\xe8re-pays et ce, d\u2019autant plus, que la faiblesse capitalistique de la place \xe9loigne les maisons de commerce sp\xe9cialis\xe9es dans le Cognac; ainsi Martell qui rapatrie leurs bureaux principaux \xe0 Tonnay-Charente ou \xe0 Paris. "),Object(r.a)(i.a,{id:"partie-3-comparaison-exports-coloniaux",mdxType:"Caller"}),Object(r.a)("p",null,"Il y a aussi l\u2019autorisation accord\xe9e en 1775 \xe0 Rochefort de faire le commerce colonial, qui signale la perte de pouvoir de La Rochelle."),Object(r.a)("p",null,"Argument du paragraphe final: "),Object(r.a)("p",null,"Sp\xe9cialisations des ports, mais sans compl\xe9mentarit\xe9: Marennes (Sel), La Rochelle (colonial), Rochefort (commerce d\u2019importation), Tonnay-Charente (eau de vie dont eau de vie double) et ports de l\u2019Ile de R\xe9 (sel + eau-de-vie)."),Object(r.a)("p",null,"Tonnage au d\xe9part des ports des diff\xe9rentes provinces en 1787, agr\xe9g\xe9 suivant que la destination est au sein de la m\xeame province (local \xe0 droite) ou en dehors (externe \xe0 gauche)"),Object(r.a)("p",null,"Valeur des exports du bureau de La Rochelle \xe0 destination des colonies:"),Object(r.a)("p",null,"1 865 652 livres tournois"),Object(r.a)("p",null,"Valeur des exports du bureau de La Rochelle \xe0 destination du reste du monde (y compris local): 240 500"),Object(r.a)("p",null,"Les exportations du bureau de La Rochelle pour les colonies et les traite repr\xe9sente 88,58% du total des exportations"),Object(r.a)("p",null,"Pour montrer que La Rochelle ne structure pas r\xe9gion, faire voir faible impact sur r\xe9gion:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"ce qui rentre des colonies en ressort (visu reexport/pas reexport)"),Object(r.a)("li",{parentName:"ul"},"\xe9tudier et visualiser origines des produits export\xe9s pour traite et commerce colonial")),Object(r.a)("p",null,"Guillaume D.: Remarque : J\u2019ai fait pour 1789. Plus calmement :"),Object(r.a)("p",null,"\xab Monde \xbb c\u2019est hors colonies (probablement les r\xe9exports coloniales)"),Object(r.a)("p",null,"Donc hors r\xe9-exports, je pense que les chiffres de Lo\xefc sont bons."),Object(r.a)("p",null,'use "/Users/guillaumedaudin/Documents/Recherche/Commerce International Fran\xe7ais XVIIIe.xls/Balance du commerce/Retranscriptions',"_","Commerce","_",'France/Donn\xe9es Stata/bdd courante.dta", clear'),Object(r.a)("p",null,"keep if year==1789"),Object(r.a)("p",null,"keep if customs","_",'office=="La Rochelle"'),Object(r.a)("p",null,"tab partner","_","simplification if partner","_",'grouping=="Monde \xbb'),Object(r.a)("p",null,"collapse (sum) value, by (partner","_","grouping)"),Object(r.a)("p",null,"egen total = total(value)"),Object(r.a)("p",null,"gen pcrt = value/total"),Object(r.a)("p",null,"br"),Object(r.a)("hr",null))}l.isMDXComponent=!0;var u=function(){return[]},d={}},218:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.015,time:900,words:3},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"Part 3 TODO"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},219:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=(a(28),["components"]),o={text:"1 min read",minutes:.235,time:14100,words:47},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"\xe0-propos"},"\xc0 propos"),Object(r.a)("p",null,"\xc0 venir :"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"contexte de PORTIC"),Object(r.a)("li",{parentName:"ul"},"r\xe9cit de la s\xe9quence qui a men\xe9 au site (datasprint, visusprint, google docs, contexte de la pand\xe9mie \u2026)"),Object(r.a)("li",{parentName:"ul"},"pr\xe9sentation technique"),Object(r.a)("li",{parentName:"ul"},"liste de tous les contributeurs au site et au datasprint")))}c.isMDXComponent=!0;var l=function(){return[]},u={}},220:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.01,time:600,words:2},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"About TODO"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},221:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=(a(28),["components"]),o={text:"1 min read",minutes:.12,time:7200,words:24},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"r\xe9f\xe9rences"},"R\xe9f\xe9rences"),Object(r.a)("p",null,"Introduire ici les r\xe9f\xe9rences de la publication."),Object(r.a)("p",null,"Documents pr\xe9liminaires d\xe9j\xe0 r\xe9alis\xe9s pouvant \xeatre utiles :"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},Object(r.a)("a",{parentName:"li",href:"https://docs.google.com/document/d/15AylB2sk_Jrru5GzLTjexs9K3iJgefhn/edit"},"https://docs.google.com/document/d/15AylB2sk","_","Jrru5GzLTjexs9K3iJgefhn/edit")," ")),Object(r.a)("hr",null))}c.isMDXComponent=!0;var l=function(){return[]},u={}},222:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.01,time:600,words:2},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"References"),Object(r.a)("p",null,"TODO"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},223:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return o})),a.d(t,"default",(function(){return c})),a.d(t,"tableOfContents",(function(){return l})),a.d(t,"frontMatter",(function(){return u}));var n=a(18),r=(a(4),a(5)),i=["components"],o={text:"1 min read",minutes:.01,time:600,words:2},s={};function c(e){var t=e.components,a=Object(n.a)(e,i);return Object(r.a)("wrapper",Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"some tests"))}c.isMDXComponent=!0;var l=function(){return[]},u={}},224:function(e,t,a){"use strict";a.r(t),a.d(t,"readingTime",(function(){return g})),a.d(t,"default",(function(){return O})),a.d(t,"tableOfContents",(function(){return x})),a.d(t,"frontMatter",(function(){return y}));var n=a(18),r=a(4),i=a(5),o=a(1);a(10);var s=a(7),c=(a(643),a(621)),l=a(61),u=a.n(l),d=(a(105).a,a(54).a),p=(a(168).a,a(225),a(32)),m=function(e){var t=e.dataFilename,n=(e.totalWidth,e.rowHeight,e.cx),i=e.cy,l=e.r,d=e.inPercentage,m=Object(r.useState)(null),f=Object(s.a)(m,2),j=f[0],b=f[1],h=Object(r.useState)(!0),g=Object(s.a)(h,2),v=g[0],O=g[1];if(Object(r.useEffect)((function(){if(t){var e="".concat("/portic-storymaps-2021","/data/").concat(t);u()(e).then((function(e){var t=e.data,a=Object(c.a)(t);b(a),O(!1)})).catch((function(e){O(!1)}))}}),[t]),v)return Object(o.jsx)("div",{children:"Chargement des donn\xe9es ..."});if(!j)return Object(o.jsx)("div",{children:"Erreur ..."});var x=a(164),y=p.None,_=p.None,w=x(n,i,l,y=Math.PI/2+(d-50)/100*Math.PI,_=3*Math.PI/2-(d-50)/100*Math.PI).map((function(e){return e.join(" ")})).join(" ");console.log('<path d="'.concat(w,'" />'));var N=x(n,i,l,y,_-2*Math.PI).map((function(e){return e.join(" ")})).join(" ");return console.log('<path d="'.concat(N,'" />')),Object(o.jsx)("div",{className:"BezierComponent",children:Object(o.jsxs)("svg",{width:1e3,height:800,style:{border:"1px solid lightgrey"},children:[Object(o.jsx)("path",{d:"".concat(w,"\n                    "),stroke:"blue","stroke-width":"10",fill:"transparent"}),Object(o.jsx)("path",{d:"".concat(N,"\n                    "),stroke:"red","stroke-width":"10",fill:"transparent"})]})})},f=function(e){var t=e.data,a=e.children,n=Object(r.useState)(null),i=Object(s.a)(n,2),l=i[0],d=i[1],p=Object(r.useState)(!0),m=Object(s.a)(p,2),f=m[0],j=m[1];return Object(r.useEffect)((function(){if(t){var e="".concat("/portic-storymaps-2021","/data/").concat(t);u()(e).then((function(e){var a,n=e.data,r=t.split(".").pop();"csv"===r?a=Object(c.a)(n):"geojson"!==r&&"json"!==r||(a=n),d(a),j(!1)})).catch((function(e){j(!1)}))}}),[t]),f?Object(o.jsx)("div",{children:"Loading"}):a(l)},j=(a(9),a(56),a(269),a(118),a(212),a(22),a(62),a(26),a(17)),b=(a(25),j.a.generic,a(80),a(104)),h=["components"],g={text:"9 min read",minutes:8.095,time:485700,words:1619},v={};function O(e){var t=e.components,a=Object(n.a)(e,h);return Object(i.a)("wrapper",Object.assign({},v,a,{components:t,mdxType:"MDXLayout"}),Object(i.a)("p",null,"Test en prod"),Object(i.a)("h2",{id:"carto-en-reactd3svg"},"Carto en react+d3+SVG"),Object(i.a)("p",null,"Ci-dessous un proto/boilerplate pour rendre du svg + donn\xe9es avec la galaxie d3 + du rendu direct en SVG via react."),Object(i.a)("h3",{id:"fond-de-carte---test-custom-layer-avec-config-coast-from-nantes-to-bordeaux"},"Fond de carte - test custom layer avec config \u201ccoast from Nantes to Bordeaux\u201d"),Object(i.a)(f,{data:"cartoweb_france_1789_geojson.geojson",mdxType:"DataProvider"},(function(e){return Object(i.a)(f,{data:"part_3_step3_viz_customs_offices_data.csv",mdxType:"DataProvider"},(function(t){return Object(i.a)(d,{layers:[{type:"choropleth",data:e,color:{field:"shortname"}},{type:"custom",data:t,renderObjects:b.b}],projectionTemplate:"coast from Nantes to Bordeaux",height:800,width:1200,mdxType:"GeoComponent"})}))})),Object(i.a)("h3",{id:"fond-de-carte---test-flows-avec-config-world"},"Fond de carte - test flows avec config \u201cWorld\u201d"),Object(i.a)(f,{data:"world_1789_23mars2021_level0.json",mdxType:"DataProvider"},(function(e){return Object(i.a)(f,{data:"aggregated_flows.json",mdxType:"DataProvider"},(function(t){return Object(i.a)(d,{layers:[{type:"choropleth",data:e,color:{field:"shortname",palette:j.a.provinces}},{type:"flows",data:t,size:{field:"tonnages_cumul\xe9s"}}],projectionTemplate:"World",height:800,width:1200,mdxType:"GeoComponent"})}))})),Object(i.a)("h3",{id:"fond-de-carte---config-france"},"Fond de carte - config \u201cFrance\u201d"),Object(i.a)(f,{data:"cartoweb_france_1789_geojson.geojson",mdxType:"DataProvider"},(function(e){return Object(i.a)(f,{data:"ports_locations_data.csv",mdxType:"DataProvider"},(function(t){return Object(i.a)(d,{layers:[{type:"choropleth",data:e,color:{field:"shortname",palette:j.a.provinces}},{type:"points",data:t,color:{field:"admiralty",palette:j.a.admiralties},size:{field:"customs_region"},label:{field:"port"}}],projectionTemplate:"France",height:800,width:1200,mdxType:"GeoComponent"})}))})),Object(i.a)("h3",{id:"fond-de-carte---config-rotated-poitou"},"Fond de carte - config \u201crotated Poitou\u201d"),Object(i.a)(f,{data:"cartoweb_france_1789_geojson.geojson",mdxType:"DataProvider"},(function(e){return Object(i.a)(f,{data:"part_3_step1_viz_data.csv",mdxType:"DataProvider"},(function(t){return Object(i.a)(d,{layers:[{type:"choropleth",data:e,color:{field:"shortname",palette:j.a.provinces}},{type:"points",data:t,color:{field:"customs_office",palette:j.a.customs_office},size:{field:"mean_tonnage"},label:{field:"port"}}],projectionTemplate:"rotated Poitou",height:800,width:1200,mdxType:"GeoComponent"})}))})),Object(i.a)("h3",{id:"fond-de-carte---config-poitou"},"Fond de carte - config \u201cPoitou\u201d"),Object(i.a)("p",null,"Cartographie des destination des bateaux aillant un port d\u2019attache dans la r\xe9gion, par tonnage cumul\xe9 (couleur = amiraut\xe9) :"),Object(i.a)(d,{backgroundFilename:"cartoweb_france_1789_geojson.geojson",dataFilename:"navigo-out-of-ships-from-region.csv",markerColor:"pointcall_admiralty",markerSize:"tonnage",label:"pointcall",showLabels:!0,projectionTemplate:"Poitou",height:800,width:1200,mdxType:"GeoComponent"}),Object(i.a)("h2",{id:"fond-de-carte-sans-template-pour-la-config"},"Fond de carte sans template pour la config"),Object(i.a)(d,{backgroundFilename:"cartoweb_france_1789_geojson.geojson",dataFilename:"navigo-out-of-ships-from-region.csv",markerColor:"pointcall_admiralty",markerSize:"tonnage",label:"pointcall",showLabels:!0,mdxType:"GeoComponent"}),Object(i.a)("h2",{id:"test-courbes-de-b\xe9zier"},"Test courbes de b\xe9zier"),Object(i.a)(m,{dataFilename:"part_3_step3_viz_customs_offices_data.csv",cx:300,cy:250,r:210,inPercentage:10,start:Math.PI/2,end:3*Math.PI/2,mdxType:"BezierComponent"}))}O.isMDXComponent=!0;var x=function(){return[{id:"carto-en-reactd3svg",level:2,title:"Carto en react+d3+SVG",children:[{id:"fond-de-carte---test-custom-layer-avec-config-coast-from-nantes-to-bordeaux",level:3,title:"Fond de carte - test custom layer avec config \u201ccoast from Nantes to Bordeaux\u201d",children:[]},{id:"fond-de-carte---test-flows-avec-config-world",level:3,title:"Fond de carte - test flows avec config \u201cWorld\u201d",children:[]},{id:"fond-de-carte---config-france",level:3,title:"Fond de carte - config \u201cFrance\u201d",children:[]},{id:"fond-de-carte---config-rotated-poitou",level:3,title:"Fond de carte - config \u201crotated Poitou\u201d",children:[]},{id:"fond-de-carte---config-poitou",level:3,title:"Fond de carte - config \u201cPoitou\u201d",children:[]}]},{id:"fond-de-carte-sans-template-pour-la-config",level:2,title:"Fond de carte sans template pour la config",children:[]},{id:"test-courbes-de-b\xe9zier",level:2,title:"Test courbes de b\xe9zier",children:[]}]},y={}},225:function(e,t,a){"use strict";var n=a(9),r=a(10),i=a(8),o=a(7),s=a(4),c=a(20),l=a(156),u=a(167),d=(a(612),a(1)),p=1e5,m=function(e){var t=e.width,a=e.height,n=.7*t,r=.05*t;return Object(d.jsx)("path",{className:"hull",d:"M 0 0 L ".concat(t/3," ",0," L ").concat(t/3," ").concat(a/4," L ").concat(.6*t," ").concat(a/4," L ").concat(.6*t," 0 L ").concat(t," 0 L ").concat(n," ").concat(a," L ").concat(r," ").concat(a," Z")})},f=function(e){var t=e.width,a=e.height,n=e.sailSpeed,r=e.distance,i=void 0===r?1:r,o=Object(s.useMemo)((function(){return.4*Math.random()+1}),[]),l=t,u=5*i,p=t+5*i,m={points:"0,".concat(.1*a," ").concat(t,",",0," ").concat(p,",").concat(a/2," ").concat(t,",").concat(.9*a," 0,").concat(a," ").concat(u," ").concat(a/2)},f={points:"0,".concat(.1*a," ").concat(t,",",0," ").concat(l,",").concat(a/2," ").concat(t,",").concat(.9*a," 0,").concat(a," ").concat(0," ").concat(a/2)},j=Object(c.useSpring)({loop:!0,to:[m,f,m],from:m,config:{duration:500*n*o}}).points;return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(c.animated.polygon,{points:j,className:"sail"})})},j=function(e){var t=e.width,a=e.height,n=e.sailSpeed,r=e.distance,i=.7*t;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("g",{transform:"translate(".concat(t/2-i/2,", ").concat(.1*a,")"),children:Object(d.jsx)(f,{sailSpeed:n,distance:r,width:i,height:a/4})}),Object(d.jsx)("g",{transform:"translate(0, ".concat(.4*a,")"),children:Object(d.jsx)(f,{sailSpeed:n,distance:r,width:t,height:.45*a})}),Object(d.jsx)("line",{x1:t/2,x2:t/2,y1:0,y2:1.1*a})]})},b=function(e){e.x;var t=e.height,a=e.distance,n=Object(s.useState)(.2),r=Object(o.a)(n,2),i=r[0],l=r[1],u=Object(s.useState)(1),p=Object(o.a)(u,2),f=p[0],b=p[1],h=Object(s.useMemo)((function(){for(var e=[],t=0;t<f;t++)e.push({heightRatio:1});return e}),[f]),g={transform:"skewX(-3)"},v=Object(c.useSpring)({loop:!0,to:[g,{transform:"skewX(3)"},g],from:g,config:{duration:3e3}}).transform;Object(s.useEffect)((function(){var e=Math.round(2*Math.random())+1,t=.1+.1*Math.random();b(e),l(t)}),[]);var O=Object(s.useMemo)((function(){return Math.random()}),[]),x=t;return Object(d.jsxs)(c.animated.g,{className:"boat",transform:v,children:[h.map((function(e,n){var r=.9*x,o=n/h.length*r,s=x/h.length*.8;return Object(d.jsx)("g",{className:"matt",transform:"translate(".concat(o,", 0)"),children:Object(d.jsx)(j,{width:s,height:t-t*i,sailSpeed:.5*O+1,distance:a})},n)})),Object(d.jsx)("g",{transform:"translate(0, ".concat(t-t*i,")"),children:Object(d.jsx)(m,{width:x,height:t*i})})]})},h=function(e){var t=e.boatHeight,a=e.containerHeight,n=e.distance,r=a/20*(n/2),o={points:"0,".concat(0,", ",r/2,",").concat(r/3," ").concat(r,",",0," ").concat(r/2," ").concat(r/2)},l={points:"0,".concat(r,", ").concat(r/2,",",0," ").concat(r,",").concat(r," ").concat(r/2," ").concat(r/3)},u=Object(s.useMemo)((function(){for(var e=[],n=0;n<30;n++){var r=Math.random()*t*1.3+a-1.5*t,i=Math.random()*t*2-t,o=Math.random()+.5;e.push({transform:"translate(".concat(i,", ").concat(r,")scale(").concat(o,")")})}return e}),[t,a]),p=Object(c.useSpring)({loop:!0,to:[o,l,o],from:o,config:{duration:300}}).points,m=Object(c.useSpring)({loop:!0,to:[].concat(Object(i.a)(u),[u[0]]),from:u[0],config:{duration:900}}).transform;return Object(d.jsx)(c.animated.g,{className:"bird",transform:m,children:Object(d.jsx)(c.animated.polygon,{points:p})})},g=function(e){var t=e.containerHeight,a=e.containerWidth,n=e.rightToLeft,r=e.startAt,i=e.size,o=e.distance,l=void 0===o?1:o,u=Object(s.useMemo)((function(){if(l>.5&&Math.random()>.5){for(var e=1+Math.round(20*Math.random()),t=[],a=0;a<e;a++)t.push(a);return t}return[]}),[l]),m=.3*-a,f=1.3*a,j={transform:"translate(".concat(n?f:m,", 0)")},g={transform:"translate(".concat(n?m:f,", 0)")};r&&(j.transform="translate(".concat(r,", 0)"));var v=Object(s.useMemo)((function(){return Math.random()}),[]),O=Object(c.useSpring)({from:j,to:g,config:{duration:p*(2-l*(1+v/10))}}).transform,x=.2*t*i*l;return Object(d.jsx)(c.animated.g,{transform:O,children:Object(d.jsxs)("g",{style:{opacity:l},transform:n?"scale(-1, 1)":"",children:[Object(d.jsx)("g",{transform:"translate(0, ".concat(t-x,")"),children:Object(d.jsx)(b,{x:0,height:x,distance:l})}),u.map((function(e){return Object(d.jsx)(h,{containerHeight:t,boatHeight:x,distance:l},e)}))]})})},v=function(e){var t=e.width,a=void 0===t?1200:t,i=e.height,c=void 0===i?100:i,p=Object(s.useReducer)((function(e,t){switch(t.type){case"removeBoat":return Object.entries(e).reduce((function(e,a){var i=Object(o.a)(a,2),s=i[0],c=i[1];return s!==t.payload?Object(r.a)(Object(r.a)({},e),{},Object(n.a)({},s,c)):e}),{});case"createBoat":default:var a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).startAt,t=void 0===e?0:e,a=Object(l.v4)(),n=.8*Math.random()+.2,r=Math.random()>=.5,i=Math.round(3*Math.random())+1;return{id:a,distance:n,rightToLeft:r,size:i,createdAt:(new Date).getTime(),startAt:t}}(t.payload);return Object(r.a)(Object(r.a)({},e),{},Object(n.a)({},a.id,a))}}),{}),m=Object(o.a)(p,2),f=m[0],j=m[1];return Object(s.useEffect)((function(){var e=setTimeout((function(){j({type:"createBoat"})}),1e4);return function(){return clearTimeout(e)}}),[f,j]),Object(u.b)((function(){var e=new Date;Object.entries(f).reduce((function(t,a){var i=Object(o.a)(a,2),s=i[0],c=i[1];return e.getTime()<c.createdAt+13e4?Object(r.a)(Object(r.a)({},t),{},Object(n.a)({},s,c)):(j({type:"removeBoat",payload:s}),t)}),{})}),4e3),Object(s.useEffect)((function(){for(var e=0;e<5;e++)j({type:"createBoat",payload:{startAt:a*Math.random()}})}),[]),Object(d.jsx)("svg",{className:"BoatsIllustration",width:a,height:c,children:Object.entries(f).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1],i=r.distance,s=r.rightToLeft,l=r.size,u=r.startAt;return Object(d.jsx)(g,{distance:i,size:l,rightToLeft:s,containerHeight:c,containerWidth:a,startAt:u},n)}))})};t.a=v},25:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return j})),a.d(t,"e",(function(){return b})),a.d(t,"c",(function(){return h}));a(10),a(7),a(18),a(621),a(61);var n=a(311),r=a.n(n),i=a(4),o=a(78),s=a(95),c=a(17),l=c.a.generic,u={fr:o.a,en:s.a},d={cmin:25.59,cmax:55.59,lmin:60.94,lmax:90.94},p=["#999"];function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fr",a=u[t]||o.a;return"".concat(e," | ").concat(a.title," | PORTIC")}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(e.length>t){for(var a=e.split(" "),n=[a[0]],r=1;n.join(" ")<t-3&&r<a.length;)n.push(a[r]),r++;return[n=n.join(" "),a.slice(r).join(" ")]}return[e,void 0]}function j(e,t){return{distance:Math.sqrt(e*e+t*t),radians:Math.atan2(t,e)}}function b(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){t.current=e})),t.current}function h(e,t){return 1!==t&&t?2===t?[l.accent1,l.accent2]:3===t?[l.dark,l.accent1,l.accent2]:r()(t,{colorSpace:d,seed:e,clustering:"force-vector"}):p}},28:function(e,t,a){"use strict";var n=a(10),r=a(7),i=a(18),o=a(4),s=a(19),c=a.n(s),l=a(156),u=a(66),d=a(1),p=["id"],m=function(e){var t=e.id,a=Object(i.a)(e,p),s=Object(o.useRef)(null),m=Object(o.useState)(Object(l.v4)()),f=Object(r.a)(m,1)[0],j=Object(o.useContext)(u.b),b=j.activeVisualization,h=j.onBlockClick,g=j.onRegisterVisualization,v=j.onUnregisterVisualization;Object(o.useEffect)((function(){return setTimeout((function(){var e=Object(n.a)({},a);e=Object(n.a)(Object(n.a)({},e),{},{ref:s,visualizationId:t,id:f}),g(e)})),v(f)}),[f]);return Object(d.jsx)("div",{ref:s,onClick:function(e){"function"===typeof h&&h(f,s)},className:c()("Caller",{"is-active":b&&f===b.id,"is-clearfix":!t,"is-hidden":!0,"is-devmode":!1}),children:null})};t.a=m},320:function(e){e.exports=JSON.parse('{"a":"http://medialab.github.io/portic-storymaps-2021"}')},371:function(e,t,a){},490:function(e,t,a){},516:function(e,t,a){},520:function(e,t,a){},521:function(e,t,a){},522:function(e,t,a){},523:function(e,t,a){},54:function(e,t,a){"use strict";var n=a(10),r=a(7),i=a(4),o=a(26),s=a(638),c=a(9),l=a(645),u=a(25),d=a(22),p=a(19),m=a.n(p),f=a(20),j=a(1),b=function(e){var t=e.d,a=(e.projection,e.project),n=e.palette,s=e.layer,c=(e.width,e.height,Object(i.useState)(!1)),l=Object(r.a)(c,2),u=l[0],d=l[1];Object(i.useEffect)((function(){setTimeout((function(){d(!0)}))}),[]);var p=a(t),m=Object(f.useSpring)({to:{d:p},immediate:!u});return Object(i.useEffect)((function(){o.a.rebuild()})),Object(j.jsx)(f.animated.path,{d:m.d,className:"geopart","data-tip":s.tooltip?s.tooltip(t):void 0,"data-for":"geo-tooltip",style:{fill:void 0!==s.color&&void 0!==n?n[t.properties[s.color.field]]:"transparent"}})},h=function(e){var t,a=e.layer,r=e.projection,i=e.width,o=e.height,s=e.reverseColors,p=Object(l.a)().projection(r);if(a.data.features&&a.color&&a.color.field){var f=Object(d.uniq)(a.data.features.map((function(e){return e.properties[a.color.field]})));if(a.color.palette)t=a.color.palette;else if(a.color.generatedPalette){var h=Object(u.c)("map",a.data.features.length);t=f.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(c.a)({},t,h[a]))}),{})}}return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("g",{className:m()("ChoroplethLayer",{"reverse-colors":s}),children:a.data.features.map((function(e,n){return Object(j.jsx)(b,{projection:r,project:p,palette:t,layer:a,d:e,width:i,height:o},e.properties.id||e.properties.name||n)}))})})},g=a(56),v=a(269),O=function(e){var t=e.projection,a=e.datum,n=e.layer,o=e.opacity,s=e.onGroupMouseEnter,c=e.onGroupMouseLeave,l=e.displayLabel,u=n.tooltip,d=a.latitude,p=a.longitude,m=a.size,b=a.color,h=a.label,g=a.rawSize,v=a.labelPosition,O=void 0===v?"right":v,x=a.labelSize,y=a.index,_=Math.sqrt(m/Math.PI),w=t([+p,+d]),N=Object(r.a)(w,2),M=N[0],C=N[1],L=Object(i.useState)(!1),k=Object(r.a)(L,2),q=k[0],T=k[1];Object(i.useEffect)((function(){setTimeout((function(){T(!0)}))}),[]);var R=Object(f.useSpring)({to:{transform:"translate(".concat(M,",").concat(C,")")},immediate:!q}).transform;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(f.animated.g,{className:"point-group",transform:R,style:{zIndex:x,opacity:o},onMouseEnter:function(){return s(y)},onMouseMove:function(){return s(y)},onMouseLeave:function(){return c()},"data-for":"geo-tooltip","data-tip":"function"===typeof u?u(a):void 0,children:[Object(j.jsx)("circle",{cx:0,cy:0,r:_,style:{fill:b},className:"marker"}),n.size.displayMetric&&x>6?Object(j.jsx)("text",{x:0,y:x/4,textAnchor:"middle",fontSize:x/2,fill:"white",children:g}):null,h&&l?Object(j.jsx)("text",{x:"right"===O?_+5:-_-5,y:_/2,fill:n.color&&n.color.labelsColor,textAnchor:"right"===O?"start":"end",fontSize:x,children:h}):null]})})},x=function(e){var t=e.layer,a=e.datum,n=e.thatIndex,o=e.opacity,s=e.stackedRowHeight,c=e.onGroupMouseEnter,l=e.onGroupMouseLeave,u=e.projection,d=t.tooltip,p=a.latitude,m=a.longitude,b=a.size,h=a.label,g=Math.sqrt(b/Math.PI),v=u([+m,+p]),O=Object(r.a)(v,2),x=O[0],y=O[1],_=Object(i.useState)(!1),w=Object(r.a)(_,2),N=w[0],M=w[1];Object(i.useEffect)((function(){setTimeout((function(){M(!0)}))}),[]);var C=Object(f.useSpring)({to:{x2:x-g,y2:y,transformLabel:"translate(".concat(.01*window.innerWidth,", ").concat(a.labelY,")")},immediate:!N}),L=C.x2,k=C.y2,q=C.transformLabel;return Object(j.jsxs)(f.animated.g,{style:{opacity:o},onMouseEnter:function(){return c(n)},onMouseMove:function(){return c(n)},onMouseLeave:function(){return l()},"data-for":"geo-tooltip","data-tip":"function"===typeof d?d(a):void 0,children:[Object(j.jsx)(f.animated.g,{className:"label-container",transform:q,children:Object(j.jsx)("text",{style:{fontSize:s},children:h})}),Object(j.jsx)(f.animated.line,{x1:s*h.length*.5+.01*window.innerWidth,y1:a.labelY-.2*s,x2:L,y2:k})]})},y=function(e){var t=e.layer,a=e.projection,s=e.width,l=e.height,p=Object(i.useState)(null),m=Object(r.a)(p,2),b=m[0],h=m[1];Object(i.useEffect)((function(){o.a.rebuild()}));var y=Object(i.useMemo)((function(){if(t.data){var e={};t.data.forEach((function(a){var n=a.latitude+","+a.longitude;e[n]?e[n].size+=isNaN(+a[t.size.field])?0:+a[t.size.field]:e[n]={label:t.label?a[t.label.field]:void 0,labelPosition:t.label?t.label.position:void 0,latitude:+a.latitude,longitude:+a.longitude,color:void 0!==t.color?a[t.color.field]:"default",size:void 0!==t.size&&void 0!==t.size.field?isNaN(+a[t.size.field])?0:+a[t.size.field]:0}}));var a,i=Object.entries(e).map((function(e){var t=Object(r.a)(e,2);t[0];return t[1]}));if(void 0!==t.color){var o=Object(d.uniq)(i.map((function(e){return e.color})));if(t.color.palette)a=t.color.palette;else{var l=Object(u.c)("map",o.length);a=o.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(c.a)({},t,l[a]))}),{})}}var p=s/300;void 0!==t.size&&void 0!==t.size.custom&&(p=parseInt(t.size.custom*s/100));var m=Object(v.a)(i.map((function(e){return e.size}))),f=[3,s/30].map((function(e){return Math.PI*e*e})),j=Object(g.a)().domain(m).range(f),b=Object(g.a)().domain(m).range([8,s/30]);return i=i.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{color:void 0!==t.color?a[e.color]:"grey",size:void 0!==t.size?void 0!==t.size.custom?p:j(e.size):s/100,rawSize:e.size,labelSize:void 0!==t.size?b(e.size):s/100})}))}}),[a,s,t]).filter((function(e){var t=e.latitude,a=e.longitude;return t&&a&&!isNaN(t)&&!isNaN(a)})).sort((function(e,t){return e.latitude>t.latitude?1:-1})),_=function(e){b!==e&&h(e)},w=function(){setTimeout((function(){null!==b&&h(null)}))},N=.1*l,M=.9*l/y.length;return t.stackLabels&&(y=y.sort((function(e,t){return e.latitude>t.latitude?-1:1})).map((function(e,t){return Object(n.a)(Object(n.a)({},e),{},{labelY:M*t+N})}))),y=y.map((function(e,t){return Object(n.a)(Object(n.a)({},e),{},{index:t})})),Object(j.jsxs)("g",{className:"PointsLayer",children:[t.stackLabels?Object(j.jsx)("g",{className:"stacked-labels-container",children:Object(j.jsx)(f.Transition,{items:y,from:{opacity:0},enter:{opacity:1},leave:{opacity:0},children:function(e,n,r){var i=e.opacity;return Object(j.jsx)(x,{projection:a,datum:n,layer:t,opacity:null!==b?b===n.index?1:.1:i,thatIndex:n.index,onGroupMouseEnter:_,onGroupMouseLeave:w,stackedRowHeight:M},n.label)}})}):null,Object(j.jsx)(f.Transition,{items:y,from:{opacity:0},enter:{opacity:1},leave:{opacity:0},children:function(e,n,r){var i=e.opacity;return Object(j.jsx)(O,{projection:a,datum:n,layer:t,opacity:null!==b?b===n.index?1:.1:i,index:n.index,onGroupMouseEnter:_,onGroupMouseLeave:w,displayLabels:!t.stackLabels},n.label)}})]})},_=a(118),w=function(e){var t=e.arrowSize,a=e.xDep,n=e.yDep,o=e.xDest,s=e.yDest,c=e.strokeWidth,l=e.width,u=e.height,d=e.projectionTemplate,p=e.datum,m=e.layer,b=e.color,h=void 0===b?"black":b,g=Object(i.useState)(!1),v=Object(r.a)(g,2),O=v[0],x=v[1];Object(i.useEffect)((function(){setTimeout((function(){x(!0)}))}),[]);var y="M ".concat(a," ").concat(n," L ").concat(o," ").concat(s),_=0,w=0,N=0,M=0;o>a?(w=n,M=s,_=a-Math.log(o-a),N=a-Math.log(o-a),s>u/2&&"World"===d&&(_-=.3*l,N-=.3*l),s>n?("France"===d&&(_-=l,N-=l),y="M ".concat(a," ").concat(n," C ").concat(_,", ").concat(w," ").concat(N,", ").concat(M," ").concat(o,", ").concat(s)):(_=a-2.5*(o-a),N=a-2.5*(o-a),w=n,M=s,y="M ".concat(a," ").concat(n," C ").concat(_,", ").concat(w," ").concat(N,", ").concat(M," ").concat(o,", ").concat(s))):s>n&&(_=o+(l/4+o>a?0:l/4),w=n,N=o+(l/4+o>a?0:l/4),M=n,y="M ".concat(a," ").concat(n," C ").concat(_,", ").concat(w," ").concat(N,", ").concat(M," ").concat(o,", ").concat(s));var C=Object(f.useSpring)({to:{xDep:a,yDep:n,xDest:o,yDest:s,d:y,strokeWidth:c,labelDepTransform:"translate(".concat(a,", ").concat(n,")"),labelDestTransform:"translate(".concat(o,", ").concat(s,")"),arrowPath:"M ".concat(a," ").concat(n," L ").concat(o," ").concat(s)},immediate:!O}),L=C.d,k=C.labelDepTransform,q=C.labelDestTransform,T=C.strokeWidth,R=.01*l;return Object(j.jsxs)("g",{className:"flow-group",children:[Object(j.jsx)("defs",{children:Object(j.jsx)("marker",{id:"triangle",viewBox:"0 0 10 10",refX:"1",refY:"5",markerUnits:"strokeWidth",markerWidth:t,markerHeight:t,orient:"auto",children:Object(j.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 Z",fill:h})})}),Object(j.jsx)(f.animated.path,{d:L,strokeWidth:3*T,fill:"none",stroke:h,opacity:0}),Object(j.jsx)(f.animated.path,{d:L,strokeWidth:T,"marker-end":"url(#triangle)",fill:"none",stroke:h}),m.label&&m.label.fields?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(f.animated.g,{className:"label",transform:k,children:Object(j.jsx)("text",{textAnchor:o<a?"start":"end",x:o<a?10+2*c:-10-c,y:.3*R,fontSize:R,children:p[m.label.fields[0]]})}),Object(j.jsx)(f.animated.g,{className:"label",transform:q,children:Object(j.jsx)("text",{textAnchor:o>a?"start":"end",x:o>a?10+2*c:-10-c,y:.3*R,fontSize:R,children:p[m.label.fields[1]]})})]}):null]})},N=function(e){var t=e.layer,a=e.projection,o=e.width,s=e.height,l=e.projectionTemplate,p=Object(i.useMemo)((function(){if(t.data){console.log("data : ",t.data);var e,a=Object(g.a)().domain([0,Object(_.a)(t.data.map((function(e){return console.log("flow[layer.size.field] : ",e[t.size.field]),+e[t.size.field]})))]).range([0,o*s/5e4]),r=a.copy().range([0,o*s/1e5]),i=t.data.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{strokeWidth:a(+e[t.size.field]),arrowSize:r(t.data.strokeWidth)})}));if(void 0!==t.color){var l=Object(d.uniq)(i.map((function(e){return e[t.color.field]})));if(t.color.palette)e=t.color.palette;else{var p=Object(u.c)("map",l.length);e=l.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(c.a)({},t,p[a]))}),{})}i=i.map((function(a){return Object(n.a)(Object(n.a)({},a),{},{color:void 0!==t.color?e[a[t.color.field]]:"grey"})}))}return console.log("grouped : ",i),i}}),[a,o,t,s]);return console.log("markerData (FlowsLayer) : ",p),Object(j.jsx)("g",{className:"FlowsLayer",children:p.filter((function(e){var t=e.latitude_dep,a=e.longitude_dep,n=e.latitude_dest,r=e.longitude_dest;return t&&a&&n&&r&&!isNaN(t)&&!isNaN(a)&&!isNaN(n)&&!isNaN(r)})).map((function(e,n){var i=e.latitude_dep,c=e.longitude_dep,u=e.latitude_dest,d=e.longitude_dest,p=e.strokeWidth,m=e.arrowSize,f=e.color,b=a([+c,+i]),h=Object(r.a)(b,2),g=h[0],v=h[1],O=a([+d,+u]),x=Object(r.a)(O,2),y=x[0],_=x[1];return Object(j.jsx)(w,{arrowSize:m,xDep:g,yDep:v,xDest:y,yDest:_,strokeWidth:p,datum:e,layer:t,width:o,color:f,height:s,projectionTemplate:l})}))})},M=function(e){var t=e.layer,a=e.projection,n=e.width,r=e.height,i=e.projectionTemplate;return Object(j.jsx)("g",{className:"CustomObjectsLayer",children:"function"===typeof t.renderObjects?t.renderObjects({data:t.data,projection:a,width:n,height:r,projectionTemplate:i}):t.data.map((function(e,o){return t.renderObject({datum:e,projection:a,width:n,height:r,projectionTemplate:i})}))})},C=a(18),L=["children","onMouseDown"],k=function(e){var t=e.children,a=e.onMouseDown,o=Object(C.a)(e,L),s=Object(i.useState)(!1),c=Object(r.a)(s,2),l=c[0],u=c[1];return Object(i.useEffect)((function(){var e;return l&&(console.log("setInterval"),e=setInterval(a,100)),function(){console.log("clearInterval"),clearInterval(e)}}),[l,a]),Object(j.jsx)("button",Object(n.a)(Object(n.a)({},o),{},{onMouseDown:function(){u(!0)},onMouseUp:function(){u(!1)},style:{background:l?"red":void 0},children:t}))},q=["value","onBlur"],T=function(e){var t=e.value,a=e.onBlur,n=(Object(C.a)(e,q),Object(i.useState)(t)),o=Object(r.a)(n,2),s=o[0],c=o[1];return Object(i.useEffect)((function(){c(t)}),[t]),Object(j.jsx)("input",{value:s,onChange:function(e){c(e.target.value)},onBlur:function(e){a(e.target.value)}})},R=a(644),P=function(e){var t=e.layers,a=e.position;return Object(j.jsxs)("div",{className:"Legend ".concat("string"===typeof a?a:""),children:[Object(j.jsx)("h5",{className:"legend-main-title",children:"L\xe9gende"}),t.map((function(e,t){var a,i,o;if(e.size&&e.size.field&&(a=!0),e.color&&e.color.field){i=!0;var s,l=Object(R.a)(e.data.map((function(t){return t[e.color.field]})));if(e.color.palette)s=e.color.palette;else{var d=Object(u.c)("map",l.length);s=l.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(c.a)({},t,d[a]))}),{})}o=Object.entries(s)}return Object(j.jsxs)(j.Fragment,{children:[a?Object(j.jsx)("div",{className:"size-legend-container",children:Object(j.jsxs)("div",{className:"size-legend-item",children:[Object(j.jsxs)("span",{className:"size-icon-container",children:[Object(j.jsx)("span",{}),Object(j.jsx)("span",{})]}),Object(j.jsx)("span",{className:"label",children:e.size.title||e.size.field})]})},t):null,i?Object(j.jsxs)("div",{className:"color-legend-container",children:[Object(j.jsx)("h6",{className:"legend-title",children:e.color.title||e.color.field}),Object(j.jsx)("ul",{className:"modalities-list",children:o.map((function(e){var t=Object(r.a)(e,2),a=t[0],n=t[1];return Object(j.jsxs)("li",{children:[Object(j.jsx)("span",{style:{background:n},className:"color-marker"}),Object(j.jsx)("span",{className:"label",children:a})]},a)}))})]},t+"b"):null]})}))]})};a(521),t.a=function(e){var t=e.width,a=void 0===t?1500:t,c=e.height,l=void 0===c?1500:c,u=e.title,d=e.layers,p=void 0===d?[]:d,m=e.projectionTemplate,f=e.projectionConfig,b=e.debug,g=void 0!==b&&b,v=e.withLegend,O=Object(i.useState)(200),x=Object(r.a)(O,2),_=x[0],w=x[1],C=Object(i.useState)(0),L=Object(r.a)(C,2),q=L[0],R=L[1],S=Object(i.useState)(a/2),z=Object(r.a)(S,2),A=z[0],F=z[1],D=Object(i.useState)(l/2),E=Object(r.a)(D,2),B=E[0],I=E[1],Y=Object(i.useState)(-1.7475027),X=Object(r.a)(Y,2),H=X[0],W=X[1],G=Object(i.useState)(46.573642),V=Object(r.a)(G,2),U=V[0],J=V[1],Z=Object(i.useState)(m),Q=Object(r.a)(Z,2),K=Q[0],$=Q[1];Object(i.useEffect)((function(){$(m)}),[m]);var ee=Object(i.useMemo)((function(){return{rotationDegree:0,centerX:2.4486203,centerY:46.8576176,scale:5*l}}),[l]),te=Object(i.useMemo)((function(){var e=Object(n.a)({},ee),t=Object(s.a)();switch(K){case"World":e=Object(n.a)(Object(n.a)({},e),{},{scale:.5*l,centerX:-1,centerY:15});break;case"coast from Nantes to Bordeaux":e=Object(n.a)(Object(n.a)({},e),{},{scale:24*l,centerX:-1.7475027,centerY:46.573642,translationX:.4*a,translationY:.28*l});break;case"Poitou":e=Object(n.a)(Object(n.a)({},e),{},{scale:30*l,centerX:-1.7475927,centerY:47.4,translationX:.45*a,translationY:0});break;case"Poitou zoomed":e=Object(n.a)(Object(n.a)({},e),{},{scale:23*l,centerX:-1.7475927,centerY:47.4,translationX:.45*a,translationY:0});break;case"rotated Poitou":e=Object(n.a)(Object(n.a)({},e),{},{rotationDegree:58,scale:32*l,centerX:-1.7475027,centerY:46.573642,translationX:.29*a,translationY:.25*l})}return void 0!==f&&(e=Object(n.a)(Object(n.a)({},e),f)),w(e.scale),R(e.rotationDegree),W(e.centerX),J(e.centerY),void 0!==e.translationX?(F(e.translationX),I(e.translationY)):(e.translationX=a/2,e.translationY=l/2,F(a/2),I(l/2)),t.scale(e.scale),t.center([e.centerX,e.centerY]),e.rotationDegree&&t.angle(e.rotationDegree),t.translate([e.translationX,e.translationY]),t}),[a,l,ee,f,K]);return Object(j.jsxs)("div",{className:"GeoComponentWrapper",children:[u?Object(j.jsx)("h5",{className:"visualization-title",children:u}):null,g?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("h2",{children:["scale: ",_,", rotation: ",q,", translationX: ",A,", translationY: ",B,", centerX: ",H,", centerY: ",U]}),Object(j.jsx)("div",{class:"table",children:Object(j.jsxs)("ul",{id:"horizontal-list",children:[Object(j.jsx)("li",{children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return w(1.6*_)},children:"scale+"})}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return w(_/1.6)},children:"scale-"})}),Object(j.jsx)("li",{children:Object(j.jsx)(T,{value:_,placeHolder:"entrez une valeur pour la scale",onBlur:function(e){var t=isNaN(+e)?_:+e;w(t)}})})]})}),Object(j.jsx)("li",{children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){console.log("DOWN !!"),R(q+2)},children:"rotation+"})}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return R(q-2)},children:"rotation-"})})]})}),Object(j.jsx)("li",{children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return F(1.2*A)},children:"translationX+"})}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return F(.8*A)},children:"translationX-"})}),Object(j.jsxs)("li",{children:["b",Object(j.jsx)(k,{onMouseDown:function(){return I(1.2*B)},children:"translationY+"})]}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return I(.8*B)},children:"translationY-"})})]})}),Object(j.jsx)("li",{children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return W(H+.3)},children:"centerX+"})}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return W(H-.3)},children:"centerX-"})}),Object(j.jsxs)("li",{children:["b",Object(j.jsx)(k,{onMouseDown:function(){return J(U+.3)},children:"centerY+"})]}),Object(j.jsx)("li",{children:Object(j.jsx)(k,{onMouseDown:function(){return J(U-.3)},children:"centerY-"})}),Object(j.jsx)("li",{children:Object(j.jsx)(T,{value:H,placeHolder:"entrez une valeur pour la latitude",onBlur:function(e){var t=isNaN(+e)?H:+e;W(t)}})}),Object(j.jsx)("li",{children:Object(j.jsx)(T,{value:U,placeHolder:"entrez une valeur pour la longitude",onBlur:function(e){var t=isNaN(+e)?U:+e;J(t)}})})]})})]})})]}):null,Object(j.jsx)("svg",{className:"GeoComponent",width:a,height:l,viewBox:"0 0 ".concat(a," ").concat(l),children:p.map((function(e,t){switch(e.type){case"choropleth":return Object(j.jsx)(h,{layer:e,projection:te,width:a,height:l,reverseColors:e.reverseColors},t);case"points":return Object(j.jsx)(y,{layer:e,projection:te,width:a,height:l},t);case"flows":return Object(j.jsx)(N,{layer:e,projection:te,width:a,height:l,projectionTemplate:K},t);case"custom":return Object(j.jsx)(M,{layer:e,projection:te,projectionTemplate:K,width:a,height:l},t);default:return Object(j.jsx)("g",{children:Object(j.jsx)("text",{children:"Unsupported layer type"})},t)}}))}),v?Object(j.jsx)(P,{layers:p,position:v}):null,Object(j.jsx)(o.a,{id:"geo-tooltip"})]})}},573:function(e,t,a){},574:function(e,t,a){},612:function(e,t,a){},615:function(e,t,a){},616:function(e,t,a){var n={"./en/about.mdx":[220],"./en/footer.mdx":[623,5],"./en/introduction.mdx":[211],"./en/metadata":[324,0],"./en/metadata.js":[324,0],"./en/part-1.mdx":[214],"./en/part-2-1.mdx":[624,6],"./en/part-2-2.mdx":[625,7],"./en/part-2-3.mdx":[626,8],"./en/part-2-intro.mdx":[216],"./en/part-3.mdx":[218],"./en/references.mdx":[222],"./en/test-scrolly.mdx":[627,9],"./en/tests.mdx":[223],"./fr/a-propos.mdx":[219],"./fr/footer.mdx":[120],"./fr/introduction.mdx":[210],"./fr/metadata":[325,1],"./fr/metadata.js":[325,1],"./fr/partie-1.mdx":[213],"./fr/partie-2.mdx":[215],"./fr/partie-3.mdx":[217],"./fr/references.mdx":[221],"./fr/test-scrolly.mdx":[628,10],"./fr/tests.mdx":[224]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return Promise.all(t.slice(1).map(a.e)).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=616,e.exports=r},617:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),i=a(121),o=(a(371),a(9)),s=a(10),c=a(8),l=a(7),u=a(36),d=a(42),p=a(303),m=a.n(p),f=a(621),j=a(642),b=a(61),h=a.n(b),g=a(76),v=a(19),O=a.n(v),x=a(26),y=a(78),_=a(95),w=a(210),N=a(211),M=a(96),C=a(306),L=a.n(C),k=a(157),q=a(18),T=a(1),R=function(e){var t=e.datasets,a=void 0===t?{}:t;return Object(T.jsxs)("div",{className:"Test",children:[Object(T.jsx)("div",{children:"Ceci est un appel pour une visualisation qui n'a pas encore \xe9t\xe9 d\xe9velopp\xe9e"}),Object.keys(a).length?Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Datasets de la visualisation :"}),Object.entries(a).map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:a}),Object(T.jsx)("pre",{children:Object(T.jsx)("code",{children:JSON.stringify(n,null,2)})})]},a)}))]}):null]})},P=a(633),S=a(158),z=a(56),A=a(22),F=a(269),D=a(118),E=a(62),B=a(17),I=function(e){for(var t=Math.round(+e)+"",a="",n=0,r=t.length-1;r>=0;r--){a=t[r]+a,3===++n&&(n=0,a=","+a)}return","===a[0]&&(a=a.slice(1)),a},Y=function(e){var t=e.data,a=e.absoluteField,r=e.shareField,i=e.herfindhalField,o=e.width,s=e.height,u=e.axisLeftTitle,d=e.axisRightTitle,p=e.startYear,m=e.endYear,f=e.fillGaps,j=e.barTooltipFn,b=e.cityName,h=e.highlightYears,g=e.title,v=e.colorScaleMessages,y=e.annotations,_=void 0===y?[]:y,w=e.margins,N=Object(n.useMemo)((function(){return t.filter((function(e){return+e.year>=p&+e.year<=m}))}),[p,m,t]),M=Object(n.useRef)(null),C=Object(n.useRef)(null),L=Object(n.useState)(s),k=Object(l.a)(L,2),q=k[0],R=k[1];Object(n.useEffect)((function(){setTimeout((function(){var e=s;M&&M.current&&(e=s-M.current.offsetHeight,C&&C.current&&(e-=C.current.offsetHeight)),R(e),x.a.rebuild()}))}),[s]);var Y=Object(F.a)(N.map((function(e){return+e.year}))),X=A.range.apply(void 0,Object(c.a)(Y)),H=Object(P.a)().domain([].concat(Object(c.a)(X),[m,m+1])).range([w.left,o-w.right]).padding(.1),W=Object(S.a)().domain(Object(F.a)(N,(function(e){return+e[i]}))).range([B.a.generic.accent2,"grey"]),G=H.domain().map((function(e){return+e})).filter((function(e){return e%5===0})),V=Object(z.a)().domain([0,Object(D.a)(N,(function(e){return+e[a]}))]).nice().range([q-w.bottom,w.top]),U=Object(z.a)().domain([0,Object(D.a)(N,(function(e){return+e[r]}))]).nice().range([q-w.bottom,w.top]),J=Object(E.axisPropsFromTickScale)(V,Math.round(q/20)).values,Z=Object(E.axisPropsFromTickScale)(U,Math.round(q/20)).values;return U.domain()[1]-U.domain()[0]<=5&&(Z=Object(E.axisPropsFromTickScale)(U,5).values),Object(T.jsxs)("div",{className:O()("LongitudinalTradeChart",{"has-highlights":void 0!==h}),children:[Object(T.jsxs)("div",{className:"chart-header",ref:M,children:[Object(T.jsx)("h3",{className:"visualization-title",style:{marginLeft:w.left},children:g}),Object(T.jsxs)("div",{className:"axis-headers-container",children:[Object(T.jsx)("div",{style:{background:u&&u.length?B.a.generic.accent2:void 0,marginLeft:w.left},className:"axis-header axis-header-left",children:u}),v?Object(T.jsx)("div",{className:"color-scale-container",children:Object(T.jsxs)("div",{className:"color-scale-detail",children:[Object(T.jsx)("div",{className:"bar",style:{background:"linear-gradient(to right, ".concat(W(W.domain()[0]),", ").concat(W(W.domain()[1]),")")}}),Object(T.jsxs)("div",{className:"labels",children:[Object(T.jsx)("span",{children:v.maximum}),Object(T.jsx)("span",{children:v.minimum})]})]})}):null,Object(T.jsx)("div",{style:{background:d&&d.length?B.a.generic.accent1:void 0,marginRight:w.right},className:"axis-header axis-header-right",children:d})]})]}),Object(T.jsxs)("svg",{width:o,height:q,children:[Object(T.jsx)("g",{className:"axis axis-left",children:Z.map((function(e){return Object(T.jsxs)("g",{className:"axis-group",children:[Object(T.jsx)("line",{x1:.8*w.left,x2:w.left,y1:U(e),y2:U(e),stroke:B.a.generic.accent2}),Object(T.jsx)("line",{x1:w.left,x2:o-w.right,y1:U(e),y2:U(e),stroke:B.a.generic.accent2,strokeDasharray:"2, 2",opacity:.2}),Object(T.jsx)("text",{x:.7*w.left,y:U(e)+q/100,fill:B.a.generic.accent2,children:Math.round(100*+e)+"%"})]})}))}),Object(T.jsx)("g",{className:"axis axis-right",children:J.map((function(e){return Object(T.jsxs)("g",{className:"axis-group",children:[Object(T.jsx)("line",{x1:H(G[0])+H.bandwidth()/2,x2:H(G[G.length-1]),y1:V(e),y2:V(e),stroke:B.a.generic.accent1,strokeDasharray:"4, 2",opacity:.5}),Object(T.jsx)("text",{x:o-w.right+2,y:V(e)+q/100,fill:B.a.generic.accent1,children:e>0?Math.round(e/1e6)+"m livres t.":0})]})}))}),Object(T.jsxs)("g",{className:"axis axis-bottom",children:[Object(T.jsx)("line",{y1:q-w.bottom,y2:q-w.bottom,x1:H(G[0])+H.bandwidth()/2,x2:H(G[G.length-1])+H.bandwidth()/2,stroke:"lightgrey"}),G.map((function(e){var t=H(e)+H.bandwidth()/2,a=q-w.bottom;return Object(T.jsxs)("g",{className:"axis-group",transform:"translate(".concat(t,", ").concat(a,")"),children:[Object(T.jsx)("line",{x1:0,x2:0,y1:0,y2:w.bottom/6,stroke:"grey"}),Object(T.jsx)("g",{transform:"translate(".concat(.5*H.bandwidth(),", ").concat(w.bottom/2,")"),children:Object(T.jsx)("text",{fill:"grey",children:e})})]},e)}))]}),Object(T.jsx)("g",{className:"annotations-container",children:_.filter((function(e){var t=e.startYear,a=e.endYear;return t>=p&&a<=m})).map((function(e,t){var a=e.startYear,n=e.endYear+1;return Object(T.jsxs)("g",{className:"annotation",children:[Object(T.jsx)("rect",{x:H(a),width:H(n)-H(a),height:q-w.top-w.bottom,y:w.top,fill:"url(#diagonalHatch)",opacity:.4}),Object(T.jsx)("line",{x1:H(a),x2:H(a),y1:w.top,y2:q-w.bottom,stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(T.jsx)("line",{x1:H(n),x2:H(n),y1:w.top,y2:q-w.bottom,stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(T.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:Object(T.jsx)("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"grey",opacity:.5,strokeWidth:1}})})]},t)}))}),Object(T.jsx)("g",{className:"bars-container",children:N.map((function(e){return Object(T.jsx)("rect",{x:H(+e.year),y:U(e[r]),width:H.bandwidth(),height:U(0)-U(e[r]),fill:i&&e[i]?W(+e[i]):B.a.generic.dark,"data-tip":j?j(e.year,(100*e[r]).toFixed(2),b,e[i]&&(+e[i]||0).toFixed(2)).replace("[colorBox]",'<span style="display:inline-block;width: .8em;height:.8em;background:'.concat(W(+e[i]||0),'"></span>')):void 0,"data-for":b,"data-effect":"solid","data-html":!0,"data-class":"bar-tooltip","data-place":"left",className:O()("graph-bar",{"is-highlighted":h&&h.includes(+e.year)})},e.year)}))}),Object(T.jsxs)("g",{className:"lines-container",children:[N.sort((function(e,t){return+e.year>+t.year?1:-1})).filter((function(e){return+e[a]})).map((function(e,t){var n=H(+e.year)+H.bandwidth()/2,r=V(+e[a]);return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("circle",{cx:n,cy:r,r:.005*o,fill:"transparent","data-tip":"".concat(e.year," : export de <strong>").concat(I(+e[a]),"</strong> livres tournois."),"data-for":b,"data-class":"bar-tooltip","data-html":!0},e.year),Object(T.jsx)("circle",{cx:n,cy:r,r:1.5,fill:B.a.generic.accent1},e.year)]})})),N.sort((function(e,t){return+e.year>+t.year?1:-1})).map((function(e,t){var n=N[t+1];if(t!==N.length-1&&!f&&+n.year!==+e.year+1)return null;if(!n)return null;var r=H(+e.year)+H.bandwidth()/2,i=H(+n.year)+H.bandwidth()/2,o=V(+e[a]),s=V(+n[a]);if(!+e[a]||!+n[a])return null;var c=+n[a]>+e[a]?+n[a]/+e[a]-1:-(1-+n[a]/+e[a]);return Object(T.jsx)("line",{x1:r,x2:i,y1:o,y2:s,stroke:B.a.generic.accent1,title:"".concat(e.year,"-").concat(n.year),strokeWidth:2,"data-tip":"".concat(e.year," \u2192 <strong>").concat(I(+e[a]),"</strong> livres tournois <br/>").concat(n.year," \u2192 <strong>").concat(I(+n[a]),"</strong> livres tournois<br/><i>(").concat(c>0?"+":"").concat(Math.round(100*c),"%)</i>"),"data-for":b,"data-class":"bar-tooltip","data-html":!0},e.year)}))]}),Object(T.jsx)("g",{className:"annotations-container",children:_.filter((function(e){var t=e.startYear,a=e.endYear;return t>=p&&a<=m})).map((function(e,t){var a=e.startYear,n=e.endYear,r=e.label,i=e.row,o=void 0===i?0:i,s=e.labelPosition,c=void 0===s?"right":s,l=n+1;return Object(T.jsxs)("g",{className:"annotation",children:["right"===c?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("line",{x1:H(l)+20,x2:H(l)+10,y1:w.top+7.5+20*o,y2:w.top+7.5+20*o,stroke:"grey","marker-end":"url(#arrowhead)"}),Object(T.jsx)("text",{x:H(l)+22,y:w.top+10+20*o,fontSize:".5rem",fill:"grey",children:r})]}):Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("line",{x1:H(a)-20,x2:H(a)-10,y1:w.top+7.5+20*o,y2:w.top+7.5+20*o,stroke:"grey","marker-end":"url(#arrowhead)"}),Object(T.jsx)("text",{x:H(a)-22,y:w.top+10+20*o,fontSize:".5rem",textAnchor:"end",fill:"grey",children:r})]}),Object(T.jsx)("defs",{children:Object(T.jsx)("marker",{id:"arrowhead",markerWidth:"5",markerHeight:"5",refX:"0",refY:"2.5",orient:"auto",children:Object(T.jsx)("polygon",{stroke:"grey",fill:"transparent",points:"0 0, 5 2.5, 0 5"})})}),Object(T.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:Object(T.jsx)("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"grey",opacity:.5,strokeWidth:1}})})]},t)}))})]}),Object(T.jsx)(x.a,{id:b})]})},X=function(e){var t=e.data,a=e.tradeData,r=void 0===a?[]:a,i=e.field,u=e.partTreshold,d=e.height,p=e.barWidth,m=e.herfindhalField,f=e.years,j=e.width,b=e.title,h=e.margins,g=e.productTooltipFn,v=e.compareFrom,y=Object(n.useRef)(null),_=Object(n.useRef)(null),w=Object(n.useRef)(new Array(f.length));Object(n.useEffect)((function(){setTimeout((function(){x.a.rebuild()}))}),[d]);var N=Object(n.useState)(void 0),M=Object(l.a)(N,2),C=M[0],L=M[1],k=d,q=k/20+10;y&&y.current&&(k=d-y.current.getBoundingClientRect().height-q);var R=Object(n.useMemo)((function(){if(v){var e,a=f[f.length-1],n=t.filter((function(e){return e.year+""===a+""})),r=Object(A.sum)(n.map((function(e){return+e[i]}))),c=0,l=Object(A.sortBy)(n,(function(e){return-e[i]})).filter((function(e){return(c+=+e[i])<=u*r})),d=l.map((function(e){return e.product})),p=(e={},Object(o.a)(e,i,r-Object(A.sum)(l.map((function(e){return+e[i]})))),Object(o.a)(e,"product","".concat(n.length-l.length," autres types de produits")),e);return l.push(p),f.reduce((function(e,n){var r;if(n===a)return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},n,l));var c=t.filter((function(e){return e.year+""===n+""})),u=Object(A.sum)(c.map((function(e){return+e[i]}))),p=c.filter((function(e){return d.includes(e.product)})).sort((function(e,t){return+e[i]>+t[i]?-1:1}));return p.push((r={},Object(o.a)(r,i,u-Object(A.sum)(p.map((function(e){return+e[i]})))),Object(o.a)(r,"product","".concat(c.length-p.length," autres types de produits")),r)),Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},n,p))}))}return f.reduce((function(e,a){var n,r=t.filter((function(e){return e.year+""===a+""})),c=Object(A.sum)(r.map((function(e){return+e[i]}))),l=0,d=Object(A.sortBy)(r,(function(e){return-e[i]})).filter((function(e){return(l+=+e[i])<=u*c})),p=(n={},Object(o.a)(n,i,c-Object(A.sum)(d.map((function(e){return+e[i]})))),Object(o.a)(n,"product","".concat(r.length-d.length," autres types de produits")),n);return d.push(p),Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},a,d))}),{})}),[f,JSON.stringify(t)]),P=Object(n.useMemo)((function(){return f.filter((function(e,t){return t<f.length-1})).map((function(e,t){var a=f[t+1],n=R[e+""],r=R[a+""];if(!r)return null;var o=Object(A.sum)(n.map((function(e){return+e[i]}))),s=Object(A.sum)(r.map((function(e){return+e[i]}))),l=0;return n.reduce((function(e,t,a){var n,u=0,d=t[i]/o*k;return l+=d,r.find((function(e){return n=function(e){return e/s*k}(e[i]),u+=n,e.product===t.product}))?[].concat(Object(c.a)(e),[{product:t.product,y1:l,height1:d,y2:u-n,height2:n}]):e}),[])}))}),[R,f,k]),D=Object(S.a)().domain(Object(F.a)(r,(function(e){return+e[m]}))).range([B.a.generic.accent2,"grey"]),E=w.current&&w.current.length&&w.current[0]?w.current[0].parentNode.offsetTop:void 0;return Object(T.jsxs)("div",{className:"ProductsDistributionChart",children:[Object(T.jsx)("h3",{className:"visualization-title",style:{marginLeft:h.left},ref:y,children:b}),Object(T.jsxs)("div",{className:O()("years-container",{"has-highlights":void 0!==C}),style:{marginLeft:h.left+5,marginRight:h.right+.002*j},children:[Object(T.jsx)("svg",{ref:_,className:O()("links-container",{"has-highlights":C}),style:{top:E},width:j,height:k,children:P.map((function(e,t){var a=w.current&&w.current.length>=t&&w.current[t]&&w.current[t],n=w.current&&w.current.length>=t+1&&w.current[t+1]&&w.current[t+1],r=a?w.current[t].getBoundingClientRect().width:0,i=n&&_.current?w.current[t+1].getBoundingClientRect().x-_.current.getBoundingClientRect().x:j;return Object(T.jsx)("g",{className:"year-links",children:e.map((function(e,t){var a=e.product,n=e.y1-e.height1/2,o=e.y2+e.height2/2,s=C===a;return Object(T.jsx)("path",{d:"M ".concat(r," ").concat(n," C ").concat(r+.5*(i-r)," ").concat(n," ").concat(r+.5*(i-r)," ").concat(o," ").concat(i," ").concat(o),className:O()("link",{"is-highlighted":s})})}))},t)}))}),f.map((function(e,a){var n=t.filter((function(t){return t.year+""===e+""})),o=r.filter((function(t){return t.year===e+""})),s=o&&+o[0][m],c=s?D(+s):"lightgrey",l=Object(A.sum)(n.map((function(e){return+e[i]}))),u=R[e+""],d=Object(z.a)().domain(Object(F.a)(n,(function(e){return+e[i]}))).range([k/100,k/15]);return Object(T.jsxs)("div",{className:"year-column",children:[Object(T.jsx)("h4",{className:"year-label",children:Object(T.jsx)("span",{children:e})}),Object(T.jsxs)("div",{className:"year-items",children:[Object(T.jsx)("div",{className:"dimensions-placeholder",ref:function(e){w.current[a]=e},style:{width:"".concat(p,"px"),height:0,position:"absolute",top:0,left:a===f.length-1?void 0:0,right:a===f.length-1?0:void 0}}),u&&u.map((function(t,n){var r,o=C===t.product,s=n===u.length-1?10:d(+t[i]);return o&&s<10&&(s=10),Object(T.jsxs)("div",{style:{height:"".concat((r=t[i],r/l*k),"px")},className:O()("product-group",{"is-highlighted":o}),onClick:function(){C!==t.product&&n!==u.length-1?L(t.product):L(void 0)},"data-tip":g&&n!==u.length-1?g(e,t.product,(t[i]/l*100).toFixed(2)):void 0,"data-for":"product-tooltip","data-html":!0,"data-class":"bar-tooltip","data-place":0===a?"right":"left","data-effect":"solid",children:[Object(T.jsx)("div",{style:{height:"100%",width:"".concat(p,"px"),maxWidth:"".concat(p,"px"),minWidth:"".concat(p,"px"),backgroundColor:c},className:"bar"}),Object(T.jsx)("span",{className:"label",style:{fontSize:s},children:t.product})]},t.product)}))]})]},e)}))]}),Object(T.jsx)(x.a,{id:"product-tooltip"})]})},H=(a(490),function(e){var t=e.width,a=e.height,n=e.lang,r=void 0===n?"fr":n,i=e.startYear,o=void 0===i?1720:i,s=e.endYear,c=void 0===s?1789:s,u=e.productTradePartThreshold,d=void 0===u?.9:u,p=e.rows,m=e.datasets,f=void 0===m?{}:m,j=e.atlasMode,b=j?1200:a,h={franceOverviewTitle:{fr:function(e,t){return"\xc9volution de la valeur des exports du royaume de France de ".concat(e," \xe0 ").concat(t)},en:function(e,t){return"Evolution of the value of exports from the kingdom of France from ".concat(e," to ").concat(t)}},tradeEvolutionTitle:{fr:function(e,t,a){return"\xc9volution du commerce de la direction des fermes de ".concat(e," de ").concat(t," \xe0 ").concat(a)},en:function(e,t,a){return"Evolution of the direction des fermes of ".concat(e," trade from ").concat(t," to ").concat(a)}},top90PctTitle:{fr:function(e,t,a){return"Comparaison des parts des produits export\xe9s par la direction des fermes de ".concat(e," totalisant plus de 90% du commerce en ").concat(t," et en ").concat(a," (ports francs non pris en compte)")},en:function(e,t,a){return"Comparison of shares of the top 90% of exported products by the direction des fermes of ".concat(e," in ").concat(t," and in ").concat(a," (ports francs non pris en compte)")}},partInPct:{fr:function(){return"part des exports fr."},en:function(){return"share of french exports"}},absoluteValue:{fr:function(){return"valeur absolue des exports"},en:function(){return"exports' absolute value"}},herfindalLegendTitle:{fr:function(){return"degr\xe9 de diversit\xe9 du commerce"},en:function(){return"degree of trade diversity"}},herfindal0:{fr:function(){return"commerce peu diversifi\xe9"},en:function(){return"fewly diversified trade"}},herfindal1:{fr:function(){return"commerce tr\xe8s diversifi\xe9"},en:function(){return"very diversified trade"}},barTooltip:{fr:function(e,t,a,n){return"En <strong>".concat(e,"</strong>, ").concat(t,"% des biens export\xe9s depuis la France le sont \xe0 partir de <strong>").concat(a,"</strong>.<br/><br/>Concentration du commerce <i>(indice de Herfindahl-Hirschmann : somme du carr\xe9 des parts du march\xe9 fran\xe7ais par classe de produits export\xe9s)</i> : <span>[colorBox] ").concat(n,"</span>")},en:function(e,t,a,n){return"In <strong>".concat(e,"</strong>, ").concat(t,"% of exported goods from France are exported <strong>").concat(a,"</strong>.<br/><br/>Trade concentration <i>(Herfindahl-Hirschmann index : sum of square french market' shares sorted by exported products classes)</i> : <span>[colorBox] ").concat(n,"</span>")}},productTooltip:{fr:function(e,t,a){return"En <strong>".concat(e,'</strong>, les produits de la classe "').concat(t,'" repr\xe9sentent <strong>').concat(a,"%</strong> de la valeur des biens export\xe9s par la direction des fermes de La Rochelle.")},en:function(e,t,a){return"In <strong>".concat(e,'</strong>, products classed as "').concat(t,'" represent ').concat(a,"% of goods exported by La Rochelle's direction des fermes.")}},sevenYearsWar:{fr:function(){return"guerre de sept ans"},en:function(){return"seven years war"}},austriaWar:{fr:function(){return"guerre franco-britannique au sein de la guerre de succession d\u2019Autriche"},en:function(){return"guerre franco-britannique au sein de la guerre de succession d\u2019Autriche"}},usIndependance:{fr:function(){return"guerre d\u2019ind\xe9pendance Am\xe9ricaine"},en:function(){return"guerre d\u2019ind\xe9pendance Am\xe9ricaine"}},laRochelleDiaspora:{fr:function(){return"Organisation de convois partant de La Rochelle pour \xe9chapper aux Anglais"},en:function(){return"Organisation de convois partant de La Rochelle pour \xe9chapper aux Anglais"}}},g={top:10,right:50,bottom:30,left:50},v=Object.entries(p).reduce((function(e,t){var a=Object(l.a)(t,2);a[0];return e+a[1]}),0),x=function(e,a,n){switch(e){case"France":return f["decline_longitudinal_data.csv"]?Object(T.jsx)(Y,{width:t,height:b/v*a,data:f["decline_longitudinal_data.csv"].filter((function(e){return"France"===e.region})),absoluteField:"Exports",title:h.franceOverviewTitle[r](o,c),axisLeftTitle:"",axisRightTitle:h.absoluteValue[r](),margins:g,annotations:[{type:"span",startYear:1756,endYear:1763,label:h.sevenYearsWar[r]()},{type:"span",startYear:1744,endYear:1748,row:.5,label:h.austriaWar[r]()},{type:"span",startYear:1778,endYear:1781,labelPosition:"left",row:3,label:h.usIndependance[r]()}],startYear:o,endYear:c}):null;case"La Rochelle":return f["decline_longitudinal_data.csv"]?Object(T.jsx)(Y,{width:t,height:b/v*a,data:f["decline_longitudinal_data.csv"].filter((function(e){return"La Rochelle"===e.region})),absoluteField:"Exports",shareField:"Exports_share",herfindhalField:"product_revolutionempire_exports_herfindahl",title:h.tradeEvolutionTitle[r]("La Rochelle",o,c),axisLeftTitle:h.partInPct[r](),axisRightTitle:h.absoluteValue[r](),margins:g,barTooltipFn:h.barTooltip[r],cityName:"La Rochelle",highlightYears:p.comparison>0?[o,c]:void 0,annotations:[{type:"span",startYear:1756,endYear:1763,label:h.sevenYearsWar[r]()},{type:"span",startYear:1744,endYear:1748,row:1,label:h.austriaWar[r]()},{type:"span",startYear:1747,endYear:1747,row:2,label:h.laRochelleDiaspora[r]()},{type:"span",startYear:1778,endYear:1781,labelPosition:"left",row:3,label:h.usIndependance[r]()}],colorScaleMessages:{title:h.herfindalLegendTitle[r](),minimum:h.herfindal0[r](),maximum:h.herfindal1[r]()},startYear:o,endYear:c}):null;case"Bordeaux":return f["decline_longitudinal_data.csv"]?Object(T.jsx)(Y,{width:t,height:b/v*a,data:f["decline_longitudinal_data.csv"].filter((function(e){return"Bordeaux"===e.region})),absoluteField:"Exports",shareField:"Exports_share",herfindhalField:"product_revolutionempire_exports_herfindahl",title:h.tradeEvolutionTitle[r]("Bordeaux",o,c),axisLeftTitle:h.partInPct[r](),axisRightTitle:h.absoluteValue[r](),barTooltipFn:h.barTooltip[r],cityName:"Bordeaux",annotations:[{type:"span",startYear:1756,endYear:1763,row:.5,label:h.sevenYearsWar[r]()},{type:"span",startYear:1744,endYear:1748,row:0,label:h.austriaWar[r]()},{type:"span",startYear:1778,endYear:1781,labelPosition:"left",row:1,label:h.usIndependance[r]()}],margins:g,colorScaleMessages:{title:h.herfindalLegendTitle[r](),minimum:h.herfindal0[r](),maximum:h.herfindal1[r]()},startYear:o,endYear:c}):null;case"comparison":return f["decline_LR_products.csv"]&&f["decline_longitudinal_data.csv"]?Object(T.jsx)(X,{data:f["decline_LR_products.csv"],tradeData:f["decline_longitudinal_data.csv"],field:"Exports",partTreshold:d,height:b/v*a,barWidth:.02*t,years:[j?1750:o,j?1789:c],margins:g,herfindhalField:"product_revolutionempire_exports_herfindahl",title:h.top90PctTitle[r]("La Rochelle",j?1750:o,j?1789:c),productTooltipFn:h.productTooltip[r],width:t},n):null;default:return Object(T.jsx)("div",{children:e})}};return Object(T.jsx)("div",{className:"DeclineComponent",children:Object.entries(p).map((function(e,t){var a=Object(l.a)(e,2),n=a[0],r=a[1];return Object(T.jsx)("div",{className:O()("row",{"is-visible":p[n]}),children:x(n,r,t)})}))})}),W=["width","height","step"],G=function(e){var t=e.width,a=e.height,n=e.step,r=Object(q.a)(e,W);if(r.atlasMode)return Object(T.jsx)(H,Object(s.a)({startYear:1720,endYear:1789,rows:{France:1,"La Rochelle":1,Bordeaux:1,comparison:1}},Object(s.a)({width:t,height:a},r)));switch(n+""){case"1":return Object(T.jsx)(H,Object(s.a)({startYear:1720,endYear:1789,rows:{France:2,"La Rochelle":3,Bordeaux:3,comparison:0}},Object(s.a)({width:t,height:a},r)));case"2":return Object(T.jsx)(H,Object(s.a)({startYear:1720,endYear:1789,rows:{France:0,"La Rochelle":1,Bordeaux:1,comparison:0}},Object(s.a)({width:t,height:a},r)));case"3":return Object(T.jsx)(H,Object(s.a)({startYear:1750,endYear:1789,rows:{France:0,"La Rochelle":1,Bordeaux:0,comparison:2}},Object(s.a)({width:t,height:a},r)));case"4":default:return Object(T.jsx)(H,Object(s.a)({startYear:1750,endYear:1789,rows:{France:1,"La Rochelle":1,Bordeaux:0,comparison:1}},Object(s.a)({width:t,height:a},r)))}},V=a(634),U=a(635),J=a(636),Z=a(310),Q=a.n(Z),K=(a(516),a(119)),$=a(644),ee=a(25),te=[V.a,U.a,J.a],ae=function(e){var t=e.data,a=void 0===t?[]:t,r=e.sumBy,i=e.steps,u=e.width,d=void 0===u?1200:u,p=e.height,m=void 0===p?800:p,f=e.filters,j=void 0===f?[]:f,b=e.debug,h=void 0!==b&&b,g=e.title,v=e.colorsPalettes,y=e.centerHorizontalLabels,_=void 0===y||y,w=e.displaceHorizontalLabels,N=void 0===w||w,M=e.tooltips,C=e.lang,L=Object(n.useRef)(null),k=L.current?m-L.current.getBoundingClientRect().height:m,q=Object(n.useState)(void 0),R=Object(l.a)(q,2),P=R[0],S=R[1],A=Object(n.useState)(void 0),F=Object(l.a)(A,2),D=F[0],E=F[1],B=Object(n.useMemo)((function(){return function(e,t){var a=t.sumBy,n=t.steps,r=e.map((function(e,t){return Object(s.a)(Object(s.a)({},e),{},{_id:t})})),i=n.map((function(e,t){var n=e.filters,i=r;n&&n.length&&(i=n.reduce((function(e,t){var a=t.key,n=t.value;return e.filter((function(e){return e[a]===n}))}),i));var o=Q()(i,(function(t){return t[e.field]})),c=(o=Object.entries(o).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1].map((function(e){var t;if(a){var n=e[a];t=+(n=""===n?0:n)}else t=1;return Object(s.a)(Object(s.a)({},e),{},{valueAbs:t})}));return{id:n,valueAbs:r.reduce((function(e,t){return e+t.valueAbs}),0),flows:r}}))).reduce((function(e,t){return e+t.valueAbs}),0);return o=o.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{valuePart:e.valueAbs/c,flows:e.flows.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{valuePart:e.valueAbs/c})})).sort((function(e,a){var n=t>=2&&t<=4?-1:1;return e.valuePart<a.valuePart?n:-n}))})})),Object(s.a)(Object(s.a)({},e),{},{totalValue:c,nodes:o.sort((function(e,a){var n=t>=2&&t<=4?-1:1;return e.valuePart<a.valuePart?n:-n}))})}));return(i=i.map((function(e,t){var a=0,n=0,r=e.nodes.map((function(e){var t=a,r=n,i=Object(s.a)(Object(s.a)({},e),{},{displaceAbs:a,displacePart:n,flows:e.flows.map((function(e){var i=Object(s.a)(Object(s.a)({},e),{},{displaceAbs:t,displacePart:r,relativeDisplaceAbs:t-a,relativeDisplacePart:r-n});return t+=e.valueAbs,r+=e.valuePart,i}))});return a+=e.valueAbs,n+=e.valuePart,i}));return Object(s.a)(Object(s.a)({},e),{},{nodes:r})}))).map((function(e,t){if(t<i.length-1){var a=i[t+1],n=a.field,r=e.nodes.map((function(e,t){var r=e.flows.map((function(e,t){var r=e[n],i=a.nodes.find((function(e){return e.id===r}));if(i){var o=i.flows.find((function(t){return e._id===t._id}));if(o){var c={displaceAbs:o.displaceAbs,displacePart:o.displacePart,relativeDisplaceAbs:o.relativeDisplaceAbs,relativeDisplacePart:o.relativeDisplacePart};return Object(s.a)(Object(s.a)({},e),{},{nextPosition:c})}}return e}));return Object(s.a)(Object(s.a)({},e),{},{flows:r})}));return Object(s.a)(Object(s.a)({},e),{},{nodes:r})}return e}))}(a,{sumBy:r,steps:i})}),[a,r,i]),I=Object(n.useMemo)((function(){return j&&j.length?a.filter((function(e){return j.find((function(t){var a=t.key,n=t.value;return e[a]===n}))})).reduce((function(e,t){return e+ +t[r]}),0):a.reduce((function(e,t){return e+ +t[r]}),0)}),[a,r,j]);Object(n.useEffect)((function(){x.a.rebuild()})),Object(n.useEffect)((function(){S(void 0),E(void 0)}),[j]);var Y=Object(n.useMemo)((function(){var e=B.reduce((function(e,t){var a=Object($.a)(t.nodes.map((function(e){return e.id})));return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t.field,e[t.field]?Object($.a)([].concat(Object(c.a)(e[t.field]),Object(c.a)(a))):a))}),{});return Object.entries(e).reduce((function(e,t,a){var n=Object(l.a)(t,2),r=n[0],i=n[1],c=0;return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},r,i.reduce((function(e,t){return c++,Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t,te[a][c-1]))}),{})))}),{})}),[B]),X=Object(n.useMemo)((function(){return Object(K.a)([d,k])}),[d,k]),H=.3*X,W=X/50,G=.2*X,V=Object(z.a)().range([X/120,X/70]).domain([0,1]),U=Object(ee.b)(-X/2+H,-G/2).distance,J=Object(ee.b)(-X/2,-G/2+W).distance,Z=Math.abs(X/2-J),ae=X/2-U,ne={0:{orientation:"horizontal",direction:"top",displaceX:Z,displaceY:X/2-G/2,displaceText:.2*G+5},1:{orientation:"vertical",displaceX:X/2,displaceY:0},2:{orientation:"horizontal",displaceX:X-H-Z,displaceY:X/2-G/2,displaceText:.2*G+5,direction:"top"},3:{orientation:"horizontal",displaceX:X-H-Z,displaceY:X/2+G/2,displaceText:-5,direction:"bottom"},4:{orientation:"vertical",displaceX:X/2,displaceY:X-H},5:{orientation:"horizontal",displaceY:X/2+G/2,displaceX:Z,displaceText:-5,direction:"bottom"}},re=D?B.find((function(e){return e.field===D.key})).nodes.find((function(e){return e.id===D.value})):void 0,ie=re?re.flows.reduce((function(e,t){return e+ +t[r]}),0):0;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("h5",{ref:L,className:"visualization-title",children:g}),Object(T.jsx)("svg",{"data-for":"alluvial-tooltip","data-tip":undefined,width:d,height:k,className:O()("CircularAlluvialComponent",{"has-filters":j.length,"has-highlight":P||D}),children:Object(T.jsxs)("g",{transform:"translate(".concat(.05*d,", ").concat(.05*k,")scale(.9)"),children:[Object(T.jsxs)("g",{className:"background-marks",transform:"translate(".concat(d/2-X/2,", 0)"),children:[Object(T.jsx)("line",{x1:0,x2:X,y1:X/2,y2:X/2}),h?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("circle",{cx:X/2,cy:X/2,r:.5*X}),Object(T.jsx)("circle",{cx:X/2,cy:X/2,r:J}),Object(T.jsx)("circle",{cx:X/2,cy:X/2,r:U})]}):null,Object(T.jsx)("text",{x:X/2,y:X/2-.8*G+W,style:{fontWeight:D&&D.index<=2||P&&P.stepIndex<=2?800:void 0},children:"EXPORTS"}),Object(T.jsx)("text",{x:X/2,y:X/2+.8*G+W,style:{fontWeight:D&&D.index>2||P&&P.stepIndex>2?800:void 0},children:"IMPORTS"})]}),Object(T.jsx)("g",{transform:"translate(".concat(d/2-X/2,", 0)"),children:B.map((function(e,t){var a=ne[t],n=a.orientation,i=a.direction,o=a.displaceX,c=a.displaceY,u=a.displaceText,d=c,p=Object(z.a)().domain([0,1]).range([0,"vertical"===n?ae:H-Z]),m=0;return Object(T.jsxs)("g",{className:O()("step-container","is-oriented-"+n),children:[Object(T.jsx)("rect",{x:o,y:d,width:"vertical"===n?W:H,height:"vertical"===n?H:W,fill:"white",className:"step-bar-background"}),e.nodes.map((function(a,c){return Object(T.jsx)("g",{className:O()("links-group"),children:a.flows.filter((function(e){return e.nextPosition})).map((function(c,l){var u=ne[t+1],m=Object(z.a)().domain([0,1]).range([0,"vertical"===u.orientation?ae:H-W/3]),f=o+W,b=d+p(c.displacePart),g=u.displaceX,x=u.displaceY+m(c.nextPosition.displacePart),y=u.displaceX,_=u.displaceY+m(c.nextPosition.displacePart)+m(c.valuePart),w=d+p(c.displacePart)+p(c.valuePart),N=o+W;"horizontal"===n&&(f=o+p(c.displacePart),b=d+("bottom"===i?W:0),w=d+("bottom"===i?W:0),N=o+p(c.displacePart)+p(c.valuePart)),"horizontal"===u.orientation&&(g=u.displaceX+m(c.nextPosition.displacePart)+m(c.valuePart),x=u.displaceY+("bottom"===u.direction?W:0),y=u.displaceX+m(c.nextPosition.displacePart),_=u.displaceY+("bottom"===u.direction?W:0)),3===t&&(g+=W,y+=W,x+=W,_+=W),4===t&&(f-=W,N-=W,b+=W,w+=W);var L=f,k=x,q=f,R=x,A=N,F=_,B=N,I=_;1!==t&&4!==t||(L=g,k=b,q=g,R=b,A=y,F=w,B=y,I=w),0===t?(k=b-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(x-b),q=g-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(g-f),I=w-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(w-_),A=y-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(y-N)):1===t?(L=f+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(g-f),R=x-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(x-b),F=_-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(_-w),B=N+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(N-y)):3===t?(k=b+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(x-b),q=g+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(g-f),A=y+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(N-y),I=w+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(_-w)):4===t&&(L=f-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(g-f),R=x+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(x-b),B=N-4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(N-y),F=_+4/3*(1-Math.cos(45)/Math.sin(45))*Math.abs(_-w));var X=c.flow_type,G=c.customs_office,V=c.product,U=c.partner,J=c[r],Z=M.flow[C]({flow_type:X,customs_office:G,product:V,sumBy:r,value:J,partner:U});return Object(T.jsxs)("g",{onClick:function(){P&&P._id===c._id?(E(void 0),S(void 0)):(D&&E(void 0),S(Object(s.a)(Object(s.a)({},c),{},{stepIndex:t})))},className:O()("flow-link",{"is-filtered-in":j&&j.find((function(e){var t=e.key,a=e.value;return c[t]===a})),"is-highlighted":P&&P._id===c._id||D&&c[D.key]===D.value}),"data-for":"alluvial-tooltip","data-tip":Z,children:[Object(T.jsx)("path",{d:"\n                                    M ".concat(f," ").concat(b," \n                                    C ").concat(L,",").concat(k," ").concat(q,",").concat(R," ").concat(g," ").concat(x," \n                                    L ").concat(y," ").concat(_,"\n                                    C ").concat(A,",").concat(F," ").concat(B,",").concat(I," ").concat(N," ").concat(w," \n                                    Z\n                                    ").trim().replace(/\n/g," "),style:{fill:v?v[e.field][a.id]:Y[e.field][a.id]}}),h?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("line",{stroke:"red",x1:f,y1:b,x2:L,y2:k}),Object(T.jsx)("circle",{cx:L,cy:k,r:2,fill:"red"}),Object(T.jsx)("line",{stroke:"blue",x1:g,y1:x,x2:q,y2:R}),Object(T.jsx)("circle",{cx:q,cy:R,r:2,fill:"blue"}),Object(T.jsx)("line",{stroke:"green",x1:y,y1:_,x2:A,y2:F}),Object(T.jsx)("circle",{cx:A,cy:F,r:2,fill:"green"}),Object(T.jsx)("line",{stroke:"lightblue",x1:N,y1:w,x2:B,y2:I}),Object(T.jsx)("circle",{cx:B,cy:I,r:2,fill:"lightblue"})]}):null]},l)}))},c)})),e.nodes.map((function(a,i){var s=p(a.valuePart),c=p(a.displacePart),f=s-2,b=d+c,h=o,g=W,x=f;"horizontal"===n&&(g=f,x=W,h=o+c,b=d),4===t&&(b+=W);var y=D&&a.id===D.value&&t===D.index,w=0;D?w=a.flows.filter((function(e){return e[D.key]===D.value})).reduce((function(e,t){return e+ +t[r]}),0)/ie:j&&j.length&&(w=a.flows.filter((function(e){return j.find((function(t){var a=t.key,n=t.value;return e[a]===n}))})).reduce((function(e,t){return e+ +t[r]}),0)/I),w>1&&(w=1);var L=j&&j.find((function(e){var t=e.key,n=e.value;return a.flows.find((function(e){return e[t]===n}))})),k=0;0===t||2===t?k=30:3!==t&&5!==t||(k=-30);var q="vertical"===n?h+2*W:h+(_?g/2:0),R=q;if("horizontal"===n){N&&m&&R<m+20&&(R=m+20),m=R}var z="vertical"===n?b+x/2:b+u,A=Object(ee.d)(a.id,20),F=Object(l.a)(A,2),B=F[0],X=F[1],H=P&&a.flows.find((function(e){return e._id===P._id}))||D&&e.id===D.key&&a.id===D.value,G=D&&e.field===D.key&&a.id===D.value,U=V(D||re?w>0?w:a.valuePart:1),J=M.node[C](a,t);return Object(T.jsxs)("g",{className:O()("step-node-container",{"has-highlights":H,"is-filtered-in":L,"is-highlighted":G}),onClick:function(){D&&D.value===a.id?(S(void 0),E(void 0)):(P&&S(void 0),E({key:e.field,value:a.id,index:t}))},"data-for":"alluvial-tooltip","data-tip":J,children:[Object(T.jsx)("rect",{x:h,y:b,width:g,height:x,className:"node-level-node"}),Object(T.jsx)("g",{transform:"\n                            translate(".concat(R,", ").concat(z,")\n                            rotate(").concat(k,")\n                          "),className:O()("node-level-label",{"is-filtered-in":L,"is-highlighted":y,"is-secondary-highlighted":!y&&w>0}),children:Object(T.jsx)("text",{style:{fontSize:U},children:L||y?B+" "+(X||""):"".concat(X?B+"...":B)})}),N&&q!==R?Object(T.jsx)("line",{x1:h+s/2,y1:0===t||2===t?b+W:b,x2:R,y2:z,className:O()("label-line",{"is-filtered-in":L,"is-highlighted":y,"is-secondary-highlighted":!y&&w>0})}):null,a.flows.map((function(r,i){var s=h,c=d+p(r.displacePart);4===t&&(c+=W);var l=W,u=p(r.valuePart);return"horizontal"===n&&(l=p(r.valuePart),u=W,s=o+p(r.displacePart),c=d),Object(T.jsx)("rect",{x:s,y:c,width:l,height:u,className:O()("flow-level-node",{"is-filtered-in":j&&j.find((function(e){var t=e.key,a=e.value;return r[t]===a})),"is-highlighted":P&&P._id===r._id||D&&r[D.key]===D.value}),style:{fill:v?v[e.field][a.id]:Y[e.field][a.id]},title:a.id},i)}))]},a.id)}))]},t)}))})]})}),Object(T.jsx)(x.a,{id:"alluvial-tooltip"})]})},ne=(a(520),["width","height","datasets","showOnlyToflit","atlasMode","highlight","lang","filter"]),re=["id"],ie=["id"],oe=function(e){var t=e.width,a=e.height,r=e.datasets,i=(e.showOnlyToflit,e.atlasMode),o=e.highlight,s=void 0===o?"toflit18":o,c=e.lang,l=void 0===c?"fr":c,u=e.filter,d=void 0===u?"aucun":u,p=(Object(q.a)(e,ne),i?1200:a),m=Object(n.useMemo)((function(){var e="value",t=[];switch(d){case"colonial":t=[{key:"product",value:"produits coloniaux"},{key:"partner",value:"Afrique"},{key:"partner",value:"Colonies"}];break;case"eau-de-vie":t=[{key:"product",value:"eau-de-vie et vins divers"}];break;case"sel":t=[{key:"product",value:"sel"}],e="product_weight_kg"}return{sumToflitBy:e,alluvialFilters:t}}),[d]),f=m.sumToflitBy,j=m.alluvialFilters,b={fr:"\xc9changes de la direction des fermes de La Rochelle en 1789 par produit et partenaire, dimensionn\xe9s selon leur ".concat("value"===f?"valeur commerciale":"poids de marchandises"),en:"\xc9changes de la direction des fermes de La Rochelle en 1789 par produit et partenaire, dimensionn\xe9s selon leur ".concat("value"===f?"valeur commerciale":"poids de marchandises")};return Object(T.jsxs)("div",{className:"PrincipalVisualizationPart2",children:[Object(T.jsx)("div",{className:"circular-alluvial-container",style:{width:"toflit18"===s?.7*t:.3*t,height:"toflit18"===s?p:.3*p},children:Object(T.jsx)(ae,{data:r["part_2_toflit_viz_data.csv"],width:"toflit18"===s?.8*t:.3*t,height:"toflit18"===s?p:.3*p,sumBy:f,filters:j,colorsPalettes:B.a,lang:l,title:b[l],tooltips:{node:{fr:function(e,t){var a=e.id,n=Object(q.a)(e,re);return 0===t||5===t?"En 1789, le bureau des fermes de ".concat(a," a ").concat(t<3?"export\xe9":"import\xe9"," ").concat(n.valueAbs," ").concat("value"===f?"livres tournoi":"kg","."):1===t||4===t?"En 1789, la direction des fermes de La Rochelle a ".concat(t<3?"export\xe9":"import\xe9"," ").concat(n.valueAbs," ").concat("value"===f?"livres tournoi":"kg"," de ").concat(a,"."):"En 1789, la direction des fermes de La Rochelle a ".concat(t<3?"export\xe9":"import\xe9"," ").concat(n.valueAbs," ").concat("value"===f?"livres tournoi":"kg"," vers le partenaire ").concat(a,".")},en:function(){return function(e,t){var a=e.id,n=Object(q.a)(e,ie);return 0===t||5===t?"In 1789, the bureau des fermes of ".concat(a," has ").concat(t<3?"imported":"exported"," ").concat(n[f]," ").concat("value"===f?"livres tournoi":"kg","."):1===t||4===t?"In 1789, the direction des fermes de La Rochelle has ".concat(t<3?"imported":"exported"," ").concat(n.valueAbs," ").concat("value"===f?"livres tournoi":"kg"," of ").concat(a,"."):"In 1789, the direction des fermes de La Rochelle has ".concat(t<3?"imported":"exported"," ").concat(n.valueAbs," ").concat("value"===f?"livres tournoi":"kg"," to the partner ").concat(a,".")}}},flow:{fr:function(e){var t=e.flow_type,a=e.customs_office,n=e.product,r=e.sumBy,i=e.value,o=e.partner;return"En 1789, le bureau des fermes de ".concat(a," a ").concat("import"===t?"import\xe9":"export\xe9"," ").concat(i," ").concat("value"===r?"livres tournois":"kg"," de ").concat(n," ").concat("import"===t?"depuis":"vers"," le partenaire ").concat(o)},en:function(e){var t=e.flow_type,a=e.customs_office,n=e.product,r=e.sumBy,i=e.value,o=e.partner;return"In 1789, the bureau des fermes of ".concat(a," has ").concat("import"===t?"imported":"exported"," ").concat(i," ").concat("value"===r?"livres tournois":"kg"," of ").concat(n," ").concat("import"===t?"from":"to"," the partner ").concat(o)}}},steps:[{field:"customs_office",labels:{fr:"bureau des fermes",en:"customs office"},filters:[{key:"flow_type",value:"export"}]},{field:"product",labels:{fr:"type de produit",en:"product type"},filters:[{key:"flow_type",value:"export"}]},{field:"partner",labels:{fr:"partenaire du commerce ext\xe9rieur",en:"external trade partner"},filters:[{key:"flow_type",value:"export"}]},{field:"partner",labels:{fr:"partenaire du commerce ext\xe9rieur",en:"external trade partner"},filters:[{key:"flow_type",value:"import"}]},{field:"product",labels:{fr:"type de produit",en:"product type"},filters:[{key:"flow_type",value:"import"}]},{field:"customs_office",labels:{fr:"bureau des fermes",en:"customs office"},filters:[{key:"flow_type",value:"import"}]}]})}),Object(T.jsx)("div",{className:"radar-container",style:{width:"navigo"===s?.7*t:.3*t},children:Object(T.jsx)("img",{alt:"radar-maquette",src:"".concat("/portic-storymaps-2021","/maquettes/part2-radar.jpg")})})]})},se=a(54),ce=a(104),le=(a(523),a(105)),ue=a(80),de=function(e){var t=e.width,a=e.height,n=e.datasets;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("div",{className:"graphs-container",style:{position:"relative",height:.6*a},children:[Object(T.jsx)("div",{className:"graph-container",style:{width:.6*t,height:.6*a,position:"absolute"},children:Object(T.jsx)(le.a,{data:n["flows_1787_around_La Rochelle.gexf"],nodeSize:"degree",labelDensity:1,nodeColor:{field:"internal",palette:{"interne \xe0 la r\xe9gion":B.a.generic.dark,"externe \xe0 la r\xe9gion":B.a.generic.accent2}},spatialize:!0,ratio:1.1,title:"R\xe9seau des voyages partant ou arrivant dans la r\xe9gion PASA en 1787 ..."})}),Object(T.jsx)("div",{className:"graph-container",style:{width:.4*t,height:.3*a,position:"absolute",right:0,top:0},children:Object(T.jsx)(le.a,{data:n["flows_1787_around_Bordeaux.gexf"],nodeSize:"degree",labelDensity:1,nodeColor:{field:"internal",palette:{"interne \xe0 la r\xe9gion":B.a.generic.dark,"externe \xe0 la r\xe9gion":B.a.generic.accent2}},spatialize:!0,title:"...compar\xe9 \xe0 celui de l'amiraut\xe9 de Bordeaux",ratio:1})}),Object(T.jsx)("div",{className:"graph-container",style:{width:.4*t,height:.3*a,position:"absolute",right:0,bottom:0},children:Object(T.jsx)(le.a,{data:n["flows_1787_around_Nantes.gexf"],nodeSize:"degree",labelDensity:1,nodeColor:{field:"internal",palette:{"interne \xe0 la r\xe9gion":B.a.generic.dark,"externe \xe0 la r\xe9gion":B.a.generic.accent2}},title:"...compar\xe9 \xe0 celui de l'amiraut\xe9 de Nantes",ratio:1,spatialize:!0})})]}),Object(T.jsxs)("div",{style:{position:"absolute",bottom:0,left:0,width:.3*t,height:.3*a,paddingLeft:0},className:"ColorLegend",children:[Object(T.jsx)("h5",{children:"L\xe9gende des r\xe9seaux"}),Object(T.jsxs)("ul",{className:"color-legend",children:[Object(T.jsx)("li",{children:"Taille des points repr\xe9sentant les ports : nombre de liens avec d'autres ports dans le r\xe9seau"}),Object(T.jsxs)("li",{children:[Object(T.jsx)("span",{style:{background:B.a.generic.dark},className:"color-box"}),Object(T.jsx)("span",{className:"color-label",children:"Port interne \xe0 la r\xe9gion"})]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("span",{style:{background:B.a.generic.accent2},className:"color-box"}),Object(T.jsx)("span",{className:"color-label",children:"Port externe \xe0 la r\xe9gion"})]})]})]}),Object(T.jsx)("div",{style:{position:"absolute",bottom:0,right:0,width:.7*t,height:.3*a},children:Object(T.jsx)(ue.a,{data:n["part_3_centralite_comparaison.csv"],title:"Centralit\xe9 compar\xe9e de La Rochelle par rapport \xe0 PASA et, pour ses r\xe9gions c\xf4ti\xe8res voisines, du port principal par rapport au r\xe9seau des voyages de son amiraut\xe9 (1787)",width:.7*t,height:.3*a,orientation:"vertical",layout:"groups",y:{field:"port",title:"Port (dans son r\xe9seau local)"},x:{field:"score",title:"Score"},color:{field:"metrics_type",title:"Type de m\xe9trique",palette:{PageRank:B.a.generic.dark,"betweenness centrality":B.a.generic.accent1}},margins:{bottom:20},tooltip:function(e){return"PageRank"===e.metrics_type?"Le PageRank est une mesure de centralit\xe9 qui consiste \xe0 donner \xe0 chaque port un score proportionnel \xe0 la somme des pageranks des ports avec lesquels il a des voyages en commun.":"La centralit\xe9 interm\xe9diaire est une mesure de centralit\xe9 \xe9gale au nombre de fois o\xf9 un port donn\xe9 est sur le chemin le plus court entre deux autres ports du r\xe9seau des voyages."}})})]})},pe=function(e){var t=e.datasets,a=e.step,r=e.width,i=e.height,o=e.atlasMode,c=o?window.innerHeight:i,u=Object(n.useState)("France"),d=Object(l.a)(u,2),p=d[0],m=d[1];return Object(n.useEffect)((function(){setTimeout((function(){switch(a){case 1:m("rotated Poitou");break;case 3:m("Poitou zoomed")}}),100)}),[a]),Object(T.jsxs)("div",{className:O()("PrincipalVisualizationPart3",{"is-atlas-mode":o}),style:{height:o?void 0:c},children:[Object(T.jsx)("div",{className:O()("step",{"is-visible":1===a}),children:Object(T.jsx)(se.a,{title:"Navigation au d\xe9part des ports de la r\xe9gion PASA en 1789",layers:[{type:"choropleth",data:t["cartoweb_france_1789_geojson.geojson"]},{type:"custom",data:t["part_3_step1_viz_data.csv"],renderObjects:function(){return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("rect",{x:0,y:0,width:r,height:c/8,fill:"url(#radial-bg)"}),Object(T.jsx)("defs",{children:Object(T.jsxs)("linearGradient",{id:"radial-bg",gradientTransform:"rotate(90)",children:[Object(T.jsx)("stop",{offset:"10%",stopColor:o?"white":B.a.ui.colorBackgroundBlue}),Object(T.jsx)("stop",{offset:"100%",stopColor:o?"white":B.a.ui.colorBackgroundBlue,"stop-opacity":0})]})})]})}},{type:"custom",data:t["part_3_step1_viz_data.csv"],renderObjects:function(e){return Object(ce.c)(Object(s.a)(Object(s.a)({},e),{},{atlasMode:o}))}}],projectionTemplate:o?"rotated Poitou":p,height:o?.9*window.innerHeight:c,width:r})}),Object(T.jsx)("div",{className:O()("step",{"is-visible":2===a}),style:{height:c},children:Object(T.jsx)(de,{width:r,height:c,datasets:t})}),Object(T.jsx)("div",{className:O()("step",{"is-visible":3===a}),height:c,children:Object(T.jsx)(se.a,{layers:[{type:"choropleth",data:t["cartoweb_france_1789_geojson.geojson"],color:{field:"shortname"}},{type:"custom",data:{customsOffices:t["part_3_step3_viz_customs_offices_data.csv"].filter((function(e){return"La Rochelle"===e.customs_region&&"undefined customs office"!==e.name&&!e.name.includes("Bouin")})),ports:t["part_3_step3_viz_ports_data.csv"]},renderObjects:ce.b},{type:"custom",data:t["part_3_step3_viz_customs_offices_data.csv"],renderObjects:ce.a}],projectionTemplate:o?"Poitou zoomed":p,height:c,width:r,title:"Extraversion du commerce et de la navigation regroup\xe9s par bureau de fermes en 1789"})})]})},me=a(66),fe=a(68),je=a(20),be=(a(574),function(e){var t=e.projection,a=e.height,r=e.datum,i=e.width,o=e.index,s=e.radius,c=t([+r.longitude,+r.latitude]),u=Object(l.a)(c,2),d=u[0],p=u[1],m=["La Rochelle","Tonnay-Charente"].includes(r.name),f=r.name.length*i*a*5e-4,j=Object(n.useState)(!1),b=Object(l.a)(j,2),h=b[0],g=b[1];Object(n.useEffect)((function(){setTimeout((function(){g(!0)}))}),[]);var v=Object(je.useSpring)({to:{transform:"translate(".concat(d,", ").concat(p,")")},immediate:!h}).transform;return Object(T.jsxs)(je.animated.g,{transform:v,children:[Object(T.jsx)(je.animated.circle,{r:2*s,cx:0,cy:0,fill:"url(#bureau-".concat(o,")")}),Object(T.jsx)("circle",{r:2,cx:0,cy:0,fill:"white"}),Object(T.jsx)("foreignObject",{x:m?s:-s-f,y:0,fill:"white",width:f,height:a/20,className:O()("bureau-label",{"is-reversed":!m}),children:Object(T.jsx)("span",{xmlns:"http://www.w3.org/1999/xhtml",children:r.name})}),Object(T.jsxs)("radialGradient",{id:"bureau-".concat(o),children:[Object(T.jsx)("stop",{offset:"20%",stopColor:B.a.customs_office[r.name]}),Object(T.jsx)("stop",{offset:"100%",stopColor:"rgba(51,109,124,0)"})]})]})}),he=function(e){var t=e.datasets,a=e.atlasMode,n=e.dimensions;return Object(T.jsx)(se.a,{title:"Carte des bureaux des fermes de la r\xe9gion PASA",layers:[{type:"choropleth",data:t["cartoweb_france_1789_geojson.geojson"],reverseColors:!a},{type:"custom",data:t["part_3_step3_viz_customs_offices_data.csv"],renderObjects:function(e){return function(e){var t=e.data,a=e.projection,n=e.width,r=e.height,i=e.atlasMode,o=n*r*6e-5;return Object(T.jsx)("g",{className:O()("IntroBureaux",{"is-atlas-mode":i}),children:t.filter((function(e){return!isNaN(+e.latitude)&&B.a.customs_office[e.name]})).map((function(e,t){return Object(T.jsx)(be,{projection:a,height:r,datum:e,width:n,index:t,radius:o},t)}))})}(Object(s.a)(Object(s.a)({},e),{},{atlasMode:a}))}}],projectionTemplate:"Poitou",width:n.width,height:a?.9*window.innerHeight:n.height})},ge=function(e){var t=e.datasets,a=e.atlasMode,r=e.dimensions,i=Object(n.useState)("World"),o=Object(l.a)(i,2),s=o[0],c=o[1];return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(se.a,{title:"Voyages des bateaux rattach\xe9s au port de La Rochelle en 1787",layers:[{type:"choropleth",data:"World"===s?t["cartoweb_world_1789_23mars2021_mixte_20-wgs84_simplified.geojson"]:t["cartoweb_france_1789_geojson.geojson"],reverseColors:!a||void 0},{type:"flows",data:t["voyages-bateaux-homeport-larochelle-1787.csv"],size:{field:"tonnages_cumul\xe9s",title:"Fl\xe8ches dimensionn\xe9es par tonnage cumul\xe9"},label:{fields:["port_dep","port_dest"]},color:{field:"category",title:"Port de d\xe9part"}}],projectionTemplate:s,width:r.width,height:a?.9*window.innerHeight:r.height,withLegend:"bottom left"}),Object(T.jsx)("div",{style:{position:"absolute",right:"1rem",bottom:"1rem"},children:Object(T.jsx)("button",{onClick:function(){return c("World"===s?"France":"World")},children:"Monde/France"})})]})},ve=["id","dimensions"],Oe=function(e){var t=e.id,a=e.dimensions,r=Object(q.a)(e,ve),i=Object(s.a)({},a),c=Object(n.useContext)(me.a),u=Object(n.useMemo)((function(){var e=fe.find((function(e){return e.id===t}));if(e){var a=e.datasets&&e.datasets.split(",").map((function(e){return e.trim()}));if(a.length&&c)return a.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t,c[t]))}),{})}}),[t,c]);if(!(Object.keys(u||{}).length&&!Object.entries(u).find((function(e){var t=Object(l.a)(e,2);t[0];return!t[1]}))))return null;switch(t){case"viz-principale-partie-1":return Object(T.jsx)(G,Object(s.a)(Object(s.a)({},r),{},{datasets:u||{}},i));case"viz-principale-partie-2":return Object(T.jsx)(oe,Object(s.a)(Object(s.a)({},r),{},{datasets:u||{}},i));case"viz-principale-partie-3":return Object(T.jsx)(pe,Object(s.a)(Object(s.a)({},r),{},{datasets:u||{}},i));case"partie-1-produits-importants-pour-la-rochelle":return Object(T.jsx)(ue.a,{data:u[Object.keys(u)[0]].sort((function(e,t){return+e.order>+t.order?1:-1})).slice(0,20),title:"Produits dont les valeurs d'exports sont les plus importantes en 1789 : comparaison de La Rochelle \xe0 la moyenne fran\xe7aise",width:i.width,height:r.atlasMode?window.innerHeight/2:i.height,orientation:"vertical",layout:"groups",y:{field:"product",title:"produit"},x:{field:"value_rel_per_direction",title:"Valeur en pourcentage",tickSpan:.1,tickFormat:function(e,t){return parseInt(100*e)+"%"}},color:{field:"entity",title:"Part des exports pour :"},margins:{left:140},tooltip:function(e){return"Le produit ".concat(e.product," repr\xe9sente ").concat((100*e.value_rel_per_direction).toFixed(2),"% des exports pour ").concat(e.entity.includes("France")?"la France":"la direction des fermes de La Rochelle")}});case"partie-1-evolution-de-la-part-des-echanges-de-la-rochelle-au-xviiie":return Object(T.jsx)(ue.a,{data:u[Object.keys(u)[0]],title:"\xc9volution globale de la part des \xe9changes de La Rochelle par rapport \xe0 l'ensemble de la France",width:i.width,height:r.atlasMode?window.innerHeight/2:.5*i.height,orientation:"horizontal",layout:"stack",y:{field:"portion",title:"part du commerce fr.",tickFormat:function(e){return parseInt(100*e)+"%"}},x:{field:"year",title:"ann\xe9e",fillGaps:!0,tickSpan:5},color:{field:"type",title:"Type"},margins:{left:140,right:0},tooltip:function(e){return"En ".concat(e.year,", la direction des fermes de la Rochelle a ").concat("import"===e.type?"import\xe9":"export\xe9"," ").concat((100*+e.portion).toFixed(2),"% des ").concat("import"===e.type?"imports":"exports"," fran\xe7ais totaux")}});case"partie-1-pays-port-d-attache":return Object(T.jsx)(ue.a,{data:u[Object.keys(u)[0]],title:"Pays d'attache des navires \xe9trangers partant de la r\xe9gion en 1789",width:i.width,height:r.atlasMode?.8*window.innerHeight:i.height,orientation:"vertical",y:{field:"country",title:"Pays du port d'attache",sort:{field:"nb_outs",autoSort:!0,ascending:!1,type:"number"}},x:{field:"nb_outs",title:"Nombre de d\xe9parts",tickFormat:function(e,t){return"".concat(e," d\xe9parts")}},margins:{right:60},tooltip:function(e){return"En 1789, ".concat(e.nb_outs," bateaux sont partis de la r\xe9gion de La Rochelle (amiraut\xe9s de La Rochelle, Sables d'Olonnes ou Marennes)")}});case"partie-3-comparaison-exports-coloniaux":return Object(T.jsx)(ue.a,{data:u[Object.keys(u)[0]],title:"Comparaison des exports de produits coloniaux, locaux et autres par bureaux des fermes (1789)",width:i.width,height:r.atlasMode?.8*window.innerHeight:.5*i.height,orientation:"vertical",layout:"grouped",y:{field:"customs_office",title:"Bureau des fermes"},x:{field:"value",title:"valeur en livres tournoi",tickSpan:1e6,domain:[0,6e6]},color:{field:"type",title:"Type de produit"},margins:{left:140,right:50},tooltip:function(e){return"En 1789, le bureau des fermes de ".concat(e.customs_office," a export\xe9 \xe0 l'\xe9trange ").concat(e.value," livres tournois de produits de type ").concat(e.type)}});case"intro-provinces":return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(se.a,{title:"Carte des provinces \xe9tudi\xe9es : Poitou, Aunis, Saintonge, Angoumois (PASA)",layers:[{type:"choropleth",data:c["cartoweb_france_1789_geojson.geojson"],reverseColors:!r.atlasMode||void 0,color:{field:"shortname",palette:B.a.provinces},tooltip:function(e){return e.properties.shortname}}],projectionTemplate:"France",width:i.width,height:r.atlasMode?.9*window.innerHeight:i.height})});case"intro-ports":return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(se.a,{title:"Carte des ports de la r\xe9gion PASA",layers:[{type:"choropleth",data:c["cartoweb_france_1789_geojson.geojson"],reverseColors:!r.atlasMode||void 0},{type:"points",data:c["ports_locations_data_intro.csv"],color:{field:"province",title:"Province du port",palette:B.a.provinces,labelsColor:r.atlasMode?void 0:"white"},size:{field:"nb_pointcalls",title:"nombre de voyages enregistr\xe9s en 1789"},tooltip:function(e){return"".concat(e.rawSize," mouvements de bateaux ont \xe9t\xe9 enregistr\xe9s par le port de ").concat(e.label," en 1789")},label:{field:"port",position:"left"},stackLabels:!0}],projectionTemplate:"Poitou",width:i.width,height:r.atlasMode?.9*window.innerHeight:i.height,withLegend:"top right"})});case"intro-bureaux":return Object(T.jsx)(he,{datasets:c,atlasMode:r.atlasMode,dimensions:i});case"partie-2-part-navigation-francaise":return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(se.a,{title:"Part de la navigation fran\xe7aise dans la r\xe9gion",layers:[{type:"choropleth",data:c["cartoweb_france_1789_geojson.geojson"],reverseColors:!r.atlasMode||void 0},{type:"points",data:c["part_navigation_fr.csv"],color:{field:"tonnage_part_of_french",title:"Part de la navigation fran\xe7aise (par tonnage cumul\xe9)",palette:B.a.tonnageClasses,labelsColor:r.atlasMode?void 0:"white"},size:{field:"tonnage",title:"Tonnage sorti des ports (en miliers)",displayMetric:!0},label:{field:"port",position:"left"},stackLabels:!0}],projectionTemplate:"Poitou",width:i.width,height:r.atlasMode?.9*window.innerHeight:i.height,withLegend:"top right"})});case"partie-2-carte-direction-bateaux-de-la-rochelle":return Object(T.jsx)(ge,{datasets:c,atlasMode:r.atlasMode,dimensions:i});case"test":default:return Object(T.jsx)(R,Object(s.a)(Object(s.a)({},r),{},{datasets:u||{}}))}},xe=function(e){var t=e.lang,a=e.activeVisualization,r=e.atlasMode,i=Object(n.useState)({}),o=Object(l.a)(i,2),c=o[0],u=o[1],d=a&&L()(a,["id","ref","visualizationId"]);return Object(T.jsx)(k.a,{bounds:!0,onResize:function(e){u(e.bounds)},children:function(e){var n=e.measureRef;return Object(T.jsx)("div",{ref:n,className:O()("VisualizationController",{"is-empty":!a}),children:a?Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(Oe,Object(s.a)(Object(s.a)({lang:t,atlasMode:r,id:r?a.id:a.visualizationId},d),{},{dimensions:c}))}):null})}})},ye=xe,_e=function(e){var t=e.ContentSync,a=e.title,r=e.lang,i=Object(n.useRef)(null),c=Object(n.useState)(!1),u=Object(l.a)(c,2),d=u[0],p=u[1],m=Object(n.useState)(void 0),f=Object(l.a)(m,2),j=f[0],b=f[1],h=Object(n.useReducer)((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}),v=Object(l.a)(h,2),y=v[0],_=v[1],w=Object(M.useScrollYPosition)();Object(n.useEffect)((function(){!j&&d&&p(!1)}),[j]);Object(n.useEffect)((function(){window.scrollTo(0,0)}),[t]),Object(n.useEffect)((function(){var e,t=.6*window.innerHeight,a=w+t,n=Object.entries(y),r=i.current&&i.current.getBoundingClientRect();if(a>r.y+window.scrollY+r.height)j&&b(void 0);else{for(var o=n.length-1;o>=0;o--){var s=Object(l.a)(n[o],2),c=(s[0],s[1]),u=c.ref;if(u.current){var d=u.current.getBoundingClientRect().y+window.scrollY;if("centered-part-contents"===u.current.parentNode.className&&(d+=u.current.parentNode.parentNode.getBoundingClientRect().y),!c.visualizationId&&w+.8*window.innerHeight>d){e=!0,b(void 0);break}if(a>d){e=!0,c.visualizationId?b(c):b(void 0);break}}}0===w&&n.length?b(n[0][1]):!e&&j&&b(void 0)}}),[w,y]);return Object(T.jsxs)(me.b.Provider,{value:{activeVisualization:j,onBlockClick:function(e,t){var a=t.current.getBoundingClientRect().y+window.scrollY-.9*(.6*window.innerHeight);window.scrollTo({top:a,behavior:"smooth"})},onRegisterVisualization:function(e){var t=Object(s.a)({},e);_(Object(s.a)(Object(s.a)({},y),{},Object(o.a)({},e.id,t)))},onUnregisterVisualization:function(e){var t=Object.entries(y).reduce((function(t,a){var n=Object(l.a)(a,2),r=n[0],i=n[1];return r===e?t:Object(s.a)(Object(s.a)({},t),{},Object(o.a)({},r,i))}),{});_(t)}},children:[Object(T.jsx)(g.a,{children:Object(T.jsx)("title",{children:Object(ee.a)(a,r)})}),Object(T.jsxs)("div",{className:"ScrollyPage",children:[Object(T.jsx)("section",{ref:i,className:O()({"is-focused":!d}),children:Object(T.jsx)(t,{})}),Object(T.jsx)("aside",{className:O()({"is-focused":d}),children:Object(T.jsx)(ye,{activeVisualization:j})}),Object(T.jsx)("div",{className:O()("vis-focus-container",{"is-active":d,"is-visible":j}),children:Object(T.jsx)("button",{"data-for":"contents-tooltip","data-effect":"solid","data-tip":"fr"===r?"voir la visualisation associ\xe9e":"see associated visualization",onClick:function(){return p(!d)},children:Object(T.jsx)("span",{children:"\u02c3"})})}),Object(T.jsx)(x.a,{id:"contents-tooltip"})]})]})},we=a(213),Ne=a(214),Me=a(215),Ce=a(216),Le=a(217),ke=a(218),qe=a(219),Te=a(220),Re=a(221),Pe=a(222),Se=a(224),ze=a(223),Ae=[{routes:{fr:"partie-1",en:"part-1"},titles:{fr:"Le d\xe9clin de la r\xe9gion de La Rochelle suite \xe0 la perte du Canada",en:"The decline of La Rochelle region after Canada's loss"},shortTitles:{fr:"le d\xe9clin de la r\xe9gion de La Rochelle",en:"the decline of La Rochelle region"},contents:{fr:"fr/partie-1.mdx",en:"en/part-1.mdx"},contentsProcessed:{fr:we.default,en:Ne.default},Component:_e,routeGroup:"primary"},{routes:{fr:"partie-2",en:"part-2"},titles:{fr:"Une forte sp\xe9cialisation portuaire: le cas de la traite n\xe9gri\xe8re, du commerce du sel et de l'eau-de-vie",en:"A strong portual specialization"},shortTitles:{fr:"une forte sp\xe9cialisation portuaire",en:"a strong portual specialization"},contents:{fr:"fr/partie-2.mdx",en:"en/part-2.mdx"},contentsProcessed:{fr:Me.default,en:Ce.default},Component:_e,routeGroup:"primary"},{routes:{fr:"partie-3",en:"part-3"},titles:{fr:"La Rochelle, port dominant mais pas structurant",en:"La Rochelle port, dominating but not structuring"},shortTitles:{fr:"un port dominant mais pas structurant",en:"a dominating but not structuring port"},contents:{fr:"fr/partie-3.mdx",en:"en/part-3.mdx"},contentsProcessed:{fr:Le.default,en:ke.default},Component:_e,routeGroup:"primary"},{routes:{fr:"references",en:"references"},titles:{fr:"R\xe9f\xe9rences",en:"References"},shortTitles:{fr:"r\xe9f\xe9rences",en:"references"},contents:{fr:"fr/references.mdx",en:"en/references.mdx"},contentsProcessed:{fr:Re.default,en:Pe.default},routeGroup:"secondary"},{routes:{fr:"a-propos",en:"about"},titles:{fr:"\xc0 propos",en:"About"},shortTitles:{fr:"\xe0 propos",en:"about"},contents:{fr:"fr/a-propos.mdx",en:"en/about.mdx"},contentsProcessed:{fr:qe.default,en:Te.default},routeGroup:"secondary"},{routes:{fr:"tests",en:"tests"},titles:{fr:"Tests",en:"Tests"},shortTitles:{fr:"tests",en:"tests"},contents:{fr:"fr/tests.mdx",en:"fr/tests.mdx"},contentsProcessed:{fr:Se.default,en:ze.default},routeGroup:"secondary",hide:!0}],Fe=a(225),De=function(){var e=Object(n.useState)({}),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(T.jsx)(k.a,{bounds:!0,onResize:function(e){r(e.bounds)},children:function(e){var t=e.measureRef;return Object(T.jsx)("div",{ref:t,className:"boats-container",children:Object(T.jsx)(Fe.a,Object(s.a)({},Object(s.a)({},a)))})}})};var Ee=function(e){var t=e.lang,a=void 0===t?"fr":t,n=e.summary,r={intro:{fr:"d\xe9couvrir les 3 chapitres de l\u2019\xe9tude de cas",en:"discover the 3 chapters of the case study"},atlas:{fr:"Acc\xe9der \xe0 l'atlas de toutes les visualisations",en:"Access all visualizations' atlas"},chapter:{fr:"Chapitre",en:"Chapter"}};return Object(T.jsx)("div",{className:"HomeSummary",children:Object(T.jsxs)("div",{className:"contents",children:[Object(T.jsx)("div",{className:"intro",children:r.intro[a]}),Object(T.jsx)("ul",{className:"chapters-links-container",children:n.filter((function(e){return"primary"===e.routeGroup})).filter((function(e){return e.routes[a]})).map((function(e,t){var n=e.titles[a],i="/".concat(a,"/page/").concat(e.routes[a]);return Object(T.jsx)("li",{children:Object(T.jsxs)(d.c,{to:i,children:[Object(T.jsxs)("h4",{className:"pretitle",children:[r.chapter[a]," ",t+1]}),Object(T.jsx)("h3",{className:"title",children:n})]})},t)}))}),Object(T.jsx)("div",{className:"atlas-link-container",children:Object(T.jsx)(d.c,{to:"ReactSnap"===navigator.userAgent?"/fr/atlas":"/".concat(a,"/atlas"),children:Object(T.jsx)("h3",{className:"title",children:r.atlas[a]})})})]})})},Be={fr:y.a,en:_.a};var Ie=function(e){var t=e.match.params.lang,a=void 0===t?"fr":t,r=Object(n.useRef)(null),i=Object(n.useState)(!1),c=Object(l.a)(i,2),u=c[0],d=c[1],p=Object(n.useState)(!1),m=Object(l.a)(p,2),f=m[0],j=m[1],b=Be[a]||y.a,h=b.title,v=b.titleHTML,_=b.subtitle,C=Object(n.useState)(void 0),L=Object(l.a)(C,2),k=L[0],q=L[1],R=Object(n.useReducer)((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}),P=Object(l.a)(R,2),S=P[0],z=P[1],A=Object(M.useScrollYPosition)();return Object(n.useEffect)((function(){window.scrollTo(0,0)}),[]),Object(n.useEffect)((function(){for(var e,t,a=.5*window.innerHeight,n=Object.entries(S),r=1/0,i=n.length-1;i>=0;i--){var o=0===i?A+.2*window.innerHeight:A+a,s=Object(l.a)(n[i],2),c=(s[0],s[1]),u=c.ref;if(u.current){var d=u.current.getBoundingClientRect().y+window.scrollY;if("centered-part-contents"===u.current.parentNode.className&&(d+=u.current.parentNode.parentNode.getBoundingClientRect().y),d<r&&(r=d),0===i&&o<d)e=!0,t=c;else if(o>d){e=!0,t=c.visualizationId?c:void 0;break}}}A>.9*window.innerHeight&&!f?j(!0):A<.9*window.innerHeight&&f&&j(!1),!e&&A<r&&n.length&&(t=n[0][1]),!e&&k&&(t=void 0),(k!==!t||!k&&t||k.id!==t.id)&&q(t)}),[A,S]),Object(n.useEffect)((function(){!k&&u&&d(!1)}),[k]),Object(T.jsxs)("div",{className:"Home",children:[Object(T.jsx)(g.a,{children:Object(T.jsx)("title",{children:h})}),Object(T.jsxs)("div",{className:"header",children:[Object(T.jsxs)("div",{className:"titles-container",children:[Object(T.jsx)("h1",{dangerouslySetInnerHTML:{__html:v}}),Object(T.jsx)("h2",{children:_}),Object(T.jsx)("button",{onClick:function(){if(r&&r.current){var e=r.current.offsetTop-window.innerHeight/15;window.scrollTo({top:e,behavior:"smooth"})}},className:"go-to-start",children:Object(T.jsx)("span",{children:"\u2304"})})]}),Object(T.jsx)(De,{})]}),Object(T.jsxs)("main",{ref:r,className:"intro-container",children:[Object(T.jsx)(me.b.Provider,{value:{activeVisualization:k,onBlockClick:function(e,t){var a=t.current.getBoundingClientRect().y+window.scrollY-.9*(.5*window.innerHeight);window.scrollTo({top:a,behavior:"smooth"})},onRegisterVisualization:function(e){var t=Object(s.a)({},e);z(Object(s.a)(Object(s.a)({},S),{},Object(o.a)({},e.id,t)))},onUnregisterVisualization:function(e){var t=Object.entries(S).reduce((function(t,a){var n=Object(l.a)(a,2),r=n[0],i=n[1];return r===e?t:Object(s.a)(Object(s.a)({},t),{},Object(o.a)({},r,i))}),{});z(t)}},children:Object(T.jsxs)("div",{className:"Contents",children:[Object(T.jsx)("section",{className:O()({"is-focused":!u}),children:"fr"===a?Object(T.jsx)(w.default,{}):Object(T.jsx)(N.default,{})}),Object(T.jsx)("aside",{className:O()({"is-focused":u,"is-fixed":f}),children:Object(T.jsx)(ye,{activeVisualization:k})})]})}),Object(T.jsx)(Ee,{lang:a,summary:Ae}),Object(T.jsx)("div",{className:O()("vis-focus-container",{"is-active":u,"is-visible":k}),children:Object(T.jsx)("button",{"data-for":"contents-tooltip","data-effect":"solid","data-tip":"fr"===a?"voir la visualisation associ\xe9e":"see associated visualization",onClick:function(){return d(!u)},children:Object(T.jsx)("span",{children:"\u02c3"})})})]}),Object(T.jsx)(x.a,{id:"contents-tooltip"})]})},Ye=function(e){var t=e.visualization,a=e.lang,n=e.history,r=function(){n.push({pathname:"/".concat(a,"/atlas/")})},i=t["comment_cest_fait_".concat(a)],o=t["comment_lire_".concat(a)],s={howDone:{fr:"Comment les donn\xe9es et la visualisations ont-elles \xe9t\xe9 produites ?",en:"How were the data and visualization produced ?"},howRead:{fr:"Comment lire la visualisation ?",en:"How to read the visualization?"}};return Object(T.jsxs)("div",{className:"VisualizationFocus",children:[Object(T.jsx)("div",{onClick:r,className:"lightbox-background"}),Object(T.jsxs)("div",{className:"lightbox-contents",children:[Object(T.jsxs)("div",{className:"visualization-details",children:[Object(T.jsxs)("div",{className:"details-header",children:[Object(T.jsx)("h2",{children:t["titre_".concat(a)]}),Object(T.jsx)("button",{className:"close-btn",onClick:r,children:"\u2715"})]}),Object(T.jsxs)("div",{className:"details-contents",children:[i&&i.length?Object(T.jsxs)("section",{className:"details-contents-section",children:[Object(T.jsx)("h3",{children:s.howDone[a]}),Object(T.jsx)("p",{children:i})]}):null,o&&o.length?Object(T.jsxs)("section",{className:"details-contents-section",children:[Object(T.jsx)("h3",{children:s.howRead[a]}),Object(T.jsx)("p",{children:o})]}):null]})]}),Object(T.jsx)("div",{className:"visualization-wrapper",children:Object(T.jsx)(xe,{lang:a,atlasMode:!0,activeVisualization:t})})]})]})},Xe=fe.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t.id,t))}),{});var He=function(e){var t=e.match.params,a=t.visualizationId,r=t.lang,i=void 0===r?"fr":r;Object(n.useEffect)((function(){window.scrollTo(0,0)}),[]);var o=Object(u.g)(),s=a&&Xe[a];return Object(T.jsxs)("div",{className:"Atlas secondary-page",children:[Object(T.jsx)(g.a,{children:Object(T.jsx)("title",{children:Object(ee.a)("Atlas",i)})}),Object(T.jsxs)("div",{className:"centered-contents",children:[Object(T.jsx)("h1",{children:"fr"===i?"Atlas des visualisations":"Visualizations atlas"}),Object(T.jsx)("ul",{className:"visualizations-list",children:fe.map((function(e,t){return Object(T.jsxs)("li",{className:O()("visualization-item",{"is-active":s&&s.id===e.id}),onClick:function(){o.push({pathname:"/".concat(i,"/atlas/").concat(e.id)})},children:[Object(T.jsx)("figure",{className:"thumbnail-container",children:Object(T.jsx)("img",{src:"".concat("/portic-storymaps-2021","/thumbnails/").concat(i,"/").concat(e.id,".png"),alt:e["titre_".concat(i)]})}),Object(T.jsx)("h5",{className:"visualization-title",children:e["titre_".concat(i)]})]},t)}))})]}),s?Object(T.jsx)(Ye,{history:o,visualization:s,lang:i}):null]})},We=function(e){var t=e.id,a=e.lang,n=fe.find((function(e){return e.id===t}));return Object(T.jsx)("div",{className:"StandaloneVisualization",children:Object(T.jsx)(xe,{lang:a,atlasMode:!0,activeVisualization:n})})},Ge=function(e){var t=e.Content,a=(e.contentsURL,e.title),r=e.lang,i=void 0===r?"fr":r;return Object(T.jsxs)("div",{className:"PlainPage secondary-page",children:[Object(T.jsx)(g.a,{children:Object(T.jsx)("title",{children:Object(ee.a)(a,i)})}),Object(T.jsx)("div",{className:"centered-contents",children:Object(T.jsx)(n.Suspense,{fallback:Object(T.jsx)("div",{children:"Chargement"}),children:Object(T.jsx)(t,{})})})]})},Ve=a(167),Ue={fr:y.a,en:_.a},Je=B.a.ui,Ze=Je.colorText,Qe=Je.colorAccentBackground,Ke=Je.colorBackgroundBlue,$e=Je.colorBackground,et=function(e){var t=e.routes,a=(e.onLangChange,Object(n.useState)(!1)),r=Object(l.a)(a,2),i=r[0],o=r[1],s=Object(u.h)(),c=Object(n.useMemo)((function(){return s.pathname.includes("/page/part")?"page":"/fr/"===s.pathname||"/en/"===s.pathname?"home":"other-page"}),[s]),p=s&&s.match&&s.match.params&&s.match.params.lang,m="fr";p?m=p:s.pathname.includes("/en/")&&(m="en");var f=Object(M.useScrollYPosition)(),j=Object(Ve.a)(f,50),b=Object(z.a)().range([Ke,$e]).domain([0,1]),h=Object(n.useMemo)((function(){var e=window.innerHeight;switch(c){case"page":return j<e?{fontColor:Ze,backgroundColor:b(j/(e/2))}:{backgroundColor:$e};case"home":return j<.8*e?{fontColor:Ze,backgroundColor:Ke}:{fontColor:"white",backgroundColor:Qe};case"other-page":default:return{fontColor:void 0,backgroundColor:$e}}}),[j,b,c]),g=h.fontColor,v=h.backgroundColor,x=Ue[m].titleHTML;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("nav",{style:{background:v,color:g},className:"nav nav-large",children:[Object(T.jsxs)("ul",{className:"primary-nav-container",children:[Object(T.jsx)("li",{className:"navitem-container",children:Object(T.jsx)(d.c,{exact:!0,to:"/".concat(m,"/"),children:"white"===g?Object(T.jsx)("img",{src:"".concat("/portic-storymaps-2021","/rose_des_vents_white.svg"),alt:"logo"}):Object(T.jsx)("img",{src:"".concat("/portic-storymaps-2021","/rose_des_vents.svg"),alt:"logo"})})}),t.filter((function(e){var t=e.routeGroup,a=void 0===t?"primary":t,n=e.hide;return"primary"===a&&!n})).map((function(e,t){var a=e.shortTitles,n=e.routes,r="/".concat(m,"/page/").concat(n[m]);return Object(T.jsx)("li",{className:"navitem-container",children:Object(T.jsx)(d.c,{to:r,children:a[m]})},t)}))]}),Object(T.jsxs)("ul",{className:"secondary-nav-container",children:[Object(T.jsx)("li",{className:"navitem-container",children:Object(T.jsx)(d.c,{to:"/".concat(m,"/atlas"),children:"fr"===m?"atlas des visualisations":"visualizations atlas"})}),t.filter((function(e){var t=e.routeGroup,a=void 0===t?"primary":t,n=e.hide;return"secondary"===a&&!n})).map((function(e,t){var a=e.shortTitles,n=e.routes,r="/".concat(m,"/page/").concat(n[m]);return Object(T.jsx)("li",{className:"navitem-container",children:Object(T.jsx)(d.c,{to:r,children:a[m]})},t)})),null]})]}),Object(T.jsxs)("nav",{style:{},className:O()("nav nav-drawer",{"is-open":i}),children:[Object(T.jsx)("div",{className:"drawer-background",onClick:function(){return o(!i)}}),Object(T.jsxs)("div",{className:"drawer-body",children:[Object(T.jsxs)("ul",{className:"primary-nav-container",children:[Object(T.jsx)("li",{onClick:function(){return o(!1)},className:"navitem-container",children:Object(T.jsx)(d.c,{exact:!0,to:"/".concat(m,"/"),children:"fr"===m?"accueil":"home"})}),t.filter((function(e){var t=e.routeGroup,a=void 0===t?"primary":t,n=e.hide;return"primary"===a&&!n})).map((function(e,t){var a=e.shortTitles,n=e.routes,r="/".concat(m,"/page/").concat(n[m]);return Object(T.jsx)("li",{onClick:function(){return o(!1)},className:"navitem-container",children:Object(T.jsx)(d.c,{to:r,children:a[m]})},t)}))]}),Object(T.jsxs)("ul",{className:"secondary-nav-container",children:[t.filter((function(e){var t=e.routeGroup,a=void 0===t?"primary":t,n=e.hide;return"secondary"===a&&!n})).map((function(e,t){var a=e.shortTitles,n=e.routes,r="/".concat(m,"/page/").concat(n[m]);return Object(T.jsx)("li",{onClick:function(){return o(!1)},className:"navitem-container",children:Object(T.jsx)(d.c,{to:r,children:a[m]})},t)})),Object(T.jsx)("li",{onClick:function(){return o(!1)},className:"navitem-container",children:Object(T.jsx)(d.c,{to:"/".concat(m,"/atlas"),children:"fr"===m?"atlas des visualisations":"visualizations atlas"})}),null]})]}),Object(T.jsxs)("div",{className:"drawer-header",children:[Object(T.jsx)("button",{onClick:function(){return o(!i)},className:O()("drawer-button"),children:"white"===g||i?Object(T.jsx)("img",{style:{background:i?void 0:v},src:"".concat("/portic-storymaps-2021","/rose_des_vents_white.svg"),alt:"logo"}):Object(T.jsx)("img",{style:{background:i?void 0:v},src:"".concat("/portic-storymaps-2021","/rose_des_vents.svg"),alt:"logo"})}),Object(T.jsx)(d.c,{exact:!0,to:"/".concat(m,"/"),children:Object(T.jsx)("h1",{style:{color:i?void 0:g,background:i?void 0:v},dangerouslySetInnerHTML:{__html:x}})})]})]})]})},tt=function(e){var t=e.percentsLoaded,a=void 0===t?0:t;return Object(T.jsx)("div",{className:"loader-container",children:Object(T.jsx)("div",{className:"loader",children:Object(T.jsx)("div",{className:"loading-bar",style:{width:a+"%"}})})})},at=a(120),nt=function(e){e.lang;return Object(T.jsx)("footer",{className:"Footer",children:Object(T.jsx)("div",{className:"footer-contents",children:Object(T.jsx)(at.default,{})})})},rt=(a(615),a(320)),it=["fr","en"];function ot(){var e=Object(u.g)(),t=Object(u.h)(),i=Object(n.useState)({}),p=Object(l.a)(i,2),b=p[0],g=p[1],v=Object(n.useState)(0),O=Object(l.a)(v,2),x=O[0],y=O[1];Object(n.useEffect)((function(){var e=m()(fe.filter((function(e){return e.datasets})).reduce((function(e,t){return[].concat(Object(c.a)(e),Object(c.a)(t.datasets.split(",").map((function(e){return e.trim()}))))}),[]));e.reduce((function(t,a,n){return t.then((function(t){return new Promise((function(r,i){var c=a?"".concat("/portic-storymaps-2021","/data/").concat(a):void 0;if(!c)return r(t);h.a.get(c,{onDownloadProgress:function(t){var a=t.loaded/t.total,r=n/e.length;y(r+a/Ae.length)}}).then((function(e){var n=e.data;setTimeout((function(){var e=n;"csv"===c.split(".").pop()?e=Object(f.a)(n):"tsv"===c.split(".").pop()&&(e=Object(j.a)(n)),r(Object(s.a)(Object(s.a)({},t),{},Object(o.a)({},a,e)))}))})).catch((function(e){return console.error(e),r(t)}))}))}))}),Promise.resolve({})).then((function(e){y(1),g(e)})).catch(console.error)}),[]);var _=function(e){var t=e.Content,a=e.ContentSync,n=e.ThatComponent,r=void 0===n?Ge:n,i=e.title;return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(r,{Content:t,ContentSync:a,title:i})})};return Object(T.jsxs)(me.a.Provider,{value:b,children:[Object(T.jsxs)("div",{id:"wrapper",children:[Object(T.jsx)("header",{children:Object(T.jsx)(et,{onLangChange:function(a){var n="fr"===a?"en":"fr",r=t.pathname;if(r.includes("atlas")){var i=r.split("/atlas/").pop();e.push("/".concat(a,"/atlas/").concat(i||""))}else{var o=e.location.pathname.split("/").pop(),s=Ae.find((function(e){return e.routes[n]===o}));s?e.push("/".concat(a,"/page/").concat(s.routes[a])):e.push("/".concat(a,"/"))}},routes:Ae})}),Object(T.jsxs)("main",{children:[Object(T.jsxs)(u.d,{children:[it.map((function(e){return Ae.map((function(t,n){var i=t.titles,o=t.routes,s=t.contents,c=t.Component,l=t.contentsProcessed,d="/".concat(e,"/page/").concat(o[e]),p=i[e],m=r.a.lazy((function(){return a(616)("./".concat(s[e]))})),f=l[e];return Object(T.jsx)(u.b,{path:d,exact:!0,children:_({Content:m,ThatComponent:c,title:p,ContentSync:f})},n)}))})),it.map((function(e){return fe.map((function(t,a){var n=t.id,r="/".concat(e,"/visualization/").concat(n);return Object(T.jsx)(u.b,{path:r,exact:!0,component:function(){return Object(T.jsx)(We,{id:n,lang:e})}},a)}))})),Object(T.jsx)(u.b,{path:"/:lang/atlas/:visualizationId?",component:He}),Object(T.jsx)(u.b,{path:"/:lang",exact:!0,component:Ie}),Object(T.jsx)(u.a,{to:"/fr/"})]}),b?null:Object(T.jsx)(tt,{percentsLoaded:100*x})]}),Object(T.jsx)(nt,{lang:"fr"})]}),Object(T.jsx)(r.a.Fragment,{children:it.map((function(e){return Ae.filter((function(t){var a=t.routes;return a[e]&&!a[e].includes("test")})).map((function(t,a){t.titles;var n=t.routes,r=(t.contents,t.Component,t.contentsProcessed,"/".concat(e,"/page/").concat(n[e]));return Object(T.jsx)(d.b,{to:r,exact:!0})}))}))})]})}var st="/".concat(rt.a.split("/").pop());function ct(){return Object(T.jsx)(d.a,{basename:st,children:Object(T.jsx)(ot,{})})}var lt=function(e){e&&e instanceof Function&&a.e(11).then(a.bind(null,646)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),i(e),o(e)}))},ut=document.getElementById("root");ut.hasChildNodes()?Object(i.hydrate)(Object(T.jsx)(r.a.StrictMode,{children:Object(T.jsx)(ct,{})}),ut):Object(i.render)(Object(T.jsx)(r.a.StrictMode,{children:Object(T.jsx)(ct,{})}),ut),lt()},66:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(4),r=a.n(n),i=r.a.createContext({}),o=r.a.createContext({})},68:function(e){e.exports=JSON.parse('[{"id":"intro-provinces","datasets":"cartoweb_france_1789_geojson.geojson","titre_fr":"Carte des provinces \xe9tudi\xe9es : Poitou, Aunis, Saintonge, Angoumois (PASA)","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"intro-ports","datasets":"cartoweb_france_1789_geojson.geojson,ports_locations_data_intro.csv","titre_fr":"Carte des ports de la r\xe9gion PASA","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"intro-bureaux","datasets":"cartoweb_france_1789_geojson.geojson,part_3_step3_viz_customs_offices_data.csv","titre_fr":"Carte des bureaux des fermes de la r\xe9gion PASA","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"viz-principale-partie-1","datasets":"decline_LR_partners.csv, decline_longitudinal_data.csv, decline_LR_partners.csv,decline_LR_products.csv","titre_fr":"Le d\xe9clin de la r\xe9gion de La Rochelle suite \xe0 la perte du Canada","comment_lire_fr":"test","comment_cest_fait_fr":"test","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"viz-principale-partie-2","datasets":"part_2_toflit_viz_data.csv","titre_fr":"Une forte sp\xe9cialisation portuaire : le cas de la traite n\xe9gri\xe8re, du commerce du sel et de l\u2019eau-de-vie","comment_lire_fr":"test","comment_cest_fait_fr":"test","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"viz-principale-partie-3","datasets":"part_3_centralite_comparaison.csv,cartoweb_france_1789_geojson.geojson,part_3_step1_viz_data.csv,flows_1787_around_La Rochelle.gexf,flows_1787_around_Bordeaux.gexf,flows_1787_around_Nantes.gexf,part_3_step3_viz_customs_offices_data.csv,part_3_step3_viz_ports_data.csv","titre_fr":"La Rochelle, port dominant mais pas structurant","comment_lire_fr":"test","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-1-produits-importants-pour-la-rochelle","datasets":"comparison_products_exports_part_la_rochelle.csv","titre_fr":"Produits dont les valeurs d\'exports sont les plus importantes en 1789 : comparaison de La Rochelle \xe0 la moyenne fran\xe7aise","comment_lire_fr":"","comment_cest_fait_fr":"Ports francs non inclus dans les comptages.","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-1-evolution-de-la-part-des-echanges-de-la-rochelle-au-xviiie","datasets":"global_evolution_la_rochelle_imports_exports.csv","titre_fr":"\xc9volution globale de la part des \xe9changes de La Rochelle par rapport \xe0 l\'ensemble de la France","comment_lire_fr":"","comment_cest_fait_fr":"Ports francs non inclus dans les comptages.","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-1-pays-port-d-attache","datasets":"origines_bateaux_etrangers_partant_de_la_region.csv","titre_fr":"Pays d\'attache des navires partant de la r\xe9gion en 1789","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-2-part-navigation-francaise","datasets":"part_navigation_fr.csv","titre_fr":"Part de la navigation fran\xe7aise dans la r\xe9gion","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-3-comparaison-exports-coloniaux","datasets":"comparaison_exports_coloniaux.csv","titre_fr":"Comparaison des exports de produits coloniaux, locaux et autres par bureaux des fermes","comment_lire_fr":"","comment_cest_fait_fr":"Exports vers les ports francs non inclus dans les comptage.","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""},{"id":"partie-2-carte-direction-bateaux-de-la-rochelle","datasets":"cartoweb_world_1789_23mars2021_mixte_20-wgs84_simplified.geojson,voyages-bateaux-homeport-larochelle-1787.csv","titre_fr":"Voyages des bateaux rattach\xe9s au port de La Rochelle en 1787","comment_lire_fr":"","comment_cest_fait_fr":"","titre_en":"","comment_lire_en":"","comment_cest_fait_en":""}]')},78:function(e,t,a){"use strict";t.a={title:"Commerce multi-\xe9chelles autour du port de La Rochelle au XVIII\xe8me si\xe8cle",titleHTML:"Commerce multi-\xe9chelles autour du port de La Rochelle au <span>XVIII</span><sup>e</sup> si\xe8cle",subtitle:"Une \xe9tude de cas du programme de recherche interdisciplinaire PORTIC"}},80:function(e,t,a){"use strict";var n=a(10),r=a(18),i=a(9),o=a(7),s=a(633),c=a(56),l=a(212),u=a(269),d=a(118),p=a(4),m=a(22),f=a(62),j=a(26),b=a(17),h=a(25),g=a(1),v=b.a.generic,O=function(e){var t=e.data,a=e.title,r=(e.orientation,e.layout),b=void 0===r?"stack":r,O=e.width,x=void 0===O?1e3:O,y=e.height,_=void 0===y?400:y,w=e.color,N=e.x,M=e.y,C=e.tooltip,L=e.margins,k=void 0===L?{}:L,q=e.annotations,T=void 0===q?[]:q,R=Object(p.useState)(0),P=Object(o.a)(R,2),S=P[0],z=P[1],A=Object(p.useRef)(null),F=Object(p.useRef)(null),D=x,E=_-S;Object(p.useEffect)((function(){j.a.rebuild()})),Object(p.useEffect)((function(){setTimeout((function(){var e=F.current?F.current.getBoundingClientRect().height:0;z(e)}))}),[D,E,w,t]);var B,I,Y=Object(n.a)({left:100,top:30,bottom:20,right:20},k),X=M.tickFormat,H=M.tickSpan,W=M.domain,G=M.field,V=M.sort,U=void 0===V?{}:V,J=N.tickFormat,Z=N.tickSpan,Q=N.domain,K=N.fillGaps,$=N.field,ee=N.sort,te=void 0===ee?{}:ee,ae=U.field,ne=void 0===ae?G:ae,re=U.ascending,ie=void 0===re||re,oe=U.type,se=void 0===oe?"number":oe,ce=U.autoSort,le=void 0!==ce&&ce,ue=te.field,de=void 0===ue?$:ue,pe=te.ascending,me=void 0===pe||pe,fe=te.type;if(w&&(I=Object(m.uniq)(t.map((function(e){return e[w.field]})))),w&&w.palette)B=w.palette;else if(w){var je=Object(h.c)(w.field,I.length);B=I.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(i.a)({},t,je[a]))}),{})}var be=Object(m.uniq)(t.filter((function(e){return+e[M.field]})).map((function(e){return e[N.field]}))),he=D-Y.left-Y.right,ge=be,ve=be.length,Oe=he/ve,xe=Object(s.a)().domain(ge).range([Y.left+Oe/2,D-Y.right-Oe/2]);if(Q)ve=(be=ge=Object(l.a)(Q)).length,Oe=he/ve,xe=Object(c.a)().domain(Object(u.a)(ge)).range([Y.left+Oe/2,D-Y.right-Oe/2]).nice();else if(K){var ye=Object(u.a)(be.filter((function(e){return+e})).map((function(e){return+e})));Z&&(ye[0]=ye[0]-ye[0]%Z,ye[1]=ye[1]+ye[1]%Z),ve=(be=ge=Object(l.a)(ye[0],ye[1])).length,Oe=he/ve,xe=Object(c.a)().domain(Object(u.a)(ge)).range([Y.left+Oe/2,D-Y.right-Oe/2]).nice()}var _e=Object.entries(Object(m.groupBy)(t,(function(e){return e[N.field]}))),we=W||"stack"===b?[0,Object(d.a)(_e.map((function(e){var t=Object(o.a)(e,2);t[0];return t[1].reduce((function(e,t){return e+ +t[M.field]}),0)})))]:[0,Object(d.a)(t.map((function(e){return+e[M.field]})))],Ne="stack"===b?Oe/2:Oe/I.length*.5,Me=Object(c.a)().domain(we).range([E-Y.bottom,Y.top]).nice(),Ce=Me.copy().range([0,E-Y.bottom-Y.top]),Le=Z?Object(l.a)(ge[0],ge[ge.length-1],Z):be,ke=Object(f.axisPropsFromTickScale)(Me,10).values;return H&&(we[0]=we[0]-we[0]%H,we[1]=we[1]+(H-we[0]%H),ke=Object(l.a)(we[0],we[1],H),Me.domain(we)),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("figure",{style:{width:x,height:_},className:"BarChart is-horizontal GenericVisualization",children:[Object(g.jsx)("div",{ref:F,className:"row",children:a?Object(g.jsx)("h5",{className:"visualization-title",style:{marginLeft:Y.left},children:a}):null}),Object(g.jsxs)("div",{className:"row vis-row",children:[Object(g.jsxs)("svg",{className:"chart",width:D,height:E,children:[Object(g.jsxs)("g",{className:"axis left-axis ticks",children:[Object(g.jsx)("text",{x:Y.left-10,y:Y.top-15,className:"axis-title",children:M.title||M.field}),ke.map((function(e,t){return Object(g.jsxs)("g",{transform:"translate(0, ".concat(Me(e),")"),children:[Object(g.jsx)("text",{x:Y.left-10,y:3,children:"function"===typeof X?X(e,t):e}),Object(g.jsx)("line",{className:"tick-mark",x1:Y.left-5,x2:Y.left,y1:0,y2:0}),Object(g.jsx)("line",{className:"background-line",x1:Y.left,x2:xe(Le[Le.length-1]),y1:0,y2:0})]},e)}))]}),Object(g.jsx)("g",{className:"axis bottom-axis ticks",children:Le.map((function(e,t){return Object(g.jsxs)("g",{transform:"translate(".concat(xe(e),", 0)"),children:[Object(g.jsx)("text",{x:0,y:E-Y.bottom+20,children:"function"===typeof J?J(e,t):e}),Object(g.jsx)("line",{className:"background-line",x1:0,x2:0,y1:Me(ke[ke.length-1]),y2:E-Y.bottom}),Object(g.jsx)("line",{className:"tick-mark",x1:0,x2:0,y1:E-Y.bottom,y2:E-Y.bottom+5})]},e)}))}),Object(g.jsxs)("g",{className:"annotations-container",children:[T.filter((function(e){return"x"===e.axis})).map((function(e,t){var a=e.start,n=e.end,r=e.label,i=e.labelPosition,o=void 0===i?20:i,s=E-Me(ke[ke.length-1])-Y.bottom,c=E-Y.bottom,l=Me(ke[ke.length-1]);return Object(g.jsxs)("g",{className:"annotation x-axis-annotation",children:[Object(g.jsx)("rect",{x:xe(a),width:xe(n)-xe(a),height:s,y:l,fill:"url(#diagonalHatch)",opacity:.4}),Object(g.jsx)("line",{x1:xe(a),x2:xe(a),y1:c,y2:l,stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(g.jsx)("line",{x1:xe(n),x2:xe(n),y1:c,y2:l,stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(g.jsx)("line",{x1:xe(n)+20,x2:xe(n)+10,y1:l+o-5,y2:l+o-5,stroke:"grey","marker-end":"url(#arrowhead)"}),Object(g.jsx)("text",{x:xe(n)+22,y:l+o,fontSize:".5rem",fill:"grey",children:r}),Object(g.jsx)("defs",{children:Object(g.jsx)("marker",{id:"arrowhead",markerWidth:"5",markerHeight:"5",refX:"0",refY:"2.5",orient:"auto",children:Object(g.jsx)("polygon",{stroke:"grey",fill:"transparent",points:"0 0, 5 2.5, 0 5"})})}),Object(g.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:Object(g.jsx)("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"grey",opacity:.5,strokeWidth:1}})})]},t)})),T.filter((function(e){return"y"===e.axis})).map((function(e,t){var a=e.start,n=e.end,r=e.label,i=e.labelPosition,o=void 0===i?20:i,s=Y.left,c=xe(Le[Le.length-1]);return Object(g.jsxs)("g",{className:"annotation y-axis-annotation",children:[Object(g.jsx)("rect",{x:s,width:c-s,y:Me(a),height:Math.abs(Me(n)-Me(a)),fill:"url(#diagonalHatch)",opacity:.4}),Object(g.jsx)("line",{x1:s,x2:c,y1:Me(a),y2:Me(a),stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(g.jsx)("line",{x1:s,x2:c,y1:Me(n),y2:Me(n),stroke:"grey",opacity:.4,strokeDasharray:"4,2"}),Object(g.jsx)("line",{x1:s+o-5,x2:s+o-5,y1:Me(a)-15,y2:Me(a)-5,stroke:"grey","marker-end":"url(#arrowhead)"}),Object(g.jsx)("text",{x:s+o,y:Me(a)-10,fontSize:".5rem",fill:"grey",children:r}),Object(g.jsx)("defs",{children:Object(g.jsx)("marker",{id:"arrowhead",markerWidth:"5",markerHeight:"5",refX:"0",refY:"2.5",orient:"auto",children:Object(g.jsx)("polygon",{stroke:"grey",fill:"transparent",points:"0 0, 5 2.5, 0 5"})})}),Object(g.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:Object(g.jsx)("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"grey",opacity:.5,strokeWidth:1}})})]},t)}))]}),Object(g.jsx)("g",{className:"bars-container",children:_e.sort((function(e,t){var a=me?1:-1;return de===N.field?("number"===fe?+e[0]:e[0])<("number"===fe?+t[0]:t[0])?-1*a:1*a:("number"===fe?+e[1].reduce((function(e,t){return e+ +t[de]}),0):e[1][de])<("number"===fe?+t[1].reduce((function(e,t){return e+ +t[de]}),0):t[1][de])?-1*a:1*a})).map((function(e,t){var a=Object(o.a)(e,2),n=(a[0],a[1]),r=E-Y.bottom;return Object(g.jsx)("g",{transform:"translate(".concat(xe(n[0][N.field]),", 0)"),children:n.sort((function(e,t){if(!le)return 0;var a=ie?1:-1;return("number"===se?+e[ne]:e[ne])>+("number"===se?+t[ne]:t[ne])?-1*a:1*a})).map((function(e,a){var i="stack"===b?-Ne/2:a*(.5*Oe/n.length)-Oe/4,o="stack"===b?Ce(e[M.field]):E-Y.bottom-Me(e[M.field])||0,s="stack"===b?r-o:Me(e[M.field]);"stack"===b&&(r-=o);var c=B?B[e[w.field]]:v.dark;return Object(g.jsx)(g.Fragment,{children:+e[M.field]>0?Object(g.jsx)("rect",{fill:c,width:Ne,x:i,y:s,height:o,"data-for":"bar-tooltip","data-tip":"function"===typeof C?C(e,a,t):void 0},a):null})}))},t)}))})]}),w?Object(g.jsxs)("div",{className:"ColorLegend",ref:A,style:{top:S},children:[Object(g.jsx)("h5",{children:w.title||"L\xe9gende"}),Object(g.jsx)("ul",{className:"color-legend",children:Object.entries(B).map((function(e){var t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(g.jsxs)("li",{children:[Object(g.jsx)("span",{className:"color-box",style:{background:n}}),Object(g.jsx)("span",{className:"color-label",children:a})]},a)}))})]}):null]})]}),Object(g.jsx)(j.a,{id:"bar-tooltip"})]})},x=b.a.generic,y=function(e){var t=e.data,a=e.title,r=e.layout,s=void 0===r?"stack":r,u=e.width,b=void 0===u?1200:u,v=e.height,O=void 0===v?1200:v,y=e.color,_=e.y,w=e.x,N=e.tooltip,M=e.margins,C=void 0===M?{}:M,L=Object(p.useState)(0),k=Object(o.a)(L,2),q=k[0],T=k[1],R=Object(p.useState)(0),P=Object(o.a)(R,2),S=P[0],z=P[1],A=Object(p.useRef)(null),F=Object(p.useRef)(null),D=b-S,E=O-q;Object(p.useEffect)((function(){j.a.rebuild()})),Object(p.useEffect)((function(){setTimeout((function(){var e=F.current?F.current.getBoundingClientRect().height:0,t=A.current?A.current.getBoundingClientRect().width:0;T(e),z(t)}))}),[D,E,y,t]);var B,I,Y=Object(n.a)({left:100,top:30,bottom:20,right:30},C),X=w.tickFormat,H=w.tickSpan,W=w.domain,G=w.field,V=w.sort,U=void 0===V?{}:V,J=_.rowHeight,Z=_.formatLabel,Q=_.field,K=_.sort,$=void 0===K?{}:K,ee=$.field,te=void 0===ee?Q:ee,ae=$.autoSort,ne=void 0!==ae&&ae,re=$.ascending,ie=void 0===re||re,oe=$.type,se=U.field,ce=void 0===se?G:se,le=U.ascending,ue=void 0===le||le,de=U.type,pe=void 0===de?"number":de;if(y&&(I=Object(m.uniq)(t.map((function(e){return e[y.field]})))),y&&y.palette)B=y.palette;else if(y){var me=Object(h.c)(y.field,I.length);B=I.reduce((function(e,t,a){return Object(n.a)(Object(n.a)({},e),{},Object(i.a)({},t,me[a]))}),{})}var fe=Object(m.uniq)(t.map((function(e){return e[_.field]}))).length,je=J?J*fe:E-q,be=J||je/fe,he=Object.entries(Object(m.groupBy)(t,(function(e){return e[_.field]}))),ge=W||"stack"===s?[0,Object(d.a)(he.map((function(e){var t=Object(o.a)(e,2);t[0];return t[1].reduce((function(e,t){return e+ +t[w.field]}),0)})))]:[0,Object(d.a)(t.map((function(e){return+e[w.field]})))],ve="stack"===s?be/2:be/I.length*.5,Oe=Object(c.a)().domain(ge).range([0,D-Y.left-Y.right]).nice(),xe=Oe.copy().range([0,D-Y.left-Y.right]),ye=Object(f.axisPropsFromTickScale)(Oe,10).values;H&&(ge[0]=ge[0]-ge[0]%H,ge[1]=ge[1]+ge[1]%H,ye=Object(l.a)(ge[0],ge[1],H),Oe.domain(ge));var _e=je+Y.top+Y.bottom,we=O>_e+q?O:_e+q;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("figure",{style:{width:b,height:we},className:"BarChart is-vertical GenericVisualization",children:[Object(g.jsx)("div",{ref:F,className:"row",children:a?Object(g.jsx)("h5",{className:"visualization-title",style:{marginLeft:Y.left},children:a}):null}),Object(g.jsxs)("div",{className:"row vis-row",children:[Object(g.jsxs)("svg",{className:"chart",width:D,height:_e,children:[Object(g.jsx)("g",{className:"axis top-axis ticks",children:ye.map((function(e,t){return Object(g.jsxs)("g",{transform:"translate(".concat(Y.left+Oe(e),", 0)"),children:[Object(g.jsx)("text",{x:0,y:Y.top-5,children:"function"===typeof X?X(e,t):e}),Object(g.jsx)("line",{className:"background-line",x1:0,x2:0,y1:Y.top,y2:je+Y.top}),Object(g.jsx)("text",{x:0,y:_e-Y.bottom+10,children:"function"===typeof X?X(e,t):e})]},e)}))}),Object(g.jsx)("g",{className:"bars-container",children:he.sort((function(e,t){if(!ne)return 0;var a=ie?1:-1;return te===_.field?("number"===oe?+e[0]:e[0])<("number"===oe?+t[0]:t[0])?-1*a:1*a:("number"===oe?+e[1].reduce((function(e,t){return e+ +t[te]}),0):e[1][te])<("number"===oe?+t[1].reduce((function(e,t){return e+ +t[te]}),0):t[1][te])?-1*a:1*a})).map((function(e,t){var a=Object(o.a)(e,2),n=a[0],r=a[1],i=Y.left;return Object(g.jsxs)("g",{transform:"translate(0, ".concat(Y.top+be*t,")"),children:[Object(g.jsx)("foreignObject",{x:0,y:"stack"===s?ve/4:ve/2,width:Y.left,height:be,children:Object(g.jsx)("div",{className:"vertical-bar-label",children:Object(g.jsx)("div",{children:"function"===typeof Z?Z(n,t):n})})}),r.sort((function(e,t){if(!ne)return 0;var a=ue?1:-1;return("number"===pe?+e[ce]:e[ce])>+("number"===pe?+t[ce]:t[ce])?-1*a:1*a})).map((function(e,a){var n="stack"===s?ve/2:a*(.5*be/r.length)+be/4,o="stack"===s?xe(+e[w.field]):Oe(e[w.field]),c="stack"===s?i:Y.left;"stack"===s&&(i+=o);var l=B?B[e[y.field]]:x.dark;return Object(g.jsx)(g.Fragment,{children:+e[w.field]>0?Object(g.jsx)("rect",{fill:l,width:o,x:c,y:n,height:ve-1,"data-for":"bar-tooltip","data-tip":"function"===typeof N?N(e,a,t):void 0},a):null})}))]},t)}))})]}),y?Object(g.jsxs)("div",{className:"ColorLegend",ref:A,style:{top:q},children:[Object(g.jsx)("h5",{children:y.title||"L\xe9gende"}),Object(g.jsx)("ul",{className:"color-legend",children:Object.entries(B).map((function(e){var t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(g.jsxs)("li",{children:[Object(g.jsx)("span",{className:"color-box",style:{background:n}}),Object(g.jsx)("span",{className:"color-label",children:a})]},a)}))})]}):null]})]}),Object(g.jsx)(j.a,{id:"bar-tooltip"})]})},_=["orientation"],w=function(e){var t=e.orientation,a=void 0===t?"horizontal":t,i=Object(r.a)(e,_);return"horizontal"===a?Object(g.jsx)(O,Object(n.a)({},i)):Object(g.jsx)(y,Object(n.a)({},i))};t.a=w},95:function(e,t,a){"use strict";t.a={title:"Commerce multi-\xe9chelles autour du port de La Rochelle au XVIII\xe8me si\xe8cle",titleHTML:"Commerce multi-\xe9chelles autour du port de La Rochelle au XVIII<sup>e</sup> si\xe8cle",subtitle:"Une \xe9tude de cas du programme de recherche interdisciplinaire PORTIC"}}},[[617,3,4]]]);
//# sourceMappingURL=main.ef3605f7.chunk.js.map