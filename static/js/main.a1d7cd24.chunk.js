(this["webpackJsonpreact-gh-pages"]=this["webpackJsonpreact-gh-pages"]||[]).push([[0],{173:function(e,t,n){},279:function(e,t,n){},282:function(e,t,n){},283:function(e,t,n){var a={"./en/about.mdx":[288,3],"./en/part-1.mdx":[289,4],"./en/part-2-1.mdx":[290,5],"./en/part-2-2.mdx":[291,6],"./en/part-2-3.mdx":[292,7],"./en/part-2-intro.mdx":[293,8],"./en/part-3.mdx":[294,9],"./fr/a-propos.mdx":[295,10],"./fr/partie-1.mdx":[296,11],"./fr/partie-2-1.mdx":[297,12],"./fr/partie-2-2.mdx":[298,13],"./fr/partie-2-3.mdx":[299,14],"./fr/partie-2-intro.mdx":[300,15],"./fr/partie-3.mdx":[301,16]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=283,e.exports=r},284:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n.n(a),c=n(150),o=n.n(c),i=(n(173),n(9)),s=n(20),l=n(64),u=r.a.createContext({}),d=n(84),j=n(35),b=n(13),p=n(8);var m=function(e){var t=e.path;return Object(p.jsx)("img",{alt:t,src:"".concat("/portic-storymaps-2021").concat(t)})},f=n(19),O=n(316),g=n(309),h=n(36),v=n.n(h),x=function(e){var t=e.data,n=e.spec,r=Object(a.useState)(null),c=Object(i.a)(r,2),o=c[0],s=c[1],l=Object(a.useState)(!0),u=Object(i.a)(l,2),d=u[0],j=u[1],b="".concat("/portic-storymaps-2021","/data/").concat(t);return Object(a.useEffect)((function(){v()(b).then((function(e){var t=e.data,n=Object(g.a)(t);s(n),j(!1)})).catch((function(e){j(!1)}))}),[b]),n?d?Object(p.jsxs)("div",{children:["Chargement des donn\xe9es (",b,") ..."]}):o?Object(p.jsx)("div",{children:Object(p.jsx)(O.a,{spec:Object(f.a)(Object(f.a)({},n),{},{$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:o}})})}):Object(p.jsx)("div",{children:"Erreur ..."}):Object(p.jsx)("div",{children:"Vous devez sp\xe9cifier une spec pour le composant vega."})},C=n(158),N=n(31),y=n(315),S=n(113),z=n(114),k=n(92),L=n(159),P=n.n(L),R="#999",E=[2,15];var w=n(160),F=n.n(w),M=n(161),_=n.n(M),T=n(162),D=n.n(T);function V(e){var t=e.rescale,n=e.zoomIn,a=e.zoomOut;return Object(p.jsx)("ul",{className:D()("VisControls GraphControls"),children:Object(p.jsxs)("li",{className:"vis-controls-item camera",children:[Object(p.jsx)("button",{onClick:a,children:"-"}),Object(p.jsx)("button",{onClick:n,children:"+"}),Object(p.jsx)("button",{onClick:t,children:"Recentrer"})]})})}var G=n(163),U=n.n(G),I={cmin:25.59,cmax:55.59,lmin:60.94,lmax:90.94},A=["#999"];function q(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}function B(e,t){return 1!==t&&t?2===t?["#D77186","#61A2DA"]:U()(t,{colorSpace:I,seed:e,clustering:"force-vector"}):A}n(279);var J=Object(N.a)().domain([0,1]).range([200,10]),W=Object(N.a)().domain([0,1]).range([300,30]);function X(e){e.getCamera().animatedReset(e)}function H(e){e.getCamera().animatedZoom(e)}function Z(e){e.getCamera().animatedUnzoom(e)}function $(e){var t=e.graph,n=e.nodeColor,r=e.nodeSize,c=e.labelDensity,o=e.nodeLabel,s=e.onCameraUpdate,l=e.cameraPosition,u=e.updateTimestamp,d=Object(a.useMemo)((function(){var e=[];return t.forEachNode((function(t,n){e.push(+(r?n[r]:n.size))})),e}),[r,t]),j=Object(y.a)(d),b={nodeSize:{min:j[0],max:j[1]}},m=Object(a.useMemo)((function(){return r?{min:Object(S.a)(j),max:Object(z.a)(j),name:r}:void 0}),[r,j]),O=Object(a.useMemo)((function(){if(n){var e=[];t.forEachNode((function(t,a){e.push(a[n])})),e=Object(k.uniq)(e);var a=B(n,e.length),r={},c=0;return e.forEach((function(e){r[e]=a[c],c++})),{palette:r,name:n}}}),[n,t]),g=Object(a.useMemo)((function(){var e=new Map;return t.forEach((function(t,n,a,r,c,o){e.set(c,{sourceNode:a,targetNode:r})})),e}),[t]),h=q(O),v=q(m),x=q(o),L=q(c),w=function(e){var t=e.nodeColor,n=e.nodeSize,a=(e.nodeLabel,e.nodeSizeFactor),r=void 0===a?1:a,c=e.extents,o=null;return o=n?Object(N.a)().domain([n.min,n.max]).range(E):Object(N.a)().domain([c.nodeSize.min,c.nodeSize.max]).range(E),function(e,a){var c=Object(f.a)(Object(f.a)({},a),{},{x:isNaN(a.x)||void 0===a.x?0:a.x,y:isNaN(a.y)||void 0===a.y?0:a.y});if(c.color=t?t.palette[a[t.name]]||R:a.color||R,n){var i=a[n.name];i="number"===typeof i?i:1,c.size=o(i)}else{var s=a.size||1;c.size=o(s)}return c.size*=r,c}}({nodeColor:O,nodeSize:m,nodeLabel:o,extents:b}),F=function(e){var t=e.nodeColor,n=e.nodeSize,a=(e.nodeLabel,e.nodeSizeFactor,e.extents,e.dontColorEdges,e.edgesMap);return function(e,r,c,o){var i=a.get(e),s=i.sourceNode,l=i.targetNode,u={},d=(n?s[n.name]:s.size)>(n?l[n.name]:l.size)?s:l;return d&&(u.color=t?t.palette[d[t.name]]||R:d.color||R,u.color=P()(u.color).lighten(.4).rgb().string()),u}}({nodeColor:O,nodeSize:m,nodeLabel:o,extents:b,edgesMap:g}),M=Object(a.useRef)(null),_=Object(a.useState)(null),T=Object(i.a)(_,2),D=T[0],G=T[1];if(Object(a.useEffect)((function(){l&&D&&D.getCamera().animate(l)}),[u]),D){var U=!1;h===O&&v===m&&x===o||(D.settings.nodeReducer=w,D.settings.edgeReducer=F,U=!0),L!==c&&(D.settings.labelGrid.cell={width:W(c),height:J(c)},D.displayedLabels=new Set,U=!0),U&&D.refresh()}var I=Object(a.useCallback)((function(e){if(D&&D.graph!==t&&(D.kill(),G(null)),e&&t){var n=new C.WebGLRenderer(t,e,{nodeReducer:w,edgeReducer:F});G(n);var a=n.getCamera();s(a.getState()),a.on("updated",(function(e){s(e)}))}M.current=e}),[t]);return Object(p.jsxs)("div",{className:"VisContainer GraphContainer",children:[Object(p.jsx)("div",{ref:I,style:{width:"100%",height:"50vh"}}),D&&Object(p.jsx)(V,{rescale:X.bind(null,D),zoomIn:H.bind(null,D),zoomOut:Z.bind(null,D)})]})}var K=function(e){var t=e.data,n=e.nodeColor,r=e.nodeLabel,c=e.nodeSize,o=e.labelDensity,s=void 0===o?.5:o,l=e.cameraPosition,u=void 0===l?{x:.5,y:.5,angle:0,ratio:1}:l,d=Object(a.useState)(null),j=Object(i.a)(d,2),b=j[0],m=j[1],O=Object(a.useState)(u),g=Object(i.a)(O,2),h=g[0],x=g[1],C=Object(a.useState)(!0),N=Object(i.a)(C,2),y=N[0],S=N[1];Object(a.useEffect)((function(){x(u)}),[u]);var z="".concat("/portic-storymaps-2021","/data/").concat(t);return Object(a.useEffect)((function(){v()(z).then((function(e){var t=e.data,n=F.a.parse(_.a,t);n.forEachNode((function(e){n.updateNode(e,(function(e){return Object(f.a)(Object(f.a)({},e),{},{x:e.x?e.x:0,y:e.y?e.y:0})}))})),m(n),S(!1)})).catch((function(e){S(!1)}))}),[z]),y?Object(p.jsxs)("div",{children:["Chargement des donn\xe9es (",z,") ..."]}):b?Object(p.jsx)("div",{className:"SigmaComponent",children:Object(p.jsx)($,{graph:b,cameraPosition:h,nodeColor:n,nodeSize:c,labelDensity:s,nodeLabel:r,onCameraUpdate:function(e){x(e)}})}):Object(p.jsx)("div",{children:"Erreur ..."})},Q=n(4),Y=n(314),ee=n(317),te=function(e){var t=e.dataFilename,n=e.backgroundFilename,r=e.width,c=void 0===r?800:r,o=e.height,s=void 0===o?450:o,l=e.markerSize,u=e.markerColor,d=Object(a.useState)(null),j=Object(i.a)(d,2),b=j[0],m=j[1],O=Object(a.useState)(null),h=Object(i.a)(O,2),x=h[0],C=h[1],S=Object(a.useState)(!0),z=Object(i.a)(S,2),L=z[0],P=z[1],R=Object(a.useState)(!0),E=Object(i.a)(R,2),w=E[0],F=E[1];Object(a.useEffect)((function(){if(t){var e="".concat("/portic-storymaps-2021","/data/").concat(t);v()(e).then((function(e){var t=e.data,n=Object(g.a)(t);m(n),P(!1)})).catch((function(e){P(!1)}))}}),[t]);var M=Object(a.useMemo)((function(){if(b){var e={};b.forEach((function(t){var n=t.latitude+","+t.longitude;e[n]?e[n].size+=isNaN(+t[l])?0:+t[l]:e[n]={latitude:t.latitude,longitude:t.longitude,color:t[u],size:isNaN(+t[l])?0:+t[l]}}));var t=Object.entries(e).map((function(e){var t=Object(i.a)(e,2);t[0];return t[1]})),n=Object(k.uniq)(t.map((function(e){return e.color}))),a=B("map",n.length),r=n.reduce((function(e,t,n){return Object(f.a)(Object(f.a)({},e),{},Object(Q.a)({},t,a[n]))}),{}),o=Object(y.a)(t.map((function(e){return e.size}))),s=Object(N.a)().domain(o).range([1,c/100]);return t=t.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{color:r[e.color],size:s(e.size)})}))}}),[b,u,l,c]);Object(a.useEffect)((function(){if(n){var e="".concat("/portic-storymaps-2021","/data/").concat(n);v()(e).then((function(e){var t=e.data;C(t),F(!1)})).catch((function(e){F(!1)}))}}),[n]);var _=Object(a.useMemo)((function(){return x?Object(Y.a)().fitSize([c,s],x):Object(Y.a)().scale(200).translate([c/2,s/2])}),[x,c,s]);return w||L?Object(p.jsx)("div",{children:"Chargement des donn\xe9es ..."}):x&&b?Object(p.jsx)("div",{children:Object(p.jsxs)("svg",{width:c,height:s,viewBox:'"0 0 '.concat(c," ").concat(s),style:{border:"1px solid lightgrey"},children:[Object(p.jsx)("g",{className:"background",children:x.features.map((function(e,t){return Object(p.jsx)("path",{d:Object(ee.a)().projection(_)(e),className:"geopart",fill:"rgba(38,50,56,".concat(1/x.features.length*t,")"),stroke:"#FFFFFF",strokeWidth:.5},"path-".concat(t))}))}),Object(p.jsx)("g",{className:"markers",children:M.filter((function(e){var t=e.latitude,n=e.longitude;return t&&n&&!isNaN(t)&&!isNaN(n)})).map((function(e,t){var n=e.latitude,a=e.longitude,r=e.size,c=e.color,o=_([+a,+n]),s=Object(i.a)(o,2),l=s[0],u=s[1];return Object(p.jsx)("circle",{cx:l,cy:u,r:r,fill:c,className:"marker"},t)}))})]})}):Object(p.jsx)("div",{children:"Erreur ..."})},ne=n.p+"static/media/ports-region-1789.3778ed29.svg",ae={};function re(e){var t=e.components,n=Object(j.a)(e,["components"]);return Object(b.a)("wrapper",Object.assign({},ae,n,{components:t,mdxType:"MDXLayout"}),Object(b.a)("h1",null,"Commerce multi-\xe9chelle dans la r\xe9gion de La Rochelle"),Object(b.a)("p",null,'Ce site a vocation \xe0 monter progressivement les "storymaps" issues du datasprint PORTIC 2021.'),Object(b.a)("p",null,"Voici un tour d'horizon des modules react pr\xe9par\xe9s pour faciliter le d\xe9veloppement :"),Object(b.a)("h2",null,"Image SVG (avec webpack)"),Object(b.a)("p",null,"On int\xe8gre une image  SVG depuis le local (elle sera donc pack\xe9e par webpack) :"),Object(b.a)("img",{src:ne}),Object(b.a)("h2",null,"Image SVG (sans webpack)"),Object(b.a)("p",null,"On int\xe8gre ici directement une image \xe0 partir de son URL en ligne (depuis le dossier ",Object(b.a)("inlineCode",{parentName:"p"},"public"),")"),Object(b.a)(m,{path:"/svg/ports-region-1789.svg",mdxType:"SvgComponent"}),Object(b.a)("h2",null,"Visualisation vega"),Object(b.a)("p",null,"Les visualisations vega ont besoin d'un fichier csv stock\xe9 dans le dossier ",Object(b.a)("inlineCode",{parentName:"p"},"public/data")," et d'une spec vega."),Object(b.a)(x,{data:"sorties_navires_vers_colonies.csv",spec:{mark:"rect",encoding:{x:{field:"port_depart",type:"nominal"},y:{field:"port_destination",type:"nominal"},color:{type:"quantitative",field:"tonnage",aggregate:"sum"}}},mdxType:"VegaComponent"}),Object(b.a)("h2",null,"R\xe9seau avec sigma"),Object(b.a)("p",null,"Les visualisations sigma ont besoin d'un fichier gexf stock\xe9 dans le dossier ",Object(b.a)("inlineCode",{parentName:"p"},"public/data"),"."),Object(b.a)("p",null,"Param\xe8tres :"),Object(b.a)("ul",null,Object(b.a)("li",{parentName:"ul"},Object(b.a)("inlineCode",{parentName:"li"},"nodeColor")," : attribut pour couleur"),Object(b.a)("li",{parentName:"ul"},Object(b.a)("inlineCode",{parentName:"li"},"nodeSize")," : attribut pour taille"),Object(b.a)("li",{parentName:"ul"},Object(b.a)("inlineCode",{parentName:"li"},"labelDensity")," : densit\xe9 des labels (float dans ","[0, 1]",")")),Object(b.a)(K,{data:"toflit_aggregate_1789_only_out.gexf",nodeColor:"admiralty",nodeSize:"inside_degree",labelDensity:.5,mdxType:"SigmaComponent"}),Object(b.a)("h2",null,"Carto avec kepler"),Object(b.a)("h2",null,"Carto sans kepler"),Object(b.a)("p",null,"Ci-dessous un proto/boilerplate pour rendre du svg + donn\xe9es avec la galaxie d3 + du rendu direct en SVG via react."),Object(b.a)("p",null,"Cartographie des destination des bateaux aillant un port d'attache dans la r\xe9gion, par tonnage cumul\xe9 (couleur = amiraut\xe9) :"),Object(b.a)(te,{backgroundFilename:"cartoweb_france_1789_geojson.geojson",dataFilename:"navigo-out-of-ships-from-region.csv",markerColor:"pointcall_admiralty",markerSize:"tonnage",mdxType:"GeoComponent"}))}re.isMDXComponent=!0;var ce=function(e){var t=e.lang;return Object(p.jsxs)("div",{children:[Object(p.jsx)(d.a,{children:Object(p.jsx)("title",{children:"fr"===t?"Commerce multi-\xe9chelle dans la r\xe9gion de La Rochelle":"Multi-scale trade in La Rochelle region"})}),Object(p.jsx)(re,{})]})},oe=function(e){var t=e.routes,n=e.lang,a=e.onLangChange;return Object(p.jsx)("nav",{children:Object(p.jsxs)("ul",{children:[Object(p.jsx)("li",{className:"navitem-container",children:Object(p.jsx)(l.b,{to:"/",children:"fr"===n?"Accueil":"Home"})}),t.map((function(e,t){var a=e.titles,r=e.routes,c="/page/".concat(n,"/").concat(r[n]);return Object(p.jsx)("li",{className:"navitem-container",children:Object(p.jsx)(l.b,{to:c,children:a[n]})},t)})),Object(p.jsxs)("li",{className:"lang-toggle",children:[Object(p.jsx)("button",{className:"fr"===n?"is-active":"",onClick:function(){return a("fr")},children:"fr"}),Object(p.jsx)("button",{className:"en"===n?"is-active":"",onClick:function(){return a("en")},children:"en"})]})]})})},ie=function(e){var t=e.Content,n=(e.contentsURL,e.title);return Object(p.jsxs)("div",{className:"PlainPage",children:[Object(p.jsx)(d.a,{children:Object(p.jsx)("title",{children:n})}),Object(p.jsx)(a.Suspense,{fallback:Object(p.jsx)("div",{children:"Chargement"}),children:Object(p.jsx)(t,{})})]})},se=(n(282),[{routes:{fr:"partie-1",en:"part-1"},titles:{fr:"Partie 1 - Le d\xe9clin de la r\xe9gion de La Rochelle suite \xe0 la perte du Canada",en:"Partie 1 - The decline of La Rochelle region after Canada's loss"},contents:{fr:"fr/partie-1.mdx",en:"en/part-1.mdx"}},{routes:{fr:"partie-2",en:"part-2"},titles:{fr:"Partie 2 - Une forte sp\xe9cialisation portuaire: le cas de la traite n\xe9gri\xe8re, du commerce du sel et de l'eau-de-vie",en:"Partie 2 - A strong portual specialization"},contents:{fr:"fr/partie-2-intro.mdx",en:"en/part-2-intro.mdx"}},{routes:{fr:"partie-2-1",en:"part-2-1"},titles:{fr:"Partie 2.1 - La Rochelle et le commerce triangulaire",en:"Partie 2.1 - La Rochelle and triangular trade"},contents:{fr:"fr/partie-2-1.mdx",en:"en/part-2-1.mdx"}},{routes:{fr:"partie-2-2",en:"part-2-2"},titles:{fr:"Partie 2.2 - Le commerce de l\u2019eau-de-vie",en:"Partie 2.2 - Eau-de-vie trade"},contents:{fr:"fr/partie-2-2.mdx",en:"en/part-2-2.mdx"}},{routes:{fr:"partie-2-3",en:"part-2-3"},titles:{fr:"Partie 2.3 - Marennes et le commerce du sel",en:"Partie 2.3 - Marennes and salt trade"},contents:{fr:"fr/partie-2-3.mdx",en:"en/part-2-3.mdx"}},{routes:{fr:"partie-3",en:"part-3"},titles:{fr:"Partie 3 - La Rochelle, port dominant mais pas structurant",en:"Part 3 - La Rochelle port, dominating but not structuring"},contents:{fr:"fr/partie-3.mdx",en:"en/part-3.mdx"}},{routes:{fr:"a-propos",en:"about"},titles:{fr:"\xc0 propos",en:"About"},contents:{fr:"fr/a-propos.mdx",en:"en/about.mdx"}}]),le=["fr","en"];function ue(){var e=Object(s.g)(),t=Object(a.useState)("fr"),c=Object(i.a)(t,2),o=c[0],l=c[1],d=function(e){var t=e.Content,n=e.ThatComponent,a=void 0===n?ie:n,r=e.title;return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(a,{Content:t,title:r})})};return Object(p.jsx)(u.Provider,{value:{lang:o},children:Object(p.jsxs)("div",{id:"wrapper",children:[Object(p.jsx)("header",{children:Object(p.jsx)(oe,{lang:o,onLangChange:function(t){if(t!==o){var n=o,a=e.location.pathname.split("/").pop(),r=se.find((function(e){return e.routes[n]===a}));l(t),r&&e.push("/page/".concat(t,"/").concat(r.routes[t]))}},routes:se})}),Object(p.jsx)("main",{children:Object(p.jsxs)(s.d,{children:[le.map((function(e){return se.map((function(t,a){var c=t.titles,o=t.routes,i=t.contents,l=t.Component,u="/page/".concat(e,"/").concat(o[e]),j=c[e],b=r.a.lazy((function(){return n(283)("./".concat(i[e]))}));return Object(p.jsx)(s.b,{path:u,children:d({Content:b,ThatComponent:l,title:j})},a)}))})),Object(p.jsx)(s.b,{path:"/",children:Object(p.jsx)(ce,{lang:o})}),Object(p.jsx)(s.a,{to:"/"})]})}),Object(p.jsx)("footer",{})]})})}function de(){return Object(p.jsx)(l.a,{children:Object(p.jsx)(ue,{})})}var je=function(e){e&&e instanceof Function&&n.e(17).then(n.bind(null,318)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};o.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(de,{})}),document.getElementById("root")),je()}},[[284,1,2]]]);
//# sourceMappingURL=main.a1d7cd24.chunk.js.map